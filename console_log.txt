
PS C:\Users\cmano\Downloads\betterLunarLander> python .\lander_improved.py

======================================================================
LUNAR LANDER - TABULAR RL COMPARISON
======================================================================

[1/2] Training Q-Learning Agent...

======================================================================
TRAINING Q-LEARNING AGENT
======================================================================
Episodes: 100000
Learning Rate: 0.05
Discount Factor: 0.99
Epsilon Decay: 0.9995
State Bins: 8 per dimension (6 dimensions)
======================================================================

C:\Users\cmano\AppData\Roaming\Python\Python311\site-packages\pygame\pkgdata.py:25: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import resource_stream, resource_exists
Episode 1000/100000 | Recent Avg: -136.1 | Epsilon: 0.6065
Episode 2000/100000 | Epsilon: 0.3678 | Eval Mean: -167.8 | Success Rate: 0.0% | Time: 15.7s
Episode 3000/100000 | Recent Avg: -100.7 | Epsilon: 0.2230
Episode 4000/100000 | Epsilon: 0.1353 | Eval Mean: -195.9 | Success Rate: 0.0% | Time: 44.0s
Episode 5000/100000 | Recent Avg: -94.3 | Epsilon: 0.0820
Episode 6000/100000 | Epsilon: 0.0497 | Eval Mean: -103.1 | Success Rate: 0.0% | Time: 78.8s
Episode 7000/100000 | Recent Avg: -74.0 | Epsilon: 0.0302
Episode 8000/100000 | Epsilon: 0.0183 | Eval Mean: -63.2 | Success Rate: 0.0% | Time: 115.1s
Episode 9000/100000 | Recent Avg: -96.8 | Epsilon: 0.0111
Episode 10000/100000 | Epsilon: 0.0100 | Eval Mean: -124.0 | Success Rate: 0.0% | Time: 158.3s
Episode 11000/100000 | Recent Avg: -79.1 | Epsilon: 0.0100
Episode 12000/100000 | Epsilon: 0.0100 | Eval Mean: -80.2 | Success Rate: 10.0% | Time: 202.3s
Episode 13000/100000 | Recent Avg: -91.5 | Epsilon: 0.0100
Episode 14000/100000 | Epsilon: 0.0100 | Eval Mean: 3.7 | Success Rate: 5.0% | Time: 244.9s
Episode 15000/100000 | Recent Avg: -85.1 | Epsilon: 0.0100
Episode 16000/100000 | Epsilon: 0.0100 | Eval Mean: -22.6 | Success Rate: 20.0% | Time: 289.0s
Episode 17000/100000 | Recent Avg: -55.9 | Epsilon: 0.0100
Episode 18000/100000 | Epsilon: 0.0100 | Eval Mean: -140.4 | Success Rate: 0.0% | Time: 329.9s
Episode 19000/100000 | Recent Avg: -77.8 | Epsilon: 0.0100
Episode 20000/100000 | Epsilon: 0.0100 | Eval Mean: -55.8 | Success Rate: 0.0% | Time: 368.2s
Episode 21000/100000 | Recent Avg: -58.5 | Epsilon: 0.0100
Episode 22000/100000 | Epsilon: 0.0100 | Eval Mean: -18.2 | Success Rate: 20.0% | Time: 408.1s
Episode 23000/100000 | Recent Avg: -15.9 | Epsilon: 0.0100
Episode 24000/100000 | Epsilon: 0.0100 | Eval Mean: -47.5 | Success Rate: 5.0% | Time: 445.1s
Episode 25000/100000 | Recent Avg: -45.8 | Epsilon: 0.0100
Episode 26000/100000 | Epsilon: 0.0100 | Eval Mean: -105.2 | Success Rate: 0.0% | Time: 486.6s
Episode 27000/100000 | Recent Avg: -43.5 | Epsilon: 0.0100
Episode 28000/100000 | Epsilon: 0.0100 | Eval Mean: 15.1 | Success Rate: 15.0% | Time: 532.2s
Episode 29000/100000 | Recent Avg: -26.1 | Epsilon: 0.0100
Episode 30000/100000 | Epsilon: 0.0100 | Eval Mean: -92.9 | Success Rate: 0.0% | Time: 576.3s
Episode 31000/100000 | Recent Avg: -39.1 | Epsilon: 0.0100
Episode 32000/100000 | Epsilon: 0.0100 | Eval Mean: -81.6 | Success Rate: 5.0% | Time: 625.0s
Episode 33000/100000 | Recent Avg: -15.9 | Epsilon: 0.0100
Episode 34000/100000 | Epsilon: 0.0100 | Eval Mean: -43.1 | Success Rate: 0.0% | Time: 671.4s
Episode 35000/100000 | Recent Avg: -54.0 | Epsilon: 0.0100
Episode 36000/100000 | Epsilon: 0.0100 | Eval Mean: -74.9 | Success Rate: 5.0% | Time: 715.9s
Episode 37000/100000 | Recent Avg: -58.7 | Epsilon: 0.0100
Episode 38000/100000 | Epsilon: 0.0100 | Eval Mean: -26.1 | Success Rate: 5.0% | Time: 765.0s
Episode 39000/100000 | Recent Avg: -59.0 | Epsilon: 0.0100
Episode 40000/100000 | Epsilon: 0.0100 | Eval Mean: -43.4 | Success Rate: 5.0% | Time: 810.7s
Episode 41000/100000 | Recent Avg: -53.3 | Epsilon: 0.0100
Episode 42000/100000 | Epsilon: 0.0100 | Eval Mean: -120.9 | Success Rate: 0.0% | Time: 861.6s
Episode 43000/100000 | Recent Avg: -49.9 | Epsilon: 0.0100
Episode 44000/100000 | Epsilon: 0.0100 | Eval Mean: -23.6 | Success Rate: 15.0% | Time: 908.8s
Episode 45000/100000 | Recent Avg: -32.4 | Epsilon: 0.0100
Episode 46000/100000 | Epsilon: 0.0100 | Eval Mean: -140.8 | Success Rate: 0.0% | Time: 952.7s
Episode 47000/100000 | Recent Avg: -41.6 | Epsilon: 0.0100
Episode 48000/100000 | Epsilon: 0.0100 | Eval Mean: -29.6 | Success Rate: 10.0% | Time: 999.9s
Episode 49000/100000 | Recent Avg: -44.1 | Epsilon: 0.0100
Episode 50000/100000 | Epsilon: 0.0100 | Eval Mean: 10.1 | Success Rate: 15.0% | Time: 1046.5s
Episode 51000/100000 | Recent Avg: -36.8 | Epsilon: 0.0100
Episode 52000/100000 | Epsilon: 0.0100 | Eval Mean: 33.3 | Success Rate: 20.0% | Time: 1094.3s
Episode 53000/100000 | Recent Avg: -3.3 | Epsilon: 0.0100
Episode 54000/100000 | Epsilon: 0.0100 | Eval Mean: -17.9 | Success Rate: 15.0% | Time: 1143.6s
Episode 55000/100000 | Recent Avg: -33.4 | Epsilon: 0.0100
Episode 56000/100000 | Epsilon: 0.0100 | Eval Mean: -63.1 | Success Rate: 0.0% | Time: 1193.3s
Episode 57000/100000 | Recent Avg: -24.2 | Epsilon: 0.0100
Episode 58000/100000 | Epsilon: 0.0100 | Eval Mean: -19.0 | Success Rate: 5.0% | Time: 1239.6s
Episode 59000/100000 | Recent Avg: -11.8 | Epsilon: 0.0100
Episode 60000/100000 | Epsilon: 0.0100 | Eval Mean: 14.7 | Success Rate: 10.0% | Time: 1284.3s
Episode 61000/100000 | Recent Avg: -40.4 | Epsilon: 0.0100
Episode 62000/100000 | Epsilon: 0.0100 | Eval Mean: -15.2 | Success Rate: 0.0% | Time: 1328.7s
Episode 63000/100000 | Recent Avg: -16.0 | Epsilon: 0.0100
Episode 64000/100000 | Epsilon: 0.0100 | Eval Mean: -33.8 | Success Rate: 0.0% | Time: 1379.8s
Episode 65000/100000 | Recent Avg: -14.8 | Epsilon: 0.0100
Episode 66000/100000 | Epsilon: 0.0100 | Eval Mean: -142.2 | Success Rate: 0.0% | Time: 1425.1s
Episode 67000/100000 | Recent Avg: -25.9 | Epsilon: 0.0100
Episode 68000/100000 | Epsilon: 0.0100 | Eval Mean: -65.8 | Success Rate: 0.0% | Time: 1476.3s
Episode 69000/100000 | Recent Avg: -13.7 | Epsilon: 0.0100
Episode 70000/100000 | Epsilon: 0.0100 | Eval Mean: -39.8 | Success Rate: 0.0% | Time: 1530.7s
Episode 71000/100000 | Recent Avg: -17.2 | Epsilon: 0.0100
Episode 72000/100000 | Epsilon: 0.0100 | Eval Mean: -65.1 | Success Rate: 5.0% | Time: 1578.0s
Episode 73000/100000 | Recent Avg: -37.5 | Epsilon: 0.0100
Episode 74000/100000 | Epsilon: 0.0100 | Eval Mean: -42.2 | Success Rate: 0.0% | Time: 1619.1s
Episode 75000/100000 | Recent Avg: -16.0 | Epsilon: 0.0100
Episode 76000/100000 | Epsilon: 0.0100 | Eval Mean: -15.6 | Success Rate: 0.0% | Time: 1660.4s
Episode 77000/100000 | Recent Avg: -40.3 | Epsilon: 0.0100
Episode 78000/100000 | Epsilon: 0.0100 | Eval Mean: -8.5 | Success Rate: 15.0% | Time: 1749.0s
Episode 79000/100000 | Recent Avg: -29.5 | Epsilon: 0.0100
Episode 80000/100000 | Epsilon: 0.0100 | Eval Mean: -130.1 | Success Rate: 0.0% | Time: 1841.5s
Episode 81000/100000 | Recent Avg: -44.3 | Epsilon: 0.0100
Episode 82000/100000 | Epsilon: 0.0100 | Eval Mean: -63.9 | Success Rate: 5.0% | Time: 1944.0s
Episode 83000/100000 | Recent Avg: -45.1 | Epsilon: 0.0100
Episode 84000/100000 | Epsilon: 0.0100 | Eval Mean: -46.7 | Success Rate: 0.0% | Time: 2046.3s
Episode 85000/100000 | Recent Avg: -37.6 | Epsilon: 0.0100
Episode 86000/100000 | Epsilon: 0.0100 | Eval Mean: 0.1 | Success Rate: 10.0% | Time: 2137.0s
Episode 87000/100000 | Recent Avg: 2.0 | Epsilon: 0.0100
Episode 88000/100000 | Epsilon: 0.0100 | Eval Mean: -72.9 | Success Rate: 0.0% | Time: 2234.7s
Episode 89000/100000 | Recent Avg: -34.9 | Epsilon: 0.0100
Episode 90000/100000 | Epsilon: 0.0100 | Eval Mean: -8.6 | Success Rate: 0.0% | Time: 2345.7s
Episode 91000/100000 | Recent Avg: -5.2 | Epsilon: 0.0100
Episode 92000/100000 | Epsilon: 0.0100 | Eval Mean: -15.6 | Success Rate: 0.0% | Time: 2449.1s
Episode 93000/100000 | Recent Avg: -2.1 | Epsilon: 0.0100
Episode 94000/100000 | Epsilon: 0.0100 | Eval Mean: -50.4 | Success Rate: 5.0% | Time: 2555.2s
Episode 95000/100000 | Recent Avg: -42.6 | Epsilon: 0.0100
Episode 96000/100000 | Epsilon: 0.0100 | Eval Mean: -13.0 | Success Rate: 20.0% | Time: 2664.3s
Episode 97000/100000 | Recent Avg: -15.3 | Epsilon: 0.0100
Episode 98000/100000 | Epsilon: 0.0100 | Eval Mean: -14.0 | Success Rate: 10.0% | Time: 2775.6s
Episode 99000/100000 | Recent Avg: -4.2 | Epsilon: 0.0100
Episode 100000/100000 | Epsilon: 0.0100 | Eval Mean: 9.7 | Success Rate: 25.0% | Time: 2878.6s

======================================================================
TRAINING COMPLETE
Total Time: 48.0 minutes
Unique States Visited: 7673
Total Q-Updates: 39367995
======================================================================

Traceback (most recent call last):
  File "C:\Users\cmano\Downloads\betterLunarLander\lander_improved.py", line 469, in <module>
    agent_q.save_q_table('/mnt/user-data/outputs/q_learning_model.pkl')
  File "C:\Users\cmano\Downloads\betterLunarLander\lander_improved.py", line 208, in save_q_table
    with open(filename, 'wb') as f:
         ^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/mnt/user-data/outputs/q_learning_model.pkl'
PS C:\Users\cmano\Downloads\betterLunarLander> python .\lander_improved.py

======================================================================
LUNAR LANDER - TABULAR RL COMPARISON
======================================================================

[1/2] Training Q-Learning Agent...

======================================================================
TRAINING Q-LEARNING AGENT
======================================================================
Episodes: 100000
Learning Rate: 0.05
Discount Factor: 0.99
Epsilon Decay: 0.9995
State Bins: 8 per dimension (6 dimensions)
======================================================================

C:\Users\cmano\AppData\Roaming\Python\Python311\site-packages\pygame\pkgdata.py:25: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import resource_stream, resource_exists
Episode 1000/100000 | Recent Avg: -140.2 | Epsilon: 0.6065
Episode 2000/100000 | Epsilon: 0.3678 | Eval Mean: -141.2 | Success Rate: 5.0% | Time: 18.0s
Episode 3000/100000 | Recent Avg: -100.6 | Epsilon: 0.2230
Episode 4000/100000 | Epsilon: 0.1353 | Eval Mean: -197.4 | Success Rate: 0.0% | Time: 78.8s
Episode 5000/100000 | Recent Avg: -91.4 | Epsilon: 0.0820
Episode 6000/100000 | Epsilon: 0.0497 | Eval Mean: -114.8 | Success Rate: 0.0% | Time: 113.7s
Episode 7000/100000 | Recent Avg: -81.7 | Epsilon: 0.0302
Episode 8000/100000 | Epsilon: 0.0183 | Eval Mean: -88.8 | Success Rate: 0.0% | Time: 155.1s
Episode 9000/100000 | Recent Avg: -54.5 | Epsilon: 0.0111
Episode 10000/100000 | Epsilon: 0.0067 | Eval Mean: -103.8 | Success Rate: 10.0% | Time: 194.0s
Episode 11000/100000 | Recent Avg: -73.5 | Epsilon: 0.0041
Episode 12000/100000 | Epsilon: 0.0025 | Eval Mean: -24.7 | Success Rate: 10.0% | Time: 232.3s
Episode 13000/100000 | Recent Avg: -65.4 | Epsilon: 0.0015
Episode 14000/100000 | Epsilon: 0.0010 | Eval Mean: -67.3 | Success Rate: 5.0% | Time: 269.2s
Episode 15000/100000 | Recent Avg: -59.0 | Epsilon: 0.0010
Episode 16000/100000 | Epsilon: 0.0010 | Eval Mean: -90.7 | Success Rate: 5.0% | Time: 311.1s
Episode 17000/100000 | Recent Avg: -36.8 | Epsilon: 0.0010
Episode 18000/100000 | Epsilon: 0.0010 | Eval Mean: -44.1 | Success Rate: 5.0% | Time: 356.2s
Episode 19000/100000 | Recent Avg: -52.3 | Epsilon: 0.0010
Episode 20000/100000 | Epsilon: 0.0010 | Eval Mean: -30.8 | Success Rate: 0.0% | Time: 405.2s
Episode 21000/100000 | Recent Avg: -44.2 | Epsilon: 0.0010
Episode 22000/100000 | Epsilon: 0.0010 | Eval Mean: -75.5 | Success Rate: 0.0% | Time: 464.8s
Episode 23000/100000 | Recent Avg: -55.0 | Epsilon: 0.0010
Episode 24000/100000 | Epsilon: 0.0010 | Eval Mean: -104.6 | Success Rate: 5.0% | Time: 585.3s
Episode 25000/100000 | Recent Avg: -86.5 | Epsilon: 0.0010
Episode 26000/100000 | Epsilon: 0.0010 | Eval Mean: -175.0 | Success Rate: 0.0% | Time: 716.6s
Episode 27000/100000 | Recent Avg: -44.1 | Epsilon: 0.0010
Episode 28000/100000 | Epsilon: 0.0010 | Eval Mean: -90.1 | Success Rate: 5.0% | Time: 833.5s
Episode 29000/100000 | Recent Avg: -65.8 | Epsilon: 0.0010
Episode 30000/100000 | Epsilon: 0.0010 | Eval Mean: -117.7 | Success Rate: 0.0% | Time: 931.2s
Episode 31000/100000 | Recent Avg: -55.7 | Epsilon: 0.0010
Episode 32000/100000 | Epsilon: 0.0010 | Eval Mean: -56.3 | Success Rate: 5.0% | Time: 1040.5s
Episode 33000/100000 | Recent Avg: -50.8 | Epsilon: 0.0010
Episode 34000/100000 | Epsilon: 0.0010 | Eval Mean: -123.8 | Success Rate: 0.0% | Time: 1142.2s
Episode 35000/100000 | Recent Avg: -61.7 | Epsilon: 0.0010
Episode 36000/100000 | Epsilon: 0.0010 | Eval Mean: -61.5 | Success Rate: 5.0% | Time: 1240.8s
Episode 37000/100000 | Recent Avg: -82.9 | Epsilon: 0.0010
Episode 38000/100000 | Epsilon: 0.0010 | Eval Mean: -73.4 | Success Rate: 5.0% | Time: 1352.8s
Episode 39000/100000 | Recent Avg: -38.0 | Epsilon: 0.0010
Episode 40000/100000 | Epsilon: 0.0010 | Eval Mean: -69.8 | Success Rate: 10.0% | Time: 1447.6s
Episode 41000/100000 | Recent Avg: -33.4 | Epsilon: 0.0010
Episode 42000/100000 | Epsilon: 0.0010 | Eval Mean: -99.1 | Success Rate: 0.0% | Time: 1549.2s
Episode 43000/100000 | Recent Avg: -7.8 | Epsilon: 0.0010
Episode 44000/100000 | Epsilon: 0.0010 | Eval Mean: -24.2 | Success Rate: 10.0% | Time: 1639.2s
Episode 45000/100000 | Recent Avg: 8.9 | Epsilon: 0.0010
Episode 46000/100000 | Epsilon: 0.0010 | Eval Mean: -35.0 | Success Rate: 0.0% | Time: 1727.2s
Episode 47000/100000 | Recent Avg: 3.8 | Epsilon: 0.0010
Episode 48000/100000 | Epsilon: 0.0010 | Eval Mean: -12.2 | Success Rate: 0.0% | Time: 1821.3s
Episode 49000/100000 | Recent Avg: 17.3 | Epsilon: 0.0010
Episode 50000/100000 | Epsilon: 0.0010 | Eval Mean: -24.4 | Success Rate: 5.0% | Time: 1902.8s
Episode 51000/100000 | Recent Avg: 8.0 | Epsilon: 0.0010
Episode 52000/100000 | Epsilon: 0.0010 | Eval Mean: 26.8 | Success Rate: 20.0% | Time: 1986.3s
Episode 53000/100000 | Recent Avg: 20.4 | Epsilon: 0.0010
Episode 54000/100000 | Epsilon: 0.0010 | Eval Mean: 18.8 | Success Rate: 20.0% | Time: 2067.7s
Episode 55000/100000 | Recent Avg: 14.6 | Epsilon: 0.0010
Episode 56000/100000 | Epsilon: 0.0010 | Eval Mean: -24.0 | Success Rate: 5.0% | Time: 2158.4s
Episode 57000/100000 | Recent Avg: 19.8 | Epsilon: 0.0010
Episode 58000/100000 | Epsilon: 0.0010 | Eval Mean: 25.0 | Success Rate: 15.0% | Time: 2241.6s
Episode 59000/100000 | Recent Avg: 13.9 | Epsilon: 0.0010
Episode 60000/100000 | Epsilon: 0.0010 | Eval Mean: 18.6 | Success Rate: 15.0% | Time: 2326.1s
Episode 61000/100000 | Recent Avg: 17.7 | Epsilon: 0.0010
Episode 62000/100000 | Epsilon: 0.0010 | Eval Mean: -26.0 | Success Rate: 5.0% | Time: 2412.4s
Episode 63000/100000 | Recent Avg: 19.2 | Epsilon: 0.0010
Episode 64000/100000 | Epsilon: 0.0010 | Eval Mean: -30.6 | Success Rate: 5.0% | Time: 2504.6s
Episode 65000/100000 | Recent Avg: 8.9 | Epsilon: 0.0010
Episode 66000/100000 | Epsilon: 0.0010 | Eval Mean: 68.2 | Success Rate: 35.0% | Time: 2600.7s
Episode 67000/100000 | Recent Avg: 43.1 | Epsilon: 0.0010
Episode 68000/100000 | Epsilon: 0.0010 | Eval Mean: 27.5 | Success Rate: 10.0% | Time: 2689.2s
Episode 69000/100000 | Recent Avg: 25.4 | Epsilon: 0.0010
Episode 70000/100000 | Epsilon: 0.0010 | Eval Mean: 28.8 | Success Rate: 20.0% | Time: 2781.2s
Episode 71000/100000 | Recent Avg: 39.4 | Epsilon: 0.0010
Episode 72000/100000 | Epsilon: 0.0010 | Eval Mean: -8.7 | Success Rate: 5.0% | Time: 2870.7s
Episode 73000/100000 | Recent Avg: 8.1 | Epsilon: 0.0010
Episode 74000/100000 | Epsilon: 0.0010 | Eval Mean: 26.7 | Success Rate: 25.0% | Time: 2964.1s
Episode 75000/100000 | Recent Avg: 24.7 | Epsilon: 0.0010
Episode 76000/100000 | Epsilon: 0.0010 | Eval Mean: 2.7 | Success Rate: 5.0% | Time: 3064.4s
Episode 77000/100000 | Recent Avg: 21.3 | Epsilon: 0.0010
Episode 78000/100000 | Epsilon: 0.0010 | Eval Mean: 12.8 | Success Rate: 15.0% | Time: 3154.2s
Episode 79000/100000 | Recent Avg: -10.2 | Epsilon: 0.0010
Episode 80000/100000 | Epsilon: 0.0010 | Eval Mean: -38.5 | Success Rate: 5.0% | Time: 3246.7s
Episode 81000/100000 | Recent Avg: -18.2 | Epsilon: 0.0010
Episode 82000/100000 | Epsilon: 0.0010 | Eval Mean: 58.6 | Success Rate: 30.0% | Time: 3354.7s
Episode 83000/100000 | Recent Avg: -28.2 | Epsilon: 0.0010
Episode 84000/100000 | Epsilon: 0.0010 | Eval Mean: -33.1 | Success Rate: 5.0% | Time: 3460.2s
Episode 85000/100000 | Recent Avg: -4.5 | Epsilon: 0.0010
Episode 86000/100000 | Epsilon: 0.0010 | Eval Mean: -16.5 | Success Rate: 10.0% | Time: 3578.1s
Episode 87000/100000 | Recent Avg: -18.9 | Epsilon: 0.0010
Episode 88000/100000 | Epsilon: 0.0010 | Eval Mean: -33.3 | Success Rate: 0.0% | Time: 3678.1s
Episode 89000/100000 | Recent Avg: -7.0 | Epsilon: 0.0010
Episode 90000/100000 | Epsilon: 0.0010 | Eval Mean: -31.1 | Success Rate: 10.0% | Time: 3781.7s
Episode 91000/100000 | Recent Avg: -6.7 | Epsilon: 0.0010
Episode 92000/100000 | Epsilon: 0.0010 | Eval Mean: 5.0 | Success Rate: 20.0% | Time: 3887.7s
Episode 93000/100000 | Recent Avg: -4.7 | Epsilon: 0.0010
Episode 94000/100000 | Epsilon: 0.0010 | Eval Mean: -9.4 | Success Rate: 10.0% | Time: 3985.4s
Episode 95000/100000 | Recent Avg: -8.3 | Epsilon: 0.0010
Episode 96000/100000 | Epsilon: 0.0010 | Eval Mean: -16.7 | Success Rate: 10.0% | Time: 4095.3s
Episode 97000/100000 | Recent Avg: 0.1 | Epsilon: 0.0010
Episode 98000/100000 | Epsilon: 0.0010 | Eval Mean: 33.6 | Success Rate: 10.0% | Time: 4211.5s
Episode 99000/100000 | Recent Avg: 7.2 | Epsilon: 0.0010
Episode 100000/100000 | Epsilon: 0.0010 | Eval Mean: -30.4 | Success Rate: 5.0% | Time: 4325.4s

======================================================================
TRAINING COMPLETE
Total Time: 72.1 minutes
Unique States Visited: 7230
Total Q-Updates: 38709653
======================================================================

Q-Learning model saved to: outputs/q_learning_model.pkl

[2/2] Training SARSA Agent...

======================================================================
TRAINING SARSA AGENT
======================================================================
Episodes: 100000
Learning Rate: 0.05
Discount Factor: 0.99
Epsilon Decay: 0.9995
State Bins: 8 per dimension (6 dimensions)
======================================================================

Episode 1000/100000 | Recent Avg: -139.8 | Epsilon: 0.6065
Episode 2000/100000 | Epsilon: 0.3678 | Eval Mean: -338.2 | Success Rate: 0.0% | Time: 34.5s
Episode 3000/100000 | Recent Avg: -125.7 | Epsilon: 0.2230
Episode 4000/100000 | Epsilon: 0.1353 | Eval Mean: -182.1 | Success Rate: 0.0% | Time: 98.7s
Episode 5000/100000 | Recent Avg: -153.1 | Epsilon: 0.0820
Episode 6000/100000 | Epsilon: 0.0497 | Eval Mean: -118.2 | Success Rate: 0.0% | Time: 170.6s
Episode 7000/100000 | Recent Avg: -125.9 | Epsilon: 0.0302
Episode 8000/100000 | Epsilon: 0.0183 | Eval Mean: -149.1 | Success Rate: 0.0% | Time: 249.0s
Episode 9000/100000 | Recent Avg: -138.2 | Epsilon: 0.0111
Episode 10000/100000 | Epsilon: 0.0067 | Eval Mean: -110.1 | Success Rate: 5.0% | Time: 337.3s
Episode 11000/100000 | Recent Avg: -127.8 | Epsilon: 0.0041
Episode 12000/100000 | Epsilon: 0.0025 | Eval Mean: -163.6 | Success Rate: 0.0% | Time: 421.2s
Episode 13000/100000 | Recent Avg: -99.2 | Epsilon: 0.0015
Episode 14000/100000 | Epsilon: 0.0010 | Eval Mean: -136.6 | Success Rate: 0.0% | Time: 504.1s
Episode 15000/100000 | Recent Avg: -113.9 | Epsilon: 0.0010
Episode 16000/100000 | Epsilon: 0.0010 | Eval Mean: -126.2 | Success Rate: 0.0% | Time: 595.2s
Episode 17000/100000 | Recent Avg: -118.4 | Epsilon: 0.0010
Episode 18000/100000 | Epsilon: 0.0010 | Eval Mean: -92.8 | Success Rate: 0.0% | Time: 679.1s
Episode 19000/100000 | Recent Avg: -79.9 | Epsilon: 0.0010
Episode 20000/100000 | Epsilon: 0.0010 | Eval Mean: -30.3 | Success Rate: 10.0% | Time: 762.5s
Episode 21000/100000 | Recent Avg: -77.7 | Epsilon: 0.0010
Episode 22000/100000 | Epsilon: 0.0010 | Eval Mean: -100.5 | Success Rate: 0.0% | Time: 866.3s
Episode 23000/100000 | Recent Avg: -77.1 | Epsilon: 0.0010
Episode 24000/100000 | Epsilon: 0.0010 | Eval Mean: -33.3 | Success Rate: 0.0% | Time: 973.0s
Episode 25000/100000 | Recent Avg: -64.1 | Epsilon: 0.0010
Episode 26000/100000 | Epsilon: 0.0010 | Eval Mean: -54.0 | Success Rate: 10.0% | Time: 1080.8s
Episode 27000/100000 | Recent Avg: -68.9 | Epsilon: 0.0010
Episode 28000/100000 | Epsilon: 0.0010 | Eval Mean: -69.7 | Success Rate: 0.0% | Time: 1190.7s
Episode 29000/100000 | Recent Avg: -67.6 | Epsilon: 0.0010
Episode 30000/100000 | Epsilon: 0.0010 | Eval Mean: -41.3 | Success Rate: 10.0% | Time: 1309.3s
Episode 31000/100000 | Recent Avg: -57.2 | Epsilon: 0.0010
Episode 32000/100000 | Epsilon: 0.0010 | Eval Mean: -25.4 | Success Rate: 10.0% | Time: 1406.1s
Episode 33000/100000 | Recent Avg: -38.4 | Epsilon: 0.0010
Episode 34000/100000 | Epsilon: 0.0010 | Eval Mean: -56.1 | Success Rate: 5.0% | Time: 1498.2s
Episode 35000/100000 | Recent Avg: -46.4 | Epsilon: 0.0010
Episode 36000/100000 | Epsilon: 0.0010 | Eval Mean: -31.0 | Success Rate: 5.0% | Time: 1606.9s
Episode 37000/100000 | Recent Avg: -53.2 | Epsilon: 0.0010
Episode 38000/100000 | Epsilon: 0.0010 | Eval Mean: -40.9 | Success Rate: 0.0% | Time: 1733.2s
Episode 39000/100000 | Recent Avg: -76.6 | Epsilon: 0.0010
Episode 40000/100000 | Epsilon: 0.0010 | Eval Mean: -33.0 | Success Rate: 5.0% | Time: 1852.3s
Episode 41000/100000 | Recent Avg: -68.2 | Epsilon: 0.0010
Episode 42000/100000 | Epsilon: 0.0010 | Eval Mean: -96.6 | Success Rate: 5.0% | Time: 1973.4s
Episode 43000/100000 | Recent Avg: -86.6 | Epsilon: 0.0010
Episode 44000/100000 | Epsilon: 0.0010 | Eval Mean: -127.2 | Success Rate: 0.0% | Time: 2083.6s
Episode 45000/100000 | Recent Avg: -94.5 | Epsilon: 0.0010
Episode 46000/100000 | Epsilon: 0.0010 | Eval Mean: -119.8 | Success Rate: 0.0% | Time: 2203.9s
Episode 47000/100000 | Recent Avg: -85.6 | Epsilon: 0.0010
Episode 48000/100000 | Epsilon: 0.0010 | Eval Mean: -96.2 | Success Rate: 0.0% | Time: 2319.8s
Episode 49000/100000 | Recent Avg: -71.9 | Epsilon: 0.0010
Episode 50000/100000 | Epsilon: 0.0010 | Eval Mean: -76.5 | Success Rate: 0.0% | Time: 2406.6s
Episode 51000/100000 | Recent Avg: -81.3 | Epsilon: 0.0010
Episode 52000/100000 | Epsilon: 0.0010 | Eval Mean: -126.0 | Success Rate: 5.0% | Time: 2525.9s
Episode 53000/100000 | Recent Avg: -64.5 | Epsilon: 0.0010
Episode 54000/100000 | Epsilon: 0.0010 | Eval Mean: -60.7 | Success Rate: 0.0% | Time: 2638.0s
Episode 55000/100000 | Recent Avg: -65.4 | Epsilon: 0.0010
Episode 56000/100000 | Epsilon: 0.0010 | Eval Mean: -79.4 | Success Rate: 0.0% | Time: 2766.8s
Episode 57000/100000 | Recent Avg: -51.0 | Epsilon: 0.0010
Episode 58000/100000 | Epsilon: 0.0010 | Eval Mean: -61.5 | Success Rate: 0.0% | Time: 2899.6s
Episode 59000/100000 | Recent Avg: -42.9 | Epsilon: 0.0010
Episode 60000/100000 | Epsilon: 0.0010 | Eval Mean: -51.8 | Success Rate: 5.0% | Time: 3032.2s
Episode 61000/100000 | Recent Avg: -38.0 | Epsilon: 0.0010
Episode 62000/100000 | Epsilon: 0.0010 | Eval Mean: -26.2 | Success Rate: 5.0% | Time: 3163.0s
Episode 63000/100000 | Recent Avg: -39.2 | Epsilon: 0.0010
Episode 64000/100000 | Epsilon: 0.0010 | Eval Mean: 24.1 | Success Rate: 10.0% | Time: 3294.1s
Episode 65000/100000 | Recent Avg: -39.3 | Epsilon: 0.0010
Episode 66000/100000 | Epsilon: 0.0010 | Eval Mean: -16.2 | Success Rate: 5.0% | Time: 3425.9s
Episode 67000/100000 | Recent Avg: -23.9 | Epsilon: 0.0010
Episode 68000/100000 | Epsilon: 0.0010 | Eval Mean: -16.9 | Success Rate: 0.0% | Time: 3535.7s
Episode 69000/100000 | Recent Avg: -30.7 | Epsilon: 0.0010
Episode 70000/100000 | Epsilon: 0.0010 | Eval Mean: -97.2 | Success Rate: 10.0% | Time: 3638.0s
Episode 71000/100000 | Recent Avg: -52.6 | Epsilon: 0.0010
Episode 72000/100000 | Epsilon: 0.0010 | Eval Mean: 1.1 | Success Rate: 15.0% | Time: 3763.8s
Episode 73000/100000 | Recent Avg: -22.4 | Epsilon: 0.0010
Episode 74000/100000 | Epsilon: 0.0010 | Eval Mean: -26.5 | Success Rate: 5.0% | Time: 3827.4s
Episode 75000/100000 | Recent Avg: -31.5 | Epsilon: 0.0010
Episode 76000/100000 | Epsilon: 0.0010 | Eval Mean: -33.4 | Success Rate: 0.0% | Time: 3879.1s
Episode 77000/100000 | Recent Avg: -49.3 | Epsilon: 0.0010
Episode 78000/100000 | Epsilon: 0.0010 | Eval Mean: -94.4 | Success Rate: 0.0% | Time: 3936.3s
Episode 79000/100000 | Recent Avg: -65.6 | Epsilon: 0.0010
Episode 80000/100000 | Epsilon: 0.0010 | Eval Mean: -44.4 | Success Rate: 0.0% | Time: 4007.0s
Episode 81000/100000 | Recent Avg: -42.5 | Epsilon: 0.0010
Episode 82000/100000 | Epsilon: 0.0010 | Eval Mean: -62.2 | Success Rate: 0.0% | Time: 4074.3s
Episode 83000/100000 | Recent Avg: -25.6 | Epsilon: 0.0010
Episode 84000/100000 | Epsilon: 0.0010 | Eval Mean: -21.4 | Success Rate: 0.0% | Time: 4146.1s
Episode 85000/100000 | Recent Avg: -32.1 | Epsilon: 0.0010
Episode 86000/100000 | Epsilon: 0.0010 | Eval Mean: -0.3 | Success Rate: 5.0% | Time: 4222.3s
Episode 87000/100000 | Recent Avg: -32.7 | Epsilon: 0.0010
Episode 88000/100000 | Epsilon: 0.0010 | Eval Mean: -1.2 | Success Rate: 5.0% | Time: 4303.8s
Episode 89000/100000 | Recent Avg: -12.9 | Epsilon: 0.0010
Episode 90000/100000 | Epsilon: 0.0010 | Eval Mean: -62.8 | Success Rate: 0.0% | Time: 4380.7s
Episode 91000/100000 | Recent Avg: -8.8 | Epsilon: 0.0010
Episode 92000/100000 | Epsilon: 0.0010 | Eval Mean: -35.3 | Success Rate: 5.0% | Time: 4518.8s
Episode 93000/100000 | Recent Avg: -20.2 | Epsilon: 0.0010
Episode 94000/100000 | Epsilon: 0.0010 | Eval Mean: -53.0 | Success Rate: 0.0% | Time: 4671.7s
Episode 95000/100000 | Recent Avg: -12.0 | Epsilon: 0.0010
Episode 96000/100000 | Epsilon: 0.0010 | Eval Mean: 9.7 | Success Rate: 5.0% | Time: 4832.1s
Episode 97000/100000 | Recent Avg: 8.9 | Epsilon: 0.0010
Episode 98000/100000 | Epsilon: 0.0010 | Eval Mean: -20.1 | Success Rate: 5.0% | Time: 4944.1s
Episode 99000/100000 | Recent Avg: 7.2 | Epsilon: 0.0010
Episode 100000/100000 | Epsilon: 0.0010 | Eval Mean: -48.3 | Success Rate: 0.0% | Time: 5012.6s

======================================================================
TRAINING COMPLETE
Total Time: 83.5 minutes
Unique States Visited: 7718
Total Q-Updates: 48642987
======================================================================

SARSA model saved to: outputs/sarsa_model.pkl

======================================================================
FINAL EVALUATION (100 episodes each)
======================================================================

Q-Learning Final Stats:
  Mean Reward: 18.20 ± 119.32
  Success Rate: 9.0%
  Best Episode: 290.84

SARSA Final Stats:
  Mean Reward: -18.95 ± 100.07
  Success Rate: 3.0%
  Best Episode: 268.68

Generating comparison plots...
Plot saved to: outputs/training_comparison.png

======================================================================
Would you like to watch the trained Q-Learning agent? (y/n): y
Rendering 5 episodes...

Training complete! Check the output files and plots.
PS C:\Users\cmano\Downloads\betterLunarLander> python .\lander_with_improvements.py

======================================================================
LUNAR LANDER - ENHANCED LEARNING (v3)
With Reward Shaping, Optimistic Init, and Adaptive LR
======================================================================

[1/3] Training Q-Learning Agent...

======================================================================
TRAINING Q-LEARNING AGENT (ENHANCED)
======================================================================
Episodes: 100000
Learning Rate: 0.1 → 0.01
Discount Factor: 0.99
Epsilon Decay: 0.99992
Reward Shaping: ENABLED
Optimistic Init: ENABLED
======================================================================

C:\Users\cmano\AppData\Roaming\Python\Python311\site-packages\pygame\pkgdata.py:25: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import resource_stream, resource_exists
Episode 1000/100000 | Recent Avg: -169.3 | ε: 0.9231 | α: 0.0951
Episode 2000/100000 | Recent Avg: -144.2 | ε: 0.8521 | α: 0.0905
Episode 3000/100000 | Recent Avg: -127.1 | ε: 0.7866 | α: 0.0861
Episode 4000/100000 | ε: 0.7261 | α: 0.0819 | Eval: -143.5 | Success: 0.0% | Time: 34.3s
Episode 5000/100000 | Recent Avg: -107.9 | ε: 0.6703 | α: 0.0779
Episode 6000/100000 | Recent Avg: -101.7 | ε: 0.6188 | α: 0.0741
Episode 7000/100000 | Recent Avg: -87.4 | ε: 0.5712 | α: 0.0705
Episode 8000/100000 | ε: 0.5273 | α: 0.0670 | Eval: -161.6 | Success: 0.0% | Time: 63.2s
Episode 9000/100000 | Recent Avg: -79.7 | ε: 0.4867 | α: 0.0638
Episode 10000/100000 | Recent Avg: -70.5 | ε: 0.4493 | α: 0.0607
Episode 11000/100000 | Recent Avg: -63.5 | ε: 0.4148 | α: 0.0577
Episode 12000/100000 | ε: 0.3829 | α: 0.0549 | Eval: -143.6 | Success: 0.0% | Time: 102.7s
Episode 13000/100000 | Recent Avg: -56.9 | ε: 0.3534 | α: 0.0522
Episode 14000/100000 | Recent Avg: -55.3 | ε: 0.3263 | α: 0.0497
Episode 15000/100000 | Recent Avg: -68.5 | ε: 0.3012 | α: 0.0472
Episode 16000/100000 | ε: 0.2780 | α: 0.0449 | Eval: -100.0 | Success: 2.5% | Time: 154.4s
Episode 17000/100000 | Recent Avg: -61.4 | ε: 0.2566 | α: 0.0427
Episode 18000/100000 | Recent Avg: -62.2 | ε: 0.2369 | α: 0.0407
Episode 19000/100000 | Recent Avg: -70.2 | ε: 0.2187 | α: 0.0387
Episode 20000/100000 | ε: 0.2019 | α: 0.0368 | Eval: -175.6 | Success: 0.0% | Time: 218.3s
Episode 21000/100000 | Recent Avg: -59.3 | ε: 0.1864 | α: 0.0350
Episode 22000/100000 | Recent Avg: -61.1 | ε: 0.1720 | α: 0.0333
Episode 23000/100000 | Recent Avg: -56.0 | ε: 0.1588 | α: 0.0317
Episode 24000/100000 | ε: 0.1466 | α: 0.0301 | Eval: -19.1 | Success: 5.0% | Time: 287.2s
Episode 25000/100000 | Recent Avg: -50.6 | ε: 0.1353 | α: 0.0286
Episode 26000/100000 | Recent Avg: -63.1 | ε: 0.1249 | α: 0.0273
Episode 27000/100000 | Recent Avg: -51.1 | ε: 0.1153 | α: 0.0259
Episode 28000/100000 | ε: 0.1064 | α: 0.0247 | Eval: -0.1 | Success: 10.0% | Time: 370.6s
Episode 29000/100000 | Recent Avg: -36.6 | ε: 0.0983 | α: 0.0235
Episode 30000/100000 | Recent Avg: -45.7 | ε: 0.0907 | α: 0.0223
Episode 31000/100000 | Recent Avg: -49.2 | ε: 0.0837 | α: 0.0212
Episode 32000/100000 | ε: 0.0773 | α: 0.0202 | Eval: -113.8 | Success: 2.5% | Time: 452.9s
Episode 33000/100000 | Recent Avg: -40.5 | ε: 0.0714 | α: 0.0192
Episode 34000/100000 | Recent Avg: -41.9 | ε: 0.0659 | α: 0.0183
Episode 35000/100000 | Recent Avg: -41.2 | ε: 0.0608 | α: 0.0174
Episode 36000/100000 | ε: 0.0561 | α: 0.0165 | Eval: -163.0 | Success: 0.0% | Time: 543.6s
Episode 37000/100000 | Recent Avg: -38.4 | ε: 0.0518 | α: 0.0157
Episode 38000/100000 | Recent Avg: -48.0 | ε: 0.0478 | α: 0.0150
Episode 39000/100000 | Recent Avg: -29.8 | ε: 0.0442 | α: 0.0142
Episode 40000/100000 | ε: 0.0408 | α: 0.0135 | Eval: 53.9 | Success: 20.0% | Time: 636.4s
Episode 41000/100000 | Recent Avg: -9.2 | ε: 0.0376 | α: 0.0129
Episode 42000/100000 | Recent Avg: -24.1 | ε: 0.0347 | α: 0.0122
Episode 43000/100000 | Recent Avg: -15.8 | ε: 0.0321 | α: 0.0116
Episode 44000/100000 | ε: 0.0296 | α: 0.0111 | Eval: -23.9 | Success: 12.5% | Time: 723.5s
Episode 45000/100000 | Recent Avg: -5.6 | ε: 0.0273 | α: 0.0105
Episode 46000/100000 | Recent Avg: 6.7 | ε: 0.0252 | α: 0.0100
Episode 47000/100000 | Recent Avg: -1.5 | ε: 0.0233 | α: 0.0100
Episode 48000/100000 | ε: 0.0215 | α: 0.0100 | Eval: 18.5 | Success: 12.5% | Time: 812.0s
Episode 49000/100000 | Recent Avg: -16.9 | ε: 0.0198 | α: 0.0100
Episode 50000/100000 | Recent Avg: -20.5 | ε: 0.0183 | α: 0.0100
Episode 51000/100000 | Recent Avg: -44.8 | ε: 0.0169 | α: 0.0100
Episode 52000/100000 | ε: 0.0156 | α: 0.0100 | Eval: -52.6 | Success: 10.0% | Time: 908.3s
Episode 53000/100000 | Recent Avg: -24.7 | ε: 0.0144 | α: 0.0100
Episode 54000/100000 | Recent Avg: -23.9 | ε: 0.0133 | α: 0.0100
Episode 55000/100000 | Recent Avg: -39.0 | ε: 0.0123 | α: 0.0100
Episode 56000/100000 | ε: 0.0113 | α: 0.0100 | Eval: -78.7 | Success: 5.0% | Time: 1003.8s
Episode 57000/100000 | Recent Avg: -42.6 | ε: 0.0105 | α: 0.0100
Episode 58000/100000 | Recent Avg: -8.8 | ε: 0.0100 | α: 0.0100
Episode 59000/100000 | Recent Avg: 9.5 | ε: 0.0100 | α: 0.0100
Episode 60000/100000 | ε: 0.0100 | α: 0.0100 | Eval: 35.1 | Success: 17.5% | Time: 1099.9s
Episode 61000/100000 | Recent Avg: 23.5 | ε: 0.0100 | α: 0.0100
Episode 62000/100000 | Recent Avg: 0.9 | ε: 0.0100 | α: 0.0100
Episode 63000/100000 | Recent Avg: 18.2 | ε: 0.0100 | α: 0.0100
Episode 64000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -23.6 | Success: 7.5% | Time: 1190.2s
Episode 65000/100000 | Recent Avg: -19.6 | ε: 0.0100 | α: 0.0100
Episode 66000/100000 | Recent Avg: -27.0 | ε: 0.0100 | α: 0.0100
Episode 67000/100000 | Recent Avg: -29.2 | ε: 0.0100 | α: 0.0100
Episode 68000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -63.6 | Success: 5.0% | Time: 1276.2s
Episode 69000/100000 | Recent Avg: -48.0 | ε: 0.0100 | α: 0.0100
Episode 70000/100000 | Recent Avg: -73.1 | ε: 0.0100 | α: 0.0100
Episode 71000/100000 | Recent Avg: -50.1 | ε: 0.0100 | α: 0.0100
Episode 72000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -96.0 | Success: 5.0% | Time: 1367.6s
Episode 73000/100000 | Recent Avg: -34.6 | ε: 0.0100 | α: 0.0100
Episode 74000/100000 | Recent Avg: -28.8 | ε: 0.0100 | α: 0.0100
Episode 75000/100000 | Recent Avg: -31.5 | ε: 0.0100 | α: 0.0100
Episode 76000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -68.4 | Success: 5.0% | Time: 1462.3s
Episode 77000/100000 | Recent Avg: -24.5 | ε: 0.0100 | α: 0.0100
Episode 78000/100000 | Recent Avg: -14.2 | ε: 0.0100 | α: 0.0100
Episode 79000/100000 | Recent Avg: -38.0 | ε: 0.0100 | α: 0.0100
Episode 80000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -52.1 | Success: 17.5% | Time: 1546.9s
Episode 81000/100000 | Recent Avg: -64.5 | ε: 0.0100 | α: 0.0100
Episode 82000/100000 | Recent Avg: -47.1 | ε: 0.0100 | α: 0.0100
Episode 83000/100000 | Recent Avg: -59.2 | ε: 0.0100 | α: 0.0100
Episode 84000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -116.7 | Success: 5.0% | Time: 1627.6s
Episode 85000/100000 | Recent Avg: -59.4 | ε: 0.0100 | α: 0.0100
Episode 86000/100000 | Recent Avg: -54.2 | ε: 0.0100 | α: 0.0100
Episode 87000/100000 | Recent Avg: -53.7 | ε: 0.0100 | α: 0.0100
Episode 88000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -21.9 | Success: 10.0% | Time: 1717.6s
Episode 89000/100000 | Recent Avg: -45.6 | ε: 0.0100 | α: 0.0100
Episode 90000/100000 | Recent Avg: -33.9 | ε: 0.0100 | α: 0.0100
Episode 91000/100000 | Recent Avg: -35.6 | ε: 0.0100 | α: 0.0100
Episode 92000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -55.8 | Success: 0.0% | Time: 1797.4s
Episode 93000/100000 | Recent Avg: -37.0 | ε: 0.0100 | α: 0.0100
Episode 94000/100000 | Recent Avg: -49.4 | ε: 0.0100 | α: 0.0100
Episode 95000/100000 | Recent Avg: -23.2 | ε: 0.0100 | α: 0.0100
Episode 96000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -101.7 | Success: 5.0% | Time: 1879.9s
Episode 97000/100000 | Recent Avg: -46.7 | ε: 0.0100 | α: 0.0100
Episode 98000/100000 | Recent Avg: -59.0 | ε: 0.0100 | α: 0.0100
Episode 99000/100000 | Recent Avg: -17.4 | ε: 0.0100 | α: 0.0100
Episode 100000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -4.3 | Success: 12.5% | Time: 1964.4s

======================================================================
TRAINING COMPLETE
Total Time: 32.7 minutes
States Visited: 7460
Total Updates: 33876128
Final ε: 0.0100
Final α: 0.0100
======================================================================


[2/3] Training SARSA Agent...

======================================================================
TRAINING SARSA AGENT (ENHANCED)
======================================================================
Episodes: 100000
Learning Rate: 0.1 → 0.01
Discount Factor: 0.99
Epsilon Decay: 0.99992
Reward Shaping: ENABLED
Optimistic Init: ENABLED
======================================================================

Episode 1000/100000 | Recent Avg: -172.0 | ε: 0.9231 | α: 0.0951
Episode 2000/100000 | Recent Avg: -143.2 | ε: 0.8521 | α: 0.0905
Episode 3000/100000 | Recent Avg: -134.7 | ε: 0.7866 | α: 0.0861
Episode 4000/100000 | ε: 0.7261 | α: 0.0819 | Eval: -189.3 | Success: 0.0% | Time: 22.4s
Episode 5000/100000 | Recent Avg: -119.3 | ε: 0.6703 | α: 0.0779
Episode 6000/100000 | Recent Avg: -100.7 | ε: 0.6188 | α: 0.0741
Episode 7000/100000 | Recent Avg: -95.8 | ε: 0.5712 | α: 0.0705
Episode 8000/100000 | ε: 0.5273 | α: 0.0670 | Eval: -287.4 | Success: 0.0% | Time: 53.7s
Episode 9000/100000 | Recent Avg: -86.3 | ε: 0.4867 | α: 0.0638
Episode 10000/100000 | Recent Avg: -87.0 | ε: 0.4493 | α: 0.0607
Episode 11000/100000 | Recent Avg: -78.8 | ε: 0.4148 | α: 0.0577
Episode 12000/100000 | ε: 0.3829 | α: 0.0549 | Eval: -162.4 | Success: 0.0% | Time: 100.2s
Episode 13000/100000 | Recent Avg: -83.5 | ε: 0.3534 | α: 0.0522
Episode 14000/100000 | Recent Avg: -77.0 | ε: 0.3263 | α: 0.0497
Episode 15000/100000 | Recent Avg: -83.5 | ε: 0.3012 | α: 0.0472
Episode 16000/100000 | ε: 0.2780 | α: 0.0449 | Eval: -145.7 | Success: 2.5% | Time: 161.7s
Episode 17000/100000 | Recent Avg: -95.0 | ε: 0.2566 | α: 0.0427
Episode 18000/100000 | Recent Avg: -96.2 | ε: 0.2369 | α: 0.0407
Episode 19000/100000 | Recent Avg: -97.5 | ε: 0.2187 | α: 0.0387
Episode 20000/100000 | ε: 0.2019 | α: 0.0368 | Eval: -169.9 | Success: 0.0% | Time: 230.6s
Episode 21000/100000 | Recent Avg: -96.8 | ε: 0.1864 | α: 0.0350
Episode 22000/100000 | Recent Avg: -83.8 | ε: 0.1720 | α: 0.0333
Episode 23000/100000 | Recent Avg: -85.1 | ε: 0.1588 | α: 0.0317
Episode 24000/100000 | ε: 0.1466 | α: 0.0301 | Eval: -176.7 | Success: 0.0% | Time: 308.3s
Episode 25000/100000 | Recent Avg: -85.5 | ε: 0.1353 | α: 0.0286
Episode 26000/100000 | Recent Avg: -94.1 | ε: 0.1249 | α: 0.0273
Episode 27000/100000 | Recent Avg: -65.6 | ε: 0.1153 | α: 0.0259
Episode 28000/100000 | ε: 0.1064 | α: 0.0247 | Eval: -124.4 | Success: 2.5% | Time: 390.6s
Episode 29000/100000 | Recent Avg: -82.2 | ε: 0.0983 | α: 0.0235
Episode 30000/100000 | Recent Avg: -86.9 | ε: 0.0907 | α: 0.0223
Episode 31000/100000 | Recent Avg: -87.2 | ε: 0.0837 | α: 0.0212
Episode 32000/100000 | ε: 0.0773 | α: 0.0202 | Eval: -140.7 | Success: 0.0% | Time: 474.6s
Episode 33000/100000 | Recent Avg: -87.5 | ε: 0.0714 | α: 0.0192
Episode 34000/100000 | Recent Avg: -78.6 | ε: 0.0659 | α: 0.0183
Episode 35000/100000 | Recent Avg: -78.2 | ε: 0.0608 | α: 0.0174
Episode 36000/100000 | ε: 0.0561 | α: 0.0165 | Eval: -125.7 | Success: 0.0% | Time: 559.9s
Episode 37000/100000 | Recent Avg: -95.6 | ε: 0.0518 | α: 0.0157
Episode 38000/100000 | Recent Avg: -88.3 | ε: 0.0478 | α: 0.0150
Episode 39000/100000 | Recent Avg: -102.8 | ε: 0.0442 | α: 0.0142
Episode 40000/100000 | ε: 0.0408 | α: 0.0135 | Eval: -50.3 | Success: 7.5% | Time: 651.8s
Episode 41000/100000 | Recent Avg: -67.5 | ε: 0.0376 | α: 0.0129
Episode 42000/100000 | Recent Avg: -45.3 | ε: 0.0347 | α: 0.0122
Episode 43000/100000 | Recent Avg: -55.8 | ε: 0.0321 | α: 0.0116
Episode 44000/100000 | ε: 0.0296 | α: 0.0111 | Eval: -90.1 | Success: 2.5% | Time: 735.1s
Episode 45000/100000 | Recent Avg: -41.8 | ε: 0.0273 | α: 0.0105
Episode 46000/100000 | Recent Avg: -48.8 | ε: 0.0252 | α: 0.0100
Episode 47000/100000 | Recent Avg: -42.7 | ε: 0.0233 | α: 0.0100
Episode 48000/100000 | ε: 0.0215 | α: 0.0100 | Eval: -75.4 | Success: 12.5% | Time: 827.9s
Episode 49000/100000 | Recent Avg: -69.0 | ε: 0.0198 | α: 0.0100
Episode 50000/100000 | Recent Avg: -56.7 | ε: 0.0183 | α: 0.0100
Episode 51000/100000 | Recent Avg: -52.1 | ε: 0.0169 | α: 0.0100
Episode 52000/100000 | ε: 0.0156 | α: 0.0100 | Eval: -51.4 | Success: 7.5% | Time: 922.3s
Episode 53000/100000 | Recent Avg: -48.1 | ε: 0.0144 | α: 0.0100
Episode 54000/100000 | Recent Avg: -52.2 | ε: 0.0133 | α: 0.0100
Episode 55000/100000 | Recent Avg: -38.4 | ε: 0.0123 | α: 0.0100
Episode 56000/100000 | ε: 0.0113 | α: 0.0100 | Eval: -26.6 | Success: 5.0% | Time: 1018.3s
Episode 57000/100000 | Recent Avg: -12.4 | ε: 0.0105 | α: 0.0100
Episode 58000/100000 | Recent Avg: -24.7 | ε: 0.0100 | α: 0.0100
Episode 59000/100000 | Recent Avg: -19.9 | ε: 0.0100 | α: 0.0100
Episode 60000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -0.1 | Success: 12.5% | Time: 1111.4s
Episode 61000/100000 | Recent Avg: -47.9 | ε: 0.0100 | α: 0.0100
Episode 62000/100000 | Recent Avg: -39.2 | ε: 0.0100 | α: 0.0100
Episode 63000/100000 | Recent Avg: -20.9 | ε: 0.0100 | α: 0.0100
Episode 64000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -74.7 | Success: 5.0% | Time: 1214.6s
Episode 65000/100000 | Recent Avg: -19.9 | ε: 0.0100 | α: 0.0100
Episode 66000/100000 | Recent Avg: -30.7 | ε: 0.0100 | α: 0.0100
Episode 67000/100000 | Recent Avg: -33.2 | ε: 0.0100 | α: 0.0100
Episode 68000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -81.7 | Success: 5.0% | Time: 1308.2s
Episode 69000/100000 | Recent Avg: -10.2 | ε: 0.0100 | α: 0.0100
Episode 70000/100000 | Recent Avg: -7.3 | ε: 0.0100 | α: 0.0100
Episode 71000/100000 | Recent Avg: -16.3 | ε: 0.0100 | α: 0.0100
Episode 72000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -5.4 | Success: 15.0% | Time: 1409.4s
Episode 73000/100000 | Recent Avg: -21.2 | ε: 0.0100 | α: 0.0100
Episode 74000/100000 | Recent Avg: -13.3 | ε: 0.0100 | α: 0.0100
Episode 75000/100000 | Recent Avg: -6.5 | ε: 0.0100 | α: 0.0100
Episode 76000/100000 | ε: 0.0100 | α: 0.0100 | Eval: 1.9 | Success: 12.5% | Time: 1525.0s
Episode 77000/100000 | Recent Avg: -8.9 | ε: 0.0100 | α: 0.0100
Episode 78000/100000 | Recent Avg: -20.1 | ε: 0.0100 | α: 0.0100
Episode 79000/100000 | Recent Avg: -4.5 | ε: 0.0100 | α: 0.0100
Episode 80000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -1.7 | Success: 10.0% | Time: 1634.8s
Episode 81000/100000 | Recent Avg: 2.2 | ε: 0.0100 | α: 0.0100
Episode 82000/100000 | Recent Avg: -35.4 | ε: 0.0100 | α: 0.0100
Episode 83000/100000 | Recent Avg: -36.7 | ε: 0.0100 | α: 0.0100
Episode 84000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -48.1 | Success: 7.5% | Time: 1745.8s
Episode 85000/100000 | Recent Avg: -29.0 | ε: 0.0100 | α: 0.0100
Episode 86000/100000 | Recent Avg: 4.6 | ε: 0.0100 | α: 0.0100
Episode 87000/100000 | Recent Avg: -15.4 | ε: 0.0100 | α: 0.0100
Episode 88000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -31.2 | Success: 0.0% | Time: 1854.1s
Episode 89000/100000 | Recent Avg: -19.0 | ε: 0.0100 | α: 0.0100
Episode 90000/100000 | Recent Avg: -29.2 | ε: 0.0100 | α: 0.0100
Episode 91000/100000 | Recent Avg: -47.4 | ε: 0.0100 | α: 0.0100
Episode 92000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -33.1 | Success: 15.0% | Time: 1960.9s
Episode 93000/100000 | Recent Avg: -15.6 | ε: 0.0100 | α: 0.0100
Episode 94000/100000 | Recent Avg: -17.7 | ε: 0.0100 | α: 0.0100
Episode 95000/100000 | Recent Avg: -16.9 | ε: 0.0100 | α: 0.0100
Episode 96000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -63.3 | Success: 10.0% | Time: 2057.7s
Episode 97000/100000 | Recent Avg: -30.6 | ε: 0.0100 | α: 0.0100
Episode 98000/100000 | Recent Avg: -41.7 | ε: 0.0100 | α: 0.0100
Episode 99000/100000 | Recent Avg: -47.2 | ε: 0.0100 | α: 0.0100
Episode 100000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -50.2 | Success: 2.5% | Time: 2169.0s

======================================================================
TRAINING COMPLETE
Total Time: 36.2 minutes
States Visited: 7825
Total Updates: 39950762
Final ε: 0.0100
Final α: 0.0100
======================================================================


[3/3] Training Monte Carlo Agent...

======================================================================
TRAINING MONTE CARLO AGENT (ENHANCED)
======================================================================
Episodes: 100000
Learning Rate: 0.1 → 0.01
Reward Shaping: ENABLED
Optimistic Init: ENABLED
======================================================================

Episode 1000/100000 | Recent Avg: -170.4 | ε: 0.9231 | α: 0.0951
Episode 2000/100000 | Recent Avg: -142.8 | ε: 0.8521 | α: 0.0905
Episode 3000/100000 | Recent Avg: -125.6 | ε: 0.7866 | α: 0.0861
Episode 4000/100000 | ε: 0.7261 | α: 0.0819 | Eval: -95.0 | Success: 0.0% | Time: 19.4s
Episode 5000/100000 | Recent Avg: -122.4 | ε: 0.6703 | α: 0.0779
Episode 6000/100000 | Recent Avg: -114.8 | ε: 0.6188 | α: 0.0741
Episode 7000/100000 | Recent Avg: -114.4 | ε: 0.5712 | α: 0.0705
Episode 8000/100000 | ε: 0.5273 | α: 0.0670 | Eval: -115.6 | Success: 0.0% | Time: 39.4s
Episode 9000/100000 | Recent Avg: -107.1 | ε: 0.4867 | α: 0.0638
Episode 10000/100000 | Recent Avg: -113.3 | ε: 0.4493 | α: 0.0607
Episode 11000/100000 | Recent Avg: -109.1 | ε: 0.4148 | α: 0.0577
Episode 12000/100000 | ε: 0.3829 | α: 0.0549 | Eval: -116.4 | Success: 0.0% | Time: 59.1s
Episode 13000/100000 | Recent Avg: -105.8 | ε: 0.3534 | α: 0.0522
Episode 14000/100000 | Recent Avg: -99.0 | ε: 0.3263 | α: 0.0497
Episode 15000/100000 | Recent Avg: -99.3 | ε: 0.3012 | α: 0.0472
Episode 16000/100000 | ε: 0.2780 | α: 0.0449 | Eval: -98.2 | Success: 0.0% | Time: 78.7s
Episode 17000/100000 | Recent Avg: -99.4 | ε: 0.2566 | α: 0.0427
Episode 18000/100000 | Recent Avg: -100.4 | ε: 0.2369 | α: 0.0407
Episode 19000/100000 | Recent Avg: -108.0 | ε: 0.2187 | α: 0.0387
Episode 20000/100000 | ε: 0.2019 | α: 0.0368 | Eval: -117.7 | Success: 0.0% | Time: 99.4s
Episode 21000/100000 | Recent Avg: -84.3 | ε: 0.1864 | α: 0.0350
Episode 22000/100000 | Recent Avg: -92.8 | ε: 0.1720 | α: 0.0333
Episode 23000/100000 | Recent Avg: -84.0 | ε: 0.1588 | α: 0.0317
Episode 24000/100000 | ε: 0.1466 | α: 0.0301 | Eval: -117.4 | Success: 0.0% | Time: 118.6s
Episode 25000/100000 | Recent Avg: -95.5 | ε: 0.1353 | α: 0.0286
Episode 26000/100000 | Recent Avg: -86.5 | ε: 0.1249 | α: 0.0273
Episode 27000/100000 | Recent Avg: -95.4 | ε: 0.1153 | α: 0.0259
Episode 28000/100000 | ε: 0.1064 | α: 0.0247 | Eval: -102.5 | Success: 0.0% | Time: 137.5s
Episode 29000/100000 | Recent Avg: -80.9 | ε: 0.0983 | α: 0.0235
Episode 30000/100000 | Recent Avg: -81.7 | ε: 0.0907 | α: 0.0223
Episode 31000/100000 | Recent Avg: -81.9 | ε: 0.0837 | α: 0.0212
Episode 32000/100000 | ε: 0.0773 | α: 0.0202 | Eval: -63.2 | Success: 0.0% | Time: 157.3s
Episode 33000/100000 | Recent Avg: -90.2 | ε: 0.0714 | α: 0.0192
Episode 34000/100000 | Recent Avg: -85.4 | ε: 0.0659 | α: 0.0183
Episode 35000/100000 | Recent Avg: -80.2 | ε: 0.0608 | α: 0.0174
Episode 36000/100000 | ε: 0.0561 | α: 0.0165 | Eval: -63.8 | Success: 0.0% | Time: 175.9s
Episode 37000/100000 | Recent Avg: -68.1 | ε: 0.0518 | α: 0.0157
Episode 38000/100000 | Recent Avg: -93.1 | ε: 0.0478 | α: 0.0150
Episode 39000/100000 | Recent Avg: -102.0 | ε: 0.0442 | α: 0.0142
Episode 40000/100000 | ε: 0.0408 | α: 0.0135 | Eval: -99.8 | Success: 0.0% | Time: 193.6s
Episode 41000/100000 | Recent Avg: -93.1 | ε: 0.0376 | α: 0.0129
Episode 42000/100000 | Recent Avg: -82.1 | ε: 0.0347 | α: 0.0122
Episode 43000/100000 | Recent Avg: -74.4 | ε: 0.0321 | α: 0.0116
Episode 44000/100000 | ε: 0.0296 | α: 0.0111 | Eval: -67.4 | Success: 0.0% | Time: 211.1s
Episode 45000/100000 | Recent Avg: -80.2 | ε: 0.0273 | α: 0.0105
Episode 46000/100000 | Recent Avg: -68.2 | ε: 0.0252 | α: 0.0100
Episode 47000/100000 | Recent Avg: -60.9 | ε: 0.0233 | α: 0.0100
Episode 48000/100000 | ε: 0.0215 | α: 0.0100 | Eval: -62.5 | Success: 0.0% | Time: 229.9s
Episode 49000/100000 | Recent Avg: -50.7 | ε: 0.0198 | α: 0.0100
Episode 50000/100000 | Recent Avg: -57.9 | ε: 0.0183 | α: 0.0100
Episode 51000/100000 | Recent Avg: -69.5 | ε: 0.0169 | α: 0.0100
Episode 52000/100000 | ε: 0.0156 | α: 0.0100 | Eval: -59.2 | Success: 0.0% | Time: 251.4s
Episode 53000/100000 | Recent Avg: -71.2 | ε: 0.0144 | α: 0.0100
Episode 54000/100000 | Recent Avg: -72.3 | ε: 0.0133 | α: 0.0100
Episode 55000/100000 | Recent Avg: -71.7 | ε: 0.0123 | α: 0.0100
Episode 56000/100000 | ε: 0.0113 | α: 0.0100 | Eval: -72.3 | Success: 0.0% | Time: 274.5s
Episode 57000/100000 | Recent Avg: -66.9 | ε: 0.0105 | α: 0.0100
Episode 58000/100000 | Recent Avg: -68.9 | ε: 0.0100 | α: 0.0100
Episode 59000/100000 | Recent Avg: -70.6 | ε: 0.0100 | α: 0.0100
Episode 60000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -67.7 | Success: 0.0% | Time: 299.0s
Episode 61000/100000 | Recent Avg: -67.9 | ε: 0.0100 | α: 0.0100
Episode 62000/100000 | Recent Avg: -68.9 | ε: 0.0100 | α: 0.0100
Episode 63000/100000 | Recent Avg: -68.2 | ε: 0.0100 | α: 0.0100
Episode 64000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -55.1 | Success: 5.0% | Time: 322.0s
Episode 65000/100000 | Recent Avg: -58.0 | ε: 0.0100 | α: 0.0100
Episode 66000/100000 | Recent Avg: -69.0 | ε: 0.0100 | α: 0.0100
Episode 67000/100000 | Recent Avg: -77.9 | ε: 0.0100 | α: 0.0100
Episode 68000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -85.3 | Success: 0.0% | Time: 341.9s
Episode 69000/100000 | Recent Avg: -78.3 | ε: 0.0100 | α: 0.0100
Episode 70000/100000 | Recent Avg: -61.5 | ε: 0.0100 | α: 0.0100
Episode 71000/100000 | Recent Avg: -59.8 | ε: 0.0100 | α: 0.0100
Episode 72000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -75.5 | Success: 0.0% | Time: 359.8s
Episode 73000/100000 | Recent Avg: -93.4 | ε: 0.0100 | α: 0.0100
Episode 74000/100000 | Recent Avg: -99.6 | ε: 0.0100 | α: 0.0100
Episode 75000/100000 | Recent Avg: -80.9 | ε: 0.0100 | α: 0.0100
Episode 76000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -89.9 | Success: 0.0% | Time: 379.3s
Episode 77000/100000 | Recent Avg: -99.6 | ε: 0.0100 | α: 0.0100
Episode 78000/100000 | Recent Avg: -96.3 | ε: 0.0100 | α: 0.0100
Episode 79000/100000 | Recent Avg: -86.5 | ε: 0.0100 | α: 0.0100
Episode 80000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -81.1 | Success: 0.0% | Time: 398.4s
Episode 81000/100000 | Recent Avg: -85.1 | ε: 0.0100 | α: 0.0100
Episode 82000/100000 | Recent Avg: -84.7 | ε: 0.0100 | α: 0.0100
Episode 83000/100000 | Recent Avg: -87.8 | ε: 0.0100 | α: 0.0100
Episode 84000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -83.2 | Success: 0.0% | Time: 417.5s
Episode 85000/100000 | Recent Avg: -81.5 | ε: 0.0100 | α: 0.0100
Episode 86000/100000 | Recent Avg: -85.7 | ε: 0.0100 | α: 0.0100
Episode 87000/100000 | Recent Avg: -85.6 | ε: 0.0100 | α: 0.0100
Episode 88000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -96.8 | Success: 0.0% | Time: 436.7s
Episode 89000/100000 | Recent Avg: -77.7 | ε: 0.0100 | α: 0.0100
Episode 90000/100000 | Recent Avg: -74.1 | ε: 0.0100 | α: 0.0100
Episode 91000/100000 | Recent Avg: -74.0 | ε: 0.0100 | α: 0.0100
Episode 92000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -77.3 | Success: 0.0% | Time: 455.8s
Episode 93000/100000 | Recent Avg: -81.3 | ε: 0.0100 | α: 0.0100
Episode 94000/100000 | Recent Avg: -75.9 | ε: 0.0100 | α: 0.0100
Episode 95000/100000 | Recent Avg: -66.2 | ε: 0.0100 | α: 0.0100
Episode 96000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -63.8 | Success: 0.0% | Time: 474.6s
Episode 97000/100000 | Recent Avg: -63.1 | ε: 0.0100 | α: 0.0100
Episode 98000/100000 | Recent Avg: -59.2 | ε: 0.0100 | α: 0.0100
Episode 99000/100000 | Recent Avg: -63.6 | ε: 0.0100 | α: 0.0100
Episode 100000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -62.8 | Success: 0.0% | Time: 493.3s

======================================================================
TRAINING COMPLETE
Total Time: 8.2 minutes
States Visited: 7740
======================================================================


======================================================================
FINAL EVALUATION (100 episodes each)
======================================================================

Q-Learning Enhanced:
  Mean: -20.85 ± 183.30
  Success Rate: 14.0%

SARSA Enhanced:
  Mean: -34.63 ± 116.45
  Success Rate: 6.0%

Monte Carlo Enhanced:
  Mean: -60.72 ± 46.95
  Success Rate: 0.0%

Generating comparison plots...
Plot saved to: outputs/training_enhanced.png

Training complete!
Models saved with '_enhanced' suffix
PS C:\Users\cmano\Downloads\betterLunarLander> python .\lander_with_improvements.py

======================================================================
AGGRESSIVE IMPROVEMENTS - SARSA FOCUSED
======================================================================

 Training SARSA with AGGRESSIVE enhancements...

======================================================================
AGGRESSIVE TRAINING: SARSA
======================================================================
Episodes: 500000 (200K for better learning)
Bins: 10 per dimension
Learning Rate: 0.15 → 0.005
Epsilon Decay: 0.999975 (VERY SLOW)
Reward Shaping Weight: 0.5 (STRONG)
Optimistic Init: 10.0
======================================================================

C:\Users\cmano\AppData\Roaming\Python\Python311\site-packages\pygame\pkgdata.py:25: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import resource_stream, resource_exists
Ep 2000/500000 | Recent Avg: -121.3 | ε: 0.9512
Ep 4000/500000 | Recent Avg: -101.8 | ε: 0.9048
Ep 5000/500000 | Stage 0 | ε: 0.8825 | α: 0.1463 | Eval: -181.6 | Success: 0.0% | Time: 0.7m
Ep 6000/500000 | Recent Avg: -88.6 | ε: 0.8607
Ep 8000/500000 | Recent Avg: -86.3 | ε: 0.8187
Ep 10000/500000 | Stage 0 | ε: 0.7788 | α: 0.1427 | Eval: -239.1 | Success: 0.0% | Time: 1.6m
Ep 12000/500000 | Recent Avg: -83.6 | ε: 0.7408
Ep 14000/500000 | Recent Avg: -84.5 | ε: 0.7047
Ep 15000/500000 | Stage 0 | ε: 0.6873 | α: 0.1392 | Eval: -198.8 | Success: 0.0% | Time: 2.6m
Ep 16000/500000 | Recent Avg: -82.2 | ε: 0.6703
Ep 18000/500000 | Recent Avg: -77.7 | ε: 0.6376
Ep 20000/500000 | Stage 0 | ε: 0.6065 | α: 0.1357 | Eval: -177.3 | Success: 0.0% | Time: 3.9m
Ep 22000/500000 | Recent Avg: -77.3 | ε: 0.5769
Ep 24000/500000 | Recent Avg: -76.4 | ε: 0.5488
Ep 25000/500000 | Stage 0 | ε: 0.5353 | α: 0.1324 | Eval: -248.8 | Success: 0.0% | Time: 5.3m
Ep 26000/500000 | Recent Avg: -73.9 | ε: 0.5220
Ep 28000/500000 | Recent Avg: -72.7 | ε: 0.4966
Ep 30000/500000 | Stage 0 | ε: 0.4724 | α: 0.1291 | Eval: -198.7 | Success: 5.0% | Time: 6.9m
Ep 32000/500000 | Recent Avg: -76.0 | ε: 0.4493
Ep 34000/500000 | Recent Avg: -77.7 | ε: 0.4274
Ep 35000/500000 | Stage 0 | ε: 0.4169 | α: 0.1259 | Eval: -159.6 | Success: 0.0% | Time: 8.6m
Ep 36000/500000 | Recent Avg: -75.0 | ε: 0.4066
Ep 38000/500000 | Recent Avg: -79.7 | ε: 0.3867
Ep 40000/500000 | Stage 0 | ε: 0.3679 | α: 0.1228 | Eval: -165.0 | Success: 5.0% | Time: 10.2m
Ep 42000/500000 | Recent Avg: -78.3 | ε: 0.3499
Ep 44000/500000 | Recent Avg: -82.6 | ε: 0.3329
Ep 45000/500000 | Stage 0 | ε: 0.3246 | α: 0.1198 | Eval: -105.3 | Success: 5.0% | Time: 13.3m
Ep 46000/500000 | Recent Avg: -69.6 | ε: 0.3166
Ep 48000/500000 | Recent Avg: -60.0 | ε: 0.3012
Ep 50000/500000 | Stage 0 | ε: 0.2865 | α: 0.1168 | Eval: -108.5 | Success: 10.0% | Time: 17.5m
Ep 52000/500000 | Recent Avg: -75.8 | ε: 0.2725
Ep 54000/500000 | Recent Avg: -62.7 | ε: 0.2592
Ep 55000/500000 | Stage 0 | ε: 0.2528 | α: 0.1139 | Eval: -100.6 | Success: 0.0% | Time: 21.6m
Ep 56000/500000 | Recent Avg: -67.5 | ε: 0.2466
Ep 58000/500000 | Recent Avg: -65.9 | ε: 0.2346
Ep 60000/500000 | Stage 0 | ε: 0.2231 | α: 0.1111 | Eval: -156.3 | Success: 0.0% | Time: 25.7m
Ep 62000/500000 | Recent Avg: -56.4 | ε: 0.2122
Ep 64000/500000 | Recent Avg: -55.7 | ε: 0.2019
Ep 65000/500000 | Stage 0 | ε: 0.1969 | α: 0.1084 | Eval: -104.2 | Success: 0.0% | Time: 30.1m
Ep 66000/500000 | Recent Avg: -44.0 | ε: 0.1920
Ep 68000/500000 | Recent Avg: -27.8 | ε: 0.1827
Ep 70000/500000 | Stage 0 | ε: 0.1738 | α: 0.1057 | Eval: -73.9 | Success: 10.0% | Time: 34.8m
Ep 72000/500000 | Recent Avg: -52.9 | ε: 0.1653
Ep 74000/500000 | Recent Avg: -47.0 | ε: 0.1572
Ep 75000/500000 | Stage 0 | ε: 0.1534 | α: 0.1031 | Eval: -66.7 | Success: 0.0% | Time: 38.9m
Ep 76000/500000 | Recent Avg: -33.6 | ε: 0.1496
Ep 78000/500000 | Recent Avg: -32.1 | ε: 0.1423
Ep 80000/500000 | Stage 0 | ε: 0.1353 | α: 0.1005 | Eval: -109.7 | Success: 0.0% | Time: 43.6m
Ep 82000/500000 | Recent Avg: -21.5 | ε: 0.1287
Ep 84000/500000 | Recent Avg: -26.9 | ε: 0.1225
Ep 85000/500000 | Stage 0 | ε: 0.1194 | α: 0.0981 | Eval: -95.3 | Success: 5.0% | Time: 48.3m
Ep 86000/500000 | Recent Avg: -15.6 | ε: 0.1165
Ep 88000/500000 | Recent Avg: -15.4 | ε: 0.1108
Ep 90000/500000 | Stage 0 | ε: 0.1054 | α: 0.0956 | Eval: -92.3 | Success: 0.0% | Time: 53.2m
Ep 92000/500000 | Recent Avg: -11.2 | ε: 0.1003
Ep 94000/500000 | Recent Avg: -14.6 | ε: 0.0954
Ep 95000/500000 | Stage 0 | ε: 0.0930 | α: 0.0933 | Eval: -88.0 | Success: 0.0% | Time: 58.1m
Ep 96000/500000 | Recent Avg: -14.7 | ε: 0.0907
Ep 98000/500000 | Recent Avg: -20.9 | ε: 0.0863
Ep 100000/500000 | Stage 0 | ε: 0.0821 | α: 0.0910 | Eval: -31.6 | Success: 10.0% | Time: 62.9m
Ep 102000/500000 | Recent Avg: -12.2 | ε: 0.0781
Ep 104000/500000 | Recent Avg: 0.9 | ε: 0.0743
Ep 105000/500000 | Stage 0 | ε: 0.0724 | α: 0.0887 | Eval: -25.5 | Success: 0.0% | Time: 68.0m
Ep 106000/500000 | Recent Avg: -10.6 | ε: 0.0706
Ep 108000/500000 | Recent Avg: 4.0 | ε: 0.0672
Ep 110000/500000 | Stage 0 | ε: 0.0639 | α: 0.0865 | Eval: 2.0 | Success: 5.0% | Time: 73.1m
Ep 112000/500000 | Recent Avg: 15.7 | ε: 0.0608
Ep 114000/500000 | Recent Avg: 34.1 | ε: 0.0578
Ep 115000/500000 | Stage 0 | ε: 0.0564 | α: 0.0844 | Eval: -32.5 | Success: 10.0% | Time: 78.3m
Ep 116000/500000 | Recent Avg: 30.0 | ε: 0.0550
Ep 118000/500000 | Recent Avg: 21.4 | ε: 0.0523
Ep 120000/500000 | Stage 0 | ε: 0.0498 | α: 0.0823 | Eval: -47.4 | Success: 5.0% | Time: 83.7m
Ep 122000/500000 | Recent Avg: 30.1 | ε: 0.0474
Ep 124000/500000 | Recent Avg: 32.8 | ε: 0.0450
Ep 125000/500000 | Stage 0 | ε: 0.0439 | α: 0.0803 | Eval: 16.0 | Success: 5.0% | Time: 88.9m
Ep 126000/500000 | Recent Avg: 39.0 | ε: 0.0429
Ep 128000/500000 | Recent Avg: 30.3 | ε: 0.0408
Ep 130000/500000 | Stage 0 | ε: 0.0388 | α: 0.0783 | Eval: -13.5 | Success: 0.0% | Time: 94.3m
Ep 132000/500000 | Recent Avg: 27.1 | ε: 0.0369
Ep 134000/500000 | Recent Avg: 53.9 | ε: 0.0351
Ep 135000/500000 | Stage 0 | ε: 0.0342 | α: 0.0764 | Eval: 43.0 | Success: 25.0% | Time: 99.6m
Ep 136000/500000 | Recent Avg: 55.2 | ε: 0.0334
Ep 138000/500000 | Recent Avg: 26.7 | ε: 0.0317
Ep 140000/500000 | Stage 0 | ε: 0.0302 | α: 0.0745 | Eval: -13.8 | Success: 10.0% | Time: 102.5m
Ep 142000/500000 | Recent Avg: 41.7 | ε: 0.0287
Ep 144000/500000 | Recent Avg: 50.9 | ε: 0.0273
Ep 145000/500000 | Stage 0 | ε: 0.0266 | α: 0.0726 | Eval: 14.6 | Success: 5.0% | Time: 105.0m
Ep 146000/500000 | Recent Avg: 46.5 | ε: 0.0260
Ep 148000/500000 | Recent Avg: 49.4 | ε: 0.0247
Ep 150000/500000 | Stage 0 | ε: 0.0235 | α: 0.0709 | Eval: 8.9 | Success: 15.0% | Time: 107.4m
Ep 152000/500000 | Recent Avg: 52.4 | ε: 0.0224
Ep 154000/500000 | Recent Avg: 71.8 | ε: 0.0213
Ep 155000/500000 | Stage 0 | ε: 0.0208 | α: 0.0691 | Eval: 48.3 | Success: 25.0% | Time: 109.8m
Ep 156000/500000 | Recent Avg: 61.7 | ε: 0.0202
Ep 158000/500000 | Recent Avg: 58.7 | ε: 0.0193
Ep 160000/500000 | Stage 0 | ε: 0.0183 | α: 0.0674 | Eval: 41.7 | Success: 10.0% | Time: 112.2m
Ep 162000/500000 | Recent Avg: 66.6 | ε: 0.0174
Ep 164000/500000 | Recent Avg: 61.8 | ε: 0.0166
Ep 165000/500000 | Stage 0 | ε: 0.0162 | α: 0.0657 | Eval: 87.7 | Success: 45.0% | Time: 114.7m
Ep 166000/500000 | Recent Avg: 64.9 | ε: 0.0158
Ep 168000/500000 | Recent Avg: 81.5 | ε: 0.0150
Ep 170000/500000 | Stage 1 | ε: 0.0143 | α: 0.0641 | Eval: 85.4 | Success: 20.0% | Time: 117.3m
Ep 172000/500000 | Recent Avg: 85.6 | ε: 0.0136
Ep 174000/500000 | Recent Avg: 86.1 | ε: 0.0129
Ep 175000/500000 | Stage 1 | ε: 0.0126 | α: 0.0625 | Eval: 106.8 | Success: 15.0% | Time: 119.8m
Ep 176000/500000 | Recent Avg: 85.8 | ε: 0.0123
Ep 178000/500000 | Recent Avg: 89.2 | ε: 0.0117
Ep 180000/500000 | Stage 1 | ε: 0.0111 | α: 0.0610 | Eval: 127.8 | Success: 20.0% | Time: 122.3m
Ep 182000/500000 | Recent Avg: 129.7 | ε: 0.0106
Ep 184000/500000 | Recent Avg: 145.1 | ε: 0.0101
Ep 185000/500000 | Stage 1 | ε: 0.0100 | α: 0.0595 | Eval: 69.0 | Success: 15.0% | Time: 124.8m
Ep 186000/500000 | Recent Avg: 121.2 | ε: 0.0100
Ep 188000/500000 | Recent Avg: 134.0 | ε: 0.0100
Ep 190000/500000 | Stage 1 | ε: 0.0100 | α: 0.0580 | Eval: 119.6 | Success: 15.0% | Time: 127.5m
Ep 192000/500000 | Recent Avg: 132.5 | ε: 0.0100
Ep 194000/500000 | Recent Avg: 140.1 | ε: 0.0100
Ep 195000/500000 | Stage 1 | ε: 0.0100 | α: 0.0566 | Eval: 111.9 | Success: 20.0% | Time: 130.0m
Ep 196000/500000 | Recent Avg: 119.7 | ε: 0.0100
Ep 198000/500000 | Recent Avg: 125.0 | ε: 0.0100
Ep 200000/500000 | Stage 1 | ε: 0.0100 | α: 0.0552 | Eval: 144.1 | Success: 35.0% | Time: 132.5m
Ep 202000/500000 | Recent Avg: 128.5 | ε: 0.0100
Ep 204000/500000 | Recent Avg: 113.0 | ε: 0.0100
Ep 205000/500000 | Stage 1 | ε: 0.0100 | α: 0.0538 | Eval: 136.7 | Success: 35.0% | Time: 135.1m
Ep 206000/500000 | Recent Avg: 115.6 | ε: 0.0100
Ep 208000/500000 | Recent Avg: 105.0 | ε: 0.0100
Ep 210000/500000 | Stage 1 | ε: 0.0100 | α: 0.0525 | Eval: 58.2 | Success: 25.0% | Time: 137.4m
Ep 212000/500000 | Recent Avg: 111.4 | ε: 0.0100
Ep 214000/500000 | Recent Avg: 109.1 | ε: 0.0100
Ep 215000/500000 | Stage 1 | ε: 0.0100 | α: 0.0512 | Eval: 138.5 | Success: 25.0% | Time: 139.9m
Ep 216000/500000 | Recent Avg: 119.7 | ε: 0.0100
Ep 218000/500000 | Recent Avg: 124.1 | ε: 0.0100
Ep 220000/500000 | Stage 1 | ε: 0.0100 | α: 0.0499 | Eval: 140.5 | Success: 40.0% | Time: 142.4m
Ep 222000/500000 | Recent Avg: 125.3 | ε: 0.0100
Ep 224000/500000 | Recent Avg: 127.4 | ε: 0.0100
Ep 225000/500000 | Stage 1 | ε: 0.0100 | α: 0.0487 | Eval: 64.0 | Success: 5.0% | Time: 144.8m
Ep 226000/500000 | Recent Avg: 106.2 | ε: 0.0100
Ep 228000/500000 | Recent Avg: 107.3 | ε: 0.0100
Ep 230000/500000 | Stage 1 | ε: 0.0100 | α: 0.0475 | Eval: 107.1 | Success: 30.0% | Time: 147.2m
Ep 232000/500000 | Recent Avg: 89.1 | ε: 0.0100
Ep 234000/500000 | Recent Avg: 111.1 | ε: 0.0100
Ep 235000/500000 | Stage 1 | ε: 0.0100 | α: 0.0463 | Eval: 87.3 | Success: 25.0% | Time: 149.6m
Ep 236000/500000 | Recent Avg: 103.0 | ε: 0.0100
Ep 238000/500000 | Recent Avg: 87.8 | ε: 0.0100
Ep 240000/500000 | Stage 1 | ε: 0.0100 | α: 0.0452 | Eval: 53.2 | Success: 10.0% | Time: 151.8m
Ep 242000/500000 | Recent Avg: 93.3 | ε: 0.0100
Ep 244000/500000 | Recent Avg: 105.3 | ε: 0.0100
Ep 245000/500000 | Stage 1 | ε: 0.0100 | α: 0.0441 | Eval: 128.3 | Success: 30.0% | Time: 154.1m
Ep 246000/500000 | Recent Avg: 111.6 | ε: 0.0100
Ep 248000/500000 | Recent Avg: 119.9 | ε: 0.0100
Ep 250000/500000 | Stage 1 | ε: 0.0100 | α: 0.0430 | Eval: 88.1 | Success: 45.0% | Time: 156.5m
Ep 252000/500000 | Recent Avg: 128.3 | ε: 0.0100
Ep 254000/500000 | Recent Avg: 137.6 | ε: 0.0100
Ep 255000/500000 | Stage 1 | ε: 0.0100 | α: 0.0419 | Eval: 57.8 | Success: 10.0% | Time: 158.7m
Ep 256000/500000 | Recent Avg: 119.5 | ε: 0.0100
Ep 258000/500000 | Recent Avg: 120.7 | ε: 0.0100
Ep 260000/500000 | Stage 1 | ε: 0.0100 | α: 0.0409 | Eval: 107.2 | Success: 30.0% | Time: 161.0m
Ep 262000/500000 | Recent Avg: 108.3 | ε: 0.0100
Ep 264000/500000 | Recent Avg: 113.8 | ε: 0.0100
Ep 265000/500000 | Stage 1 | ε: 0.0100 | α: 0.0399 | Eval: 135.3 | Success: 45.0% | Time: 163.5m
Ep 266000/500000 | Recent Avg: 115.4 | ε: 0.0100
Ep 268000/500000 | Recent Avg: 98.5 | ε: 0.0100
Ep 270000/500000 | Stage 1 | ε: 0.0100 | α: 0.0389 | Eval: 139.0 | Success: 30.0% | Time: 165.9m
Ep 272000/500000 | Recent Avg: 131.8 | ε: 0.0100
Ep 274000/500000 | Recent Avg: 136.5 | ε: 0.0100
Ep 275000/500000 | Stage 1 | ε: 0.0100 | α: 0.0379 | Eval: 177.0 | Success: 40.0% | Time: 168.3m
Ep 276000/500000 | Recent Avg: 135.8 | ε: 0.0100
Ep 278000/500000 | Recent Avg: 133.2 | ε: 0.0100
Ep 280000/500000 | Stage 1 | ε: 0.0100 | α: 0.0370 | Eval: 138.2 | Success: 20.0% | Time: 170.8m
Ep 282000/500000 | Recent Avg: 143.4 | ε: 0.0100
Ep 284000/500000 | Recent Avg: 141.5 | ε: 0.0100
Ep 285000/500000 | Stage 1 | ε: 0.0100 | α: 0.0361 | Eval: 168.2 | Success: 50.0% | Time: 173.2m
Ep 286000/500000 | Recent Avg: 141.3 | ε: 0.0100
Ep 288000/500000 | Recent Avg: 123.3 | ε: 0.0100
Ep 290000/500000 | Stage 1 | ε: 0.0100 | α: 0.0352 | Eval: 128.5 | Success: 30.0% | Time: 175.7m
Ep 292000/500000 | Recent Avg: 156.8 | ε: 0.0100
Ep 294000/500000 | Recent Avg: 152.3 | ε: 0.0100
Ep 295000/500000 | Stage 1 | ε: 0.0100 | α: 0.0343 | Eval: 184.5 | Success: 45.0% | Time: 178.2m
Ep 296000/500000 | Recent Avg: 147.7 | ε: 0.0100
Ep 298000/500000 | Recent Avg: 133.6 | ε: 0.0100
Ep 300000/500000 | Stage 1 | ε: 0.0100 | α: 0.0335 | Eval: 151.6 | Success: 30.0% | Time: 180.8m
Ep 302000/500000 | Recent Avg: 120.1 | ε: 0.0100
Ep 304000/500000 | Recent Avg: 147.5 | ε: 0.0100
Ep 305000/500000 | Stage 1 | ε: 0.0100 | α: 0.0326 | Eval: 167.3 | Success: 35.0% | Time: 183.3m
Ep 306000/500000 | Recent Avg: 138.5 | ε: 0.0100
Ep 308000/500000 | Recent Avg: 132.6 | ε: 0.0100
Ep 310000/500000 | Stage 1 | ε: 0.0100 | α: 0.0318 | Eval: 154.5 | Success: 55.0% | Time: 185.8m
Ep 312000/500000 | Recent Avg: 141.2 | ε: 0.0100
Ep 314000/500000 | Recent Avg: 149.6 | ε: 0.0100
Ep 315000/500000 | Stage 1 | ε: 0.0100 | α: 0.0311 | Eval: 115.5 | Success: 20.0% | Time: 188.4m
Ep 316000/500000 | Recent Avg: 150.7 | ε: 0.0100
Ep 318000/500000 | Recent Avg: 140.3 | ε: 0.0100
Ep 320000/500000 | Stage 1 | ε: 0.0100 | α: 0.0303 | Eval: 120.3 | Success: 25.0% | Time: 190.9m
Ep 322000/500000 | Recent Avg: 143.4 | ε: 0.0100
Ep 324000/500000 | Recent Avg: 132.2 | ε: 0.0100
Ep 325000/500000 | Stage 1 | ε: 0.0100 | α: 0.0295 | Eval: 133.0 | Success: 30.0% | Time: 193.4m
Ep 326000/500000 | Recent Avg: 136.3 | ε: 0.0100
Ep 328000/500000 | Recent Avg: 143.3 | ε: 0.0100
Ep 330000/500000 | Stage 1 | ε: 0.0100 | α: 0.0288 | Eval: 133.2 | Success: 20.0% | Time: 196.1m
Ep 332000/500000 | Recent Avg: 133.7 | ε: 0.0100
Ep 334000/500000 | Recent Avg: 142.4 | ε: 0.0100
Ep 335000/500000 | Stage 2 | ε: 0.0100 | α: 0.0281 | Eval: 41.4 | Success: 30.0% | Time: 198.4m
Ep 336000/500000 | Recent Avg: 129.3 | ε: 0.0100
Ep 338000/500000 | Recent Avg: 110.6 | ε: 0.0100
Ep 340000/500000 | Stage 2 | ε: 0.0100 | α: 0.0274 | Eval: 104.6 | Success: 25.0% | Time: 200.4m
Ep 342000/500000 | Recent Avg: 97.3 | ε: 0.0100
Ep 344000/500000 | Recent Avg: 83.4 | ε: 0.0100
Ep 345000/500000 | Stage 2 | ε: 0.0100 | α: 0.0267 | Eval: -1.4 | Success: 15.0% | Time: 202.6m
Ep 346000/500000 | Recent Avg: 82.6 | ε: 0.0100
Ep 348000/500000 | Recent Avg: 70.8 | ε: 0.0100
Ep 350000/500000 | Stage 2 | ε: 0.0100 | α: 0.0261 | Eval: 24.0 | Success: 0.0% | Time: 205.1m
Ep 352000/500000 | Recent Avg: 68.6 | ε: 0.0100
Ep 354000/500000 | Recent Avg: 67.5 | ε: 0.0100
Ep 355000/500000 | Stage 2 | ε: 0.0100 | α: 0.0254 | Eval: 8.8 | Success: 10.0% | Time: 207.7m
Ep 356000/500000 | Recent Avg: 56.1 | ε: 0.0100
Ep 358000/500000 | Recent Avg: 55.9 | ε: 0.0100
Ep 360000/500000 | Stage 2 | ε: 0.0100 | α: 0.0248 | Eval: -7.9 | Success: 20.0% | Time: 210.3m
Ep 362000/500000 | Recent Avg: 76.5 | ε: 0.0100
Ep 364000/500000 | Recent Avg: 66.0 | ε: 0.0100
Ep 365000/500000 | Stage 2 | ε: 0.0100 | α: 0.0242 | Eval: -11.0 | Success: 0.0% | Time: 212.7m
Ep 366000/500000 | Recent Avg: 34.4 | ε: 0.0100
Ep 368000/500000 | Recent Avg: 53.2 | ε: 0.0100
Ep 370000/500000 | Stage 2 | ε: 0.0100 | α: 0.0236 | Eval: 124.0 | Success: 35.0% | Time: 215.0m
Ep 372000/500000 | Recent Avg: 63.3 | ε: 0.0100
Ep 374000/500000 | Recent Avg: 56.1 | ε: 0.0100
Ep 375000/500000 | Stage 2 | ε: 0.0100 | α: 0.0230 | Eval: -35.5 | Success: 5.0% | Time: 217.5m
Ep 376000/500000 | Recent Avg: 60.5 | ε: 0.0100
Ep 378000/500000 | Recent Avg: 70.5 | ε: 0.0100
Ep 380000/500000 | Stage 2 | ε: 0.0100 | α: 0.0224 | Eval: 37.3 | Success: 25.0% | Time: 220.1m
Ep 382000/500000 | Recent Avg: 76.9 | ε: 0.0100
Ep 384000/500000 | Recent Avg: 44.7 | ε: 0.0100
Ep 385000/500000 | Stage 2 | ε: 0.0100 | α: 0.0219 | Eval: 75.2 | Success: 5.0% | Time: 222.8m
Ep 386000/500000 | Recent Avg: 69.0 | ε: 0.0100
Ep 388000/500000 | Recent Avg: 64.9 | ε: 0.0100
Ep 390000/500000 | Stage 2 | ε: 0.0100 | α: 0.0213 | Eval: 48.6 | Success: 10.0% | Time: 225.4m
Ep 392000/500000 | Recent Avg: 56.1 | ε: 0.0100
Ep 394000/500000 | Recent Avg: 56.6 | ε: 0.0100
Ep 395000/500000 | Stage 2 | ε: 0.0100 | α: 0.0208 | Eval: 71.6 | Success: 15.0% | Time: 228.1m
Ep 396000/500000 | Recent Avg: 56.2 | ε: 0.0100
Ep 398000/500000 | Recent Avg: 58.3 | ε: 0.0100
Ep 400000/500000 | Stage 2 | ε: 0.0100 | α: 0.0203 | Eval: 13.3 | Success: 5.0% | Time: 230.8m
Ep 402000/500000 | Recent Avg: 61.7 | ε: 0.0100
Ep 404000/500000 | Recent Avg: 70.0 | ε: 0.0100
Ep 405000/500000 | Stage 2 | ε: 0.0100 | α: 0.0198 | Eval: 6.7 | Success: 15.0% | Time: 233.4m
Ep 406000/500000 | Recent Avg: 56.9 | ε: 0.0100
Ep 408000/500000 | Recent Avg: 62.0 | ε: 0.0100
Ep 410000/500000 | Stage 2 | ε: 0.0100 | α: 0.0193 | Eval: 19.9 | Success: 10.0% | Time: 236.0m
Ep 412000/500000 | Recent Avg: 55.4 | ε: 0.0100
Ep 414000/500000 | Recent Avg: 40.0 | ε: 0.0100
Ep 415000/500000 | Stage 2 | ε: 0.0100 | α: 0.0188 | Eval: 53.2 | Success: 5.0% | Time: 238.5m
Ep 416000/500000 | Recent Avg: 50.6 | ε: 0.0100
Ep 418000/500000 | Recent Avg: 58.7 | ε: 0.0100
Ep 420000/500000 | Stage 2 | ε: 0.0100 | α: 0.0184 | Eval: 18.4 | Success: 5.0% | Time: 241.2m
Ep 422000/500000 | Recent Avg: 72.4 | ε: 0.0100
Ep 424000/500000 | Recent Avg: 65.6 | ε: 0.0100
Ep 425000/500000 | Stage 2 | ε: 0.0100 | α: 0.0179 | Eval: 41.9 | Success: 20.0% | Time: 243.9m
Ep 426000/500000 | Recent Avg: 78.9 | ε: 0.0100
Ep 428000/500000 | Recent Avg: 68.0 | ε: 0.0100
Ep 430000/500000 | Stage 2 | ε: 0.0100 | α: 0.0175 | Eval: -13.0 | Success: 5.0% | Time: 246.8m
Ep 432000/500000 | Recent Avg: 79.8 | ε: 0.0100
Ep 434000/500000 | Recent Avg: 64.7 | ε: 0.0100
Ep 435000/500000 | Stage 2 | ε: 0.0100 | α: 0.0170 | Eval: 46.3 | Success: 5.0% | Time: 249.5m
Ep 436000/500000 | Recent Avg: 62.4 | ε: 0.0100
Ep 438000/500000 | Recent Avg: 78.0 | ε: 0.0100
Ep 440000/500000 | Stage 2 | ε: 0.0100 | α: 0.0166 | Eval: 60.5 | Success: 5.0% | Time: 252.4m
Ep 442000/500000 | Recent Avg: 66.5 | ε: 0.0100
Ep 444000/500000 | Recent Avg: 74.2 | ε: 0.0100
Ep 445000/500000 | Stage 2 | ε: 0.0100 | α: 0.0162 | Eval: 76.4 | Success: 0.0% | Time: 255.4m
Ep 446000/500000 | Recent Avg: 75.9 | ε: 0.0100
Ep 448000/500000 | Recent Avg: 65.4 | ε: 0.0100
Ep 450000/500000 | Stage 2 | ε: 0.0100 | α: 0.0158 | Eval: 75.8 | Success: 20.0% | Time: 258.3m
Ep 452000/500000 | Recent Avg: 75.1 | ε: 0.0100
Ep 454000/500000 | Recent Avg: 78.6 | ε: 0.0100
Ep 455000/500000 | Stage 2 | ε: 0.0100 | α: 0.0154 | Eval: 82.0 | Success: 10.0% | Time: 261.1m
Ep 456000/500000 | Recent Avg: 73.3 | ε: 0.0100
Ep 458000/500000 | Recent Avg: 64.4 | ε: 0.0100
Ep 460000/500000 | Stage 2 | ε: 0.0100 | α: 0.0150 | Eval: 30.7 | Success: 5.0% | Time: 263.8m
Ep 462000/500000 | Recent Avg: 50.3 | ε: 0.0100
Ep 464000/500000 | Recent Avg: 58.0 | ε: 0.0100
Ep 465000/500000 | Stage 2 | ε: 0.0100 | α: 0.0147 | Eval: 24.3 | Success: 10.0% | Time: 266.6m
Ep 466000/500000 | Recent Avg: 70.1 | ε: 0.0100
Ep 468000/500000 | Recent Avg: 70.5 | ε: 0.0100
Ep 470000/500000 | Stage 2 | ε: 0.0100 | α: 0.0143 | Eval: 13.5 | Success: 15.0% | Time: 269.2m
Ep 472000/500000 | Recent Avg: 72.4 | ε: 0.0100
Ep 474000/500000 | Recent Avg: 83.1 | ε: 0.0100
Ep 475000/500000 | Stage 2 | ε: 0.0100 | α: 0.0140 | Eval: 13.5 | Success: 10.0% | Time: 271.7m
Ep 476000/500000 | Recent Avg: 68.0 | ε: 0.0100
Ep 478000/500000 | Recent Avg: 71.7 | ε: 0.0100
Ep 480000/500000 | Stage 2 | ε: 0.0100 | α: 0.0136 | Eval: 58.7 | Success: 15.0% | Time: 274.6m
Ep 482000/500000 | Recent Avg: 89.1 | ε: 0.0100
Ep 484000/500000 | Recent Avg: 82.4 | ε: 0.0100
Ep 485000/500000 | Stage 2 | ε: 0.0100 | α: 0.0133 | Eval: 15.6 | Success: 5.0% | Time: 277.6m
Ep 486000/500000 | Recent Avg: 64.5 | ε: 0.0100
Ep 488000/500000 | Recent Avg: 76.0 | ε: 0.0100
Ep 490000/500000 | Stage 2 | ε: 0.0100 | α: 0.0129 | Eval: 101.8 | Success: 25.0% | Time: 280.5m
Ep 492000/500000 | Recent Avg: 71.0 | ε: 0.0100
Ep 494000/500000 | Recent Avg: 85.4 | ε: 0.0100
Ep 495000/500000 | Stage 2 | ε: 0.0100 | α: 0.0126 | Eval: 101.0 | Success: 25.0% | Time: 283.5m
Ep 496000/500000 | Recent Avg: 83.9 | ε: 0.0100
Ep 498000/500000 | Recent Avg: 82.1 | ε: 0.0100
Ep 500000/500000 | Stage 2 | ε: 0.0100 | α: 0.0123 | Eval: 120.1 | Success: 25.0% | Time: 286.3m

======================================================================
TRAINING COMPLETE
Time: 286.3 minutes
States: 33429
======================================================================


======================================================================
FINAL EVALUATION (100 episodes)
======================================================================

SARSA Aggressive:
  Mean: 79.33 ± 116.15
  Success Rate: 14.0%
  Best: 270.54

Plot saved: sarsa_aggressive_results.png
PS C:\Users\cmano\Downloads\betterLunarLander> python .\lander_with_improvements.py

======================================================================
LUNAR LANDER - ENHANCED LEARNING (v3)
Comparing: Q-Learning, SARSA, and Monte Carlo
With Reward Shaping, Optimistic Init, and Adaptive LR
======================================================================

[1/3] Training Q-Learning Agent...

======================================================================
TRAINING Q-LEARNING AGENT (ENHANCED)
======================================================================
Episodes: 100000
Learning Rate: 0.1 → 0.01
Discount Factor: 0.99
Epsilon Decay: 0.99992
Reward Shaping: ENABLED
Optimistic Init: ENABLED
======================================================================

C:\Users\cmano\AppData\Roaming\Python\Python311\site-packages\pygame\pkgdata.py:25: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import resource_stream, resource_exists
Episode 1000/100000 | Recent Avg: -168.4 | ε: 0.9231 | α: 0.0951
Episode 2000/100000 | ε: 0.8521 | α: 0.0905 | Eval: -185.5 | Success: 0.0% | Time: 10.5s
Episode 3000/100000 | Recent Avg: -126.4 | ε: 0.7866 | α: 0.0861
Episode 4000/100000 | ε: 0.7261 | α: 0.0819 | Eval: -110.5 | Success: 0.0% | Time: 21.9s
Episode 5000/100000 | Recent Avg: -108.8 | ε: 0.6703 | α: 0.0779
Episode 6000/100000 | ε: 0.6188 | α: 0.0741 | Eval: -229.8 | Success: 0.0% | Time: 35.3s
Episode 7000/100000 | Recent Avg: -89.2 | ε: 0.5712 | α: 0.0705
Episode 8000/100000 | ε: 0.5273 | α: 0.0670 | Eval: -222.0 | Success: 0.0% | Time: 50.4s
Episode 9000/100000 | Recent Avg: -77.6 | ε: 0.4867 | α: 0.0638
Episode 10000/100000 | ε: 0.4493 | α: 0.0607 | Eval: -149.0 | Success: 5.0% | Time: 67.8s
Episode 11000/100000 | Recent Avg: -71.6 | ε: 0.4148 | α: 0.0577
Episode 12000/100000 | ε: 0.3829 | α: 0.0549 | Eval: -143.5 | Success: 0.0% | Time: 88.2s
Episode 13000/100000 | Recent Avg: -69.9 | ε: 0.3534 | α: 0.0522
Episode 14000/100000 | ε: 0.3263 | α: 0.0497 | Eval: -98.4 | Success: 0.0% | Time: 111.9s
Episode 15000/100000 | Recent Avg: -64.9 | ε: 0.3012 | α: 0.0472
Episode 16000/100000 | ε: 0.2780 | α: 0.0449 | Eval: -63.8 | Success: 0.0% | Time: 137.8s
Episode 17000/100000 | Recent Avg: -65.5 | ε: 0.2566 | α: 0.0427
Episode 18000/100000 | ε: 0.2369 | α: 0.0407 | Eval: -50.5 | Success: 5.0% | Time: 167.4s
Episode 19000/100000 | Recent Avg: -48.5 | ε: 0.2187 | α: 0.0387
Episode 20000/100000 | ε: 0.2019 | α: 0.0368 | Eval: -106.3 | Success: 0.0% | Time: 198.4s
Episode 21000/100000 | Recent Avg: -63.7 | ε: 0.1864 | α: 0.0350
Episode 22000/100000 | ε: 0.1720 | α: 0.0333 | Eval: -151.1 | Success: 5.0% | Time: 231.6s
Episode 23000/100000 | Recent Avg: -61.2 | ε: 0.1588 | α: 0.0317
Episode 24000/100000 | ε: 0.1466 | α: 0.0301 | Eval: -91.1 | Success: 0.0% | Time: 267.6s
Episode 25000/100000 | Recent Avg: -45.8 | ε: 0.1353 | α: 0.0286
Episode 26000/100000 | ε: 0.1249 | α: 0.0273 | Eval: -38.0 | Success: 5.0% | Time: 302.6s
Episode 27000/100000 | Recent Avg: -52.0 | ε: 0.1153 | α: 0.0259
Episode 28000/100000 | ε: 0.1064 | α: 0.0247 | Eval: -57.2 | Success: 0.0% | Time: 339.5s
Episode 29000/100000 | Recent Avg: -37.5 | ε: 0.0983 | α: 0.0235
Episode 30000/100000 | ε: 0.0907 | α: 0.0223 | Eval: -64.4 | Success: 5.0% | Time: 377.7s
Episode 31000/100000 | Recent Avg: -36.9 | ε: 0.0837 | α: 0.0212
Episode 32000/100000 | ε: 0.0773 | α: 0.0202 | Eval: -104.2 | Success: 0.0% | Time: 418.0s
Episode 33000/100000 | Recent Avg: -30.0 | ε: 0.0714 | α: 0.0192
Episode 34000/100000 | ε: 0.0659 | α: 0.0183 | Eval: -65.5 | Success: 5.0% | Time: 458.9s
Episode 35000/100000 | Recent Avg: -33.5 | ε: 0.0608 | α: 0.0174
Episode 36000/100000 | ε: 0.0561 | α: 0.0165 | Eval: -164.2 | Success: 0.0% | Time: 500.3s
Episode 37000/100000 | Recent Avg: -29.0 | ε: 0.0518 | α: 0.0157
Episode 38000/100000 | ε: 0.0478 | α: 0.0150 | Eval: -44.5 | Success: 0.0% | Time: 542.0s
Episode 39000/100000 | Recent Avg: -28.5 | ε: 0.0442 | α: 0.0142
Episode 40000/100000 | ε: 0.0408 | α: 0.0135 | Eval: -78.4 | Success: 5.0% | Time: 582.1s
Episode 41000/100000 | Recent Avg: -50.3 | ε: 0.0376 | α: 0.0129
Episode 42000/100000 | ε: 0.0347 | α: 0.0122 | Eval: -146.8 | Success: 0.0% | Time: 624.6s
Episode 43000/100000 | Recent Avg: -40.2 | ε: 0.0321 | α: 0.0116
Episode 44000/100000 | ε: 0.0296 | α: 0.0111 | Eval: -101.3 | Success: 0.0% | Time: 670.9s
Episode 45000/100000 | Recent Avg: -35.5 | ε: 0.0273 | α: 0.0105
Episode 46000/100000 | ε: 0.0252 | α: 0.0100 | Eval: -99.3 | Success: 0.0% | Time: 713.4s
Episode 47000/100000 | Recent Avg: -45.3 | ε: 0.0233 | α: 0.0100
Episode 48000/100000 | ε: 0.0215 | α: 0.0100 | Eval: 37.5 | Success: 25.0% | Time: 756.7s
Episode 49000/100000 | Recent Avg: -33.8 | ε: 0.0198 | α: 0.0100
Episode 50000/100000 | ε: 0.0183 | α: 0.0100 | Eval: -190.9 | Success: 0.0% | Time: 801.4s
Episode 51000/100000 | Recent Avg: -29.4 | ε: 0.0169 | α: 0.0100
Episode 52000/100000 | ε: 0.0156 | α: 0.0100 | Eval: -44.6 | Success: 5.0% | Time: 838.7s
Episode 53000/100000 | Recent Avg: -9.5 | ε: 0.0144 | α: 0.0100
Episode 54000/100000 | ε: 0.0133 | α: 0.0100 | Eval: 13.3 | Success: 25.0% | Time: 880.6s
Episode 55000/100000 | Recent Avg: 16.3 | ε: 0.0123 | α: 0.0100
Episode 56000/100000 | ε: 0.0113 | α: 0.0100 | Eval: -48.4 | Success: 10.0% | Time: 925.8s
Episode 57000/100000 | Recent Avg: -8.7 | ε: 0.0105 | α: 0.0100
Episode 58000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -36.8 | Success: 15.0% | Time: 971.9s
Episode 59000/100000 | Recent Avg: -9.6 | ε: 0.0100 | α: 0.0100
Episode 60000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -58.4 | Success: 10.0% | Time: 1016.7s
Episode 61000/100000 | Recent Avg: -7.8 | ε: 0.0100 | α: 0.0100
Episode 62000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -94.4 | Success: 15.0% | Time: 1061.5s
Episode 63000/100000 | Recent Avg: -36.2 | ε: 0.0100 | α: 0.0100
Episode 64000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -156.8 | Success: 5.0% | Time: 1106.9s
Episode 65000/100000 | Recent Avg: -48.6 | ε: 0.0100 | α: 0.0100
Episode 66000/100000 | ε: 0.0100 | α: 0.0100 | Eval: 0.5 | Success: 25.0% | Time: 1145.3s
Episode 67000/100000 | Recent Avg: -27.6 | ε: 0.0100 | α: 0.0100
Episode 68000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -93.8 | Success: 5.0% | Time: 1190.8s
Episode 69000/100000 | Recent Avg: -11.3 | ε: 0.0100 | α: 0.0100
Episode 70000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -21.0 | Success: 20.0% | Time: 1232.8s
Episode 71000/100000 | Recent Avg: -12.4 | ε: 0.0100 | α: 0.0100
Episode 72000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -73.7 | Success: 15.0% | Time: 1270.6s
Episode 73000/100000 | Recent Avg: -35.4 | ε: 0.0100 | α: 0.0100
Episode 74000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -66.2 | Success: 0.0% | Time: 1315.3s
Episode 75000/100000 | Recent Avg: -42.8 | ε: 0.0100 | α: 0.0100
Episode 76000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -115.8 | Success: 5.0% | Time: 1356.6s
Episode 77000/100000 | Recent Avg: -33.7 | ε: 0.0100 | α: 0.0100
Episode 78000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -48.4 | Success: 15.0% | Time: 1394.8s
Episode 79000/100000 | Recent Avg: -42.3 | ε: 0.0100 | α: 0.0100
Episode 80000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -28.7 | Success: 10.0% | Time: 1439.4s
Episode 81000/100000 | Recent Avg: -50.8 | ε: 0.0100 | α: 0.0100
Episode 82000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -73.9 | Success: 5.0% | Time: 1479.4s
Episode 83000/100000 | Recent Avg: -29.2 | ε: 0.0100 | α: 0.0100
Episode 84000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -36.4 | Success: 20.0% | Time: 1517.7s
Episode 85000/100000 | Recent Avg: -25.9 | ε: 0.0100 | α: 0.0100
Episode 86000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -105.9 | Success: 0.0% | Time: 1554.5s
Episode 87000/100000 | Recent Avg: -40.5 | ε: 0.0100 | α: 0.0100
Episode 88000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -170.4 | Success: 0.0% | Time: 1592.3s
Episode 89000/100000 | Recent Avg: -44.1 | ε: 0.0100 | α: 0.0100
Episode 90000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -160.9 | Success: 0.0% | Time: 1636.9s
Episode 91000/100000 | Recent Avg: -31.9 | ε: 0.0100 | α: 0.0100
Episode 92000/100000 | ε: 0.0100 | α: 0.0100 | Eval: 6.2 | Success: 30.0% | Time: 1680.1s
Episode 93000/100000 | Recent Avg: -5.1 | ε: 0.0100 | α: 0.0100
Episode 94000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -113.8 | Success: 15.0% | Time: 1717.7s
Episode 95000/100000 | Recent Avg: -15.9 | ε: 0.0100 | α: 0.0100
Episode 96000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -79.2 | Success: 5.0% | Time: 1754.3s
Episode 97000/100000 | Recent Avg: -17.0 | ε: 0.0100 | α: 0.0100
Episode 98000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -85.3 | Success: 10.0% | Time: 1797.6s
Episode 99000/100000 | Recent Avg: -51.3 | ε: 0.0100 | α: 0.0100
Episode 100000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -39.4 | Success: 15.0% | Time: 1851.8s

======================================================================
TRAINING COMPLETE
Total Time: 30.9 minutes
States Visited: 7462
Total Updates: 33301272
Final ε: 0.0100
Final α: 0.0100
======================================================================

Q-Learning model saved to: outputs/q_learning_enhanced.pkl

[2/3] Training SARSA Agent...

======================================================================
TRAINING SARSA AGENT (ENHANCED)
======================================================================
Episodes: 100000
Learning Rate: 0.1 → 0.01
Discount Factor: 0.99
Epsilon Decay: 0.99992
Reward Shaping: ENABLED
Optimistic Init: ENABLED
======================================================================

Episode 1000/100000 | Recent Avg: -168.7 | ε: 0.9231 | α: 0.0951
Episode 2000/100000 | ε: 0.8521 | α: 0.0905 | Eval: -179.6 | Success: 0.0% | Time: 10.5s
Episode 3000/100000 | Recent Avg: -134.3 | ε: 0.7866 | α: 0.0861
Episode 4000/100000 | ε: 0.7261 | α: 0.0819 | Eval: -218.1 | Success: 0.0% | Time: 22.3s
Episode 5000/100000 | Recent Avg: -110.5 | ε: 0.6703 | α: 0.0779
Episode 6000/100000 | ε: 0.6188 | α: 0.0741 | Eval: -159.4 | Success: 0.0% | Time: 35.7s
Episode 7000/100000 | Recent Avg: -94.8 | ε: 0.5712 | α: 0.0705
Episode 8000/100000 | ε: 0.5273 | α: 0.0670 | Eval: -264.5 | Success: 0.0% | Time: 52.2s
Episode 9000/100000 | Recent Avg: -83.1 | ε: 0.4867 | α: 0.0638
Episode 10000/100000 | ε: 0.4493 | α: 0.0607 | Eval: -221.6 | Success: 0.0% | Time: 73.7s
Episode 11000/100000 | Recent Avg: -88.5 | ε: 0.4148 | α: 0.0577
Episode 12000/100000 | ε: 0.3829 | α: 0.0549 | Eval: -213.1 | Success: 0.0% | Time: 98.9s
Episode 13000/100000 | Recent Avg: -79.9 | ε: 0.3534 | α: 0.0522
Episode 14000/100000 | ε: 0.3263 | α: 0.0497 | Eval: -242.6 | Success: 0.0% | Time: 126.2s
Episode 15000/100000 | Recent Avg: -78.2 | ε: 0.3012 | α: 0.0472
Episode 16000/100000 | ε: 0.2780 | α: 0.0449 | Eval: -104.5 | Success: 0.0% | Time: 156.9s
Episode 17000/100000 | Recent Avg: -86.4 | ε: 0.2566 | α: 0.0427
Episode 18000/100000 | ε: 0.2369 | α: 0.0407 | Eval: -170.2 | Success: 5.0% | Time: 190.2s
Episode 19000/100000 | Recent Avg: -95.6 | ε: 0.2187 | α: 0.0387
Episode 20000/100000 | ε: 0.2019 | α: 0.0368 | Eval: -154.6 | Success: 0.0% | Time: 226.1s
Episode 21000/100000 | Recent Avg: -88.5 | ε: 0.1864 | α: 0.0350
Episode 22000/100000 | ε: 0.1720 | α: 0.0333 | Eval: -142.1 | Success: 0.0% | Time: 262.1s
Episode 23000/100000 | Recent Avg: -86.1 | ε: 0.1588 | α: 0.0317
Episode 24000/100000 | ε: 0.1466 | α: 0.0301 | Eval: -131.0 | Success: 10.0% | Time: 300.0s
Episode 25000/100000 | Recent Avg: -103.6 | ε: 0.1353 | α: 0.0286
Episode 26000/100000 | ε: 0.1249 | α: 0.0273 | Eval: -161.2 | Success: 0.0% | Time: 338.9s
Episode 27000/100000 | Recent Avg: -89.1 | ε: 0.1153 | α: 0.0259
Episode 28000/100000 | ε: 0.1064 | α: 0.0247 | Eval: -99.5 | Success: 0.0% | Time: 379.0s
Episode 29000/100000 | Recent Avg: -88.4 | ε: 0.0983 | α: 0.0235
Episode 30000/100000 | ε: 0.0907 | α: 0.0223 | Eval: -221.9 | Success: 0.0% | Time: 420.6s
Episode 31000/100000 | Recent Avg: -98.5 | ε: 0.0837 | α: 0.0212
Episode 32000/100000 | ε: 0.0773 | α: 0.0202 | Eval: -87.7 | Success: 10.0% | Time: 462.8s
Episode 33000/100000 | Recent Avg: -102.0 | ε: 0.0714 | α: 0.0192
Episode 34000/100000 | ε: 0.0659 | α: 0.0183 | Eval: -109.5 | Success: 5.0% | Time: 510.8s
Episode 35000/100000 | Recent Avg: -100.3 | ε: 0.0608 | α: 0.0174
Episode 36000/100000 | ε: 0.0561 | α: 0.0165 | Eval: -100.3 | Success: 0.0% | Time: 558.8s
Episode 37000/100000 | Recent Avg: -79.4 | ε: 0.0518 | α: 0.0157
Episode 38000/100000 | ε: 0.0478 | α: 0.0150 | Eval: -156.7 | Success: 0.0% | Time: 602.6s
Episode 39000/100000 | Recent Avg: -94.8 | ε: 0.0442 | α: 0.0142
Episode 40000/100000 | ε: 0.0408 | α: 0.0135 | Eval: -37.4 | Success: 15.0% | Time: 644.3s
Episode 41000/100000 | Recent Avg: -113.8 | ε: 0.0376 | α: 0.0129
Episode 42000/100000 | ε: 0.0347 | α: 0.0122 | Eval: -53.4 | Success: 10.0% | Time: 689.7s
Episode 43000/100000 | Recent Avg: -52.2 | ε: 0.0321 | α: 0.0116
Episode 44000/100000 | ε: 0.0296 | α: 0.0111 | Eval: 23.2 | Success: 20.0% | Time: 729.4s
Episode 45000/100000 | Recent Avg: -20.0 | ε: 0.0273 | α: 0.0105
Episode 46000/100000 | ε: 0.0252 | α: 0.0100 | Eval: -79.8 | Success: 5.0% | Time: 772.2s
Episode 47000/100000 | Recent Avg: -57.8 | ε: 0.0233 | α: 0.0100
Episode 48000/100000 | ε: 0.0215 | α: 0.0100 | Eval: -20.4 | Success: 5.0% | Time: 814.7s
Episode 49000/100000 | Recent Avg: -52.5 | ε: 0.0198 | α: 0.0100
Episode 50000/100000 | ε: 0.0183 | α: 0.0100 | Eval: -127.1 | Success: 0.0% | Time: 863.6s
Episode 51000/100000 | Recent Avg: -57.7 | ε: 0.0169 | α: 0.0100
Episode 52000/100000 | ε: 0.0156 | α: 0.0100 | Eval: -35.3 | Success: 15.0% | Time: 906.9s
Episode 53000/100000 | Recent Avg: -65.1 | ε: 0.0144 | α: 0.0100
Episode 54000/100000 | ε: 0.0133 | α: 0.0100 | Eval: -40.8 | Success: 10.0% | Time: 953.8s
Episode 55000/100000 | Recent Avg: -49.8 | ε: 0.0123 | α: 0.0100
Episode 56000/100000 | ε: 0.0113 | α: 0.0100 | Eval: -46.1 | Success: 10.0% | Time: 1002.0s
Episode 57000/100000 | Recent Avg: -70.3 | ε: 0.0105 | α: 0.0100
Episode 58000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -85.9 | Success: 5.0% | Time: 1049.4s
Episode 59000/100000 | Recent Avg: -52.2 | ε: 0.0100 | α: 0.0100
Episode 60000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -110.2 | Success: 5.0% | Time: 1098.0s
Episode 61000/100000 | Recent Avg: -74.8 | ε: 0.0100 | α: 0.0100
Episode 62000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -91.0 | Success: 0.0% | Time: 1145.9s
Episode 63000/100000 | Recent Avg: -71.3 | ε: 0.0100 | α: 0.0100
Episode 64000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -74.7 | Success: 0.0% | Time: 1190.7s
Episode 65000/100000 | Recent Avg: -50.6 | ε: 0.0100 | α: 0.0100
Episode 66000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -47.8 | Success: 5.0% | Time: 1233.4s
Episode 67000/100000 | Recent Avg: -61.2 | ε: 0.0100 | α: 0.0100
Episode 68000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -83.7 | Success: 0.0% | Time: 1281.0s
Episode 69000/100000 | Recent Avg: -45.7 | ε: 0.0100 | α: 0.0100
Episode 70000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -72.6 | Success: 10.0% | Time: 1325.1s
Episode 71000/100000 | Recent Avg: -45.7 | ε: 0.0100 | α: 0.0100
Episode 72000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -59.6 | Success: 0.0% | Time: 1373.0s
Episode 73000/100000 | Recent Avg: -80.1 | ε: 0.0100 | α: 0.0100
Episode 74000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -94.3 | Success: 0.0% | Time: 1420.9s
Episode 75000/100000 | Recent Avg: -51.2 | ε: 0.0100 | α: 0.0100
Episode 76000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -63.7 | Success: 0.0% | Time: 1467.6s
Episode 77000/100000 | Recent Avg: -30.7 | ε: 0.0100 | α: 0.0100
Episode 78000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -44.3 | Success: 0.0% | Time: 1509.9s
Episode 79000/100000 | Recent Avg: -4.1 | ε: 0.0100 | α: 0.0100
Episode 80000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -49.8 | Success: 0.0% | Time: 1550.5s
Episode 81000/100000 | Recent Avg: -48.5 | ε: 0.0100 | α: 0.0100
Episode 82000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -2.2 | Success: 10.0% | Time: 1602.9s
Episode 83000/100000 | Recent Avg: -3.7 | ε: 0.0100 | α: 0.0100
Episode 84000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -32.3 | Success: 5.0% | Time: 1652.6s
Episode 85000/100000 | Recent Avg: -20.2 | ε: 0.0100 | α: 0.0100
Episode 86000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -51.8 | Success: 5.0% | Time: 1709.4s
Episode 87000/100000 | Recent Avg: -27.0 | ε: 0.0100 | α: 0.0100
Episode 88000/100000 | ε: 0.0100 | α: 0.0100 | Eval: 5.6 | Success: 5.0% | Time: 1767.8s
Episode 89000/100000 | Recent Avg: -9.2 | ε: 0.0100 | α: 0.0100
Episode 90000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -107.9 | Success: 0.0% | Time: 1822.6s
Episode 91000/100000 | Recent Avg: -39.9 | ε: 0.0100 | α: 0.0100
Episode 92000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -28.7 | Success: 0.0% | Time: 1880.4s
Episode 93000/100000 | Recent Avg: -27.2 | ε: 0.0100 | α: 0.0100
Episode 94000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -25.7 | Success: 0.0% | Time: 1937.4s
Episode 95000/100000 | Recent Avg: -26.0 | ε: 0.0100 | α: 0.0100
Episode 96000/100000 | ε: 0.0100 | α: 0.0100 | Eval: 24.3 | Success: 15.0% | Time: 1993.6s
Episode 97000/100000 | Recent Avg: -12.8 | ε: 0.0100 | α: 0.0100
Episode 98000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -47.0 | Success: 5.0% | Time: 2053.3s
Episode 99000/100000 | Recent Avg: -26.4 | ε: 0.0100 | α: 0.0100
Episode 100000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -17.6 | Success: 0.0% | Time: 2111.6s

======================================================================
TRAINING COMPLETE
Total Time: 35.2 minutes
States Visited: 7912
Total Updates: 40502234
Final ε: 0.0100
Final α: 0.0100
======================================================================

SARSA model saved to: outputs/sarsa_enhanced.pkl

[3/3] Training Monte Carlo Agent...

======================================================================
TRAINING MONTE CARLO AGENT (ENHANCED)
======================================================================
Episodes: 100000
Learning Rate: 0.1 → 0.01
Reward Shaping: ENABLED
Optimistic Init: ENABLED
======================================================================

Episode 1000/100000 | Recent Avg: -166.5 | ε: 0.9231 | α: 0.0951
Episode 2000/100000 | ε: 0.8521 | α: 0.0905 | Eval: -192.6 | Success: 0.0% | Time: 9.8s
Episode 3000/100000 | Recent Avg: -132.1 | ε: 0.7866 | α: 0.0861
Episode 4000/100000 | ε: 0.7261 | α: 0.0819 | Eval: -172.8 | Success: 0.0% | Time: 19.4s
Episode 5000/100000 | Recent Avg: -117.2 | ε: 0.6703 | α: 0.0779
Episode 6000/100000 | ε: 0.6188 | α: 0.0741 | Eval: -157.1 | Success: 0.0% | Time: 29.1s
Episode 7000/100000 | Recent Avg: -116.2 | ε: 0.5712 | α: 0.0705
Episode 8000/100000 | ε: 0.5273 | α: 0.0670 | Eval: -124.7 | Success: 0.0% | Time: 38.9s
Episode 9000/100000 | Recent Avg: -116.2 | ε: 0.4867 | α: 0.0638
Episode 10000/100000 | ε: 0.4493 | α: 0.0607 | Eval: -117.8 | Success: 0.0% | Time: 48.7s
Episode 11000/100000 | Recent Avg: -119.0 | ε: 0.4148 | α: 0.0577
Episode 12000/100000 | ε: 0.3829 | α: 0.0549 | Eval: -86.8 | Success: 0.0% | Time: 58.5s
Episode 13000/100000 | Recent Avg: -98.6 | ε: 0.3534 | α: 0.0522
Episode 14000/100000 | ε: 0.3263 | α: 0.0497 | Eval: -199.6 | Success: 0.0% | Time: 67.8s
Episode 15000/100000 | Recent Avg: -109.9 | ε: 0.3012 | α: 0.0472
Episode 16000/100000 | ε: 0.2780 | α: 0.0449 | Eval: -81.4 | Success: 0.0% | Time: 77.6s
Episode 17000/100000 | Recent Avg: -104.6 | ε: 0.2566 | α: 0.0427
Episode 18000/100000 | ε: 0.2369 | α: 0.0407 | Eval: -108.5 | Success: 0.0% | Time: 87.1s
Episode 19000/100000 | Recent Avg: -106.5 | ε: 0.2187 | α: 0.0387
Episode 20000/100000 | ε: 0.2019 | α: 0.0368 | Eval: -77.0 | Success: 0.0% | Time: 96.4s
Episode 21000/100000 | Recent Avg: -111.8 | ε: 0.1864 | α: 0.0350
Episode 22000/100000 | ε: 0.1720 | α: 0.0333 | Eval: -90.9 | Success: 0.0% | Time: 106.0s
Episode 23000/100000 | Recent Avg: -99.2 | ε: 0.1588 | α: 0.0317
Episode 24000/100000 | ε: 0.1466 | α: 0.0301 | Eval: -97.1 | Success: 0.0% | Time: 115.4s
Episode 25000/100000 | Recent Avg: -88.2 | ε: 0.1353 | α: 0.0286
Episode 26000/100000 | ε: 0.1249 | α: 0.0273 | Eval: -80.8 | Success: 0.0% | Time: 124.6s
Episode 27000/100000 | Recent Avg: -102.4 | ε: 0.1153 | α: 0.0259
Episode 28000/100000 | ε: 0.1064 | α: 0.0247 | Eval: -79.8 | Success: 0.0% | Time: 133.7s
Episode 29000/100000 | Recent Avg: -89.7 | ε: 0.0983 | α: 0.0235
Episode 30000/100000 | ε: 0.0907 | α: 0.0223 | Eval: -94.7 | Success: 0.0% | Time: 143.0s
Episode 31000/100000 | Recent Avg: -103.3 | ε: 0.0837 | α: 0.0212
Episode 32000/100000 | ε: 0.0773 | α: 0.0202 | Eval: -80.5 | Success: 0.0% | Time: 153.1s
Episode 33000/100000 | Recent Avg: -102.0 | ε: 0.0714 | α: 0.0192
Episode 34000/100000 | ε: 0.0659 | α: 0.0183 | Eval: -94.9 | Success: 0.0% | Time: 162.6s
Episode 35000/100000 | Recent Avg: -93.0 | ε: 0.0608 | α: 0.0174
Episode 36000/100000 | ε: 0.0561 | α: 0.0165 | Eval: -97.7 | Success: 0.0% | Time: 171.9s
Episode 37000/100000 | Recent Avg: -103.6 | ε: 0.0518 | α: 0.0157
Episode 38000/100000 | ε: 0.0478 | α: 0.0150 | Eval: -97.1 | Success: 0.0% | Time: 181.9s
Episode 39000/100000 | Recent Avg: -104.2 | ε: 0.0442 | α: 0.0142
Episode 40000/100000 | ε: 0.0408 | α: 0.0135 | Eval: -88.8 | Success: 0.0% | Time: 191.1s
Episode 41000/100000 | Recent Avg: -86.4 | ε: 0.0376 | α: 0.0129
Episode 42000/100000 | ε: 0.0347 | α: 0.0122 | Eval: -77.1 | Success: 0.0% | Time: 200.1s
Episode 43000/100000 | Recent Avg: -77.0 | ε: 0.0321 | α: 0.0116
Episode 44000/100000 | ε: 0.0296 | α: 0.0111 | Eval: -69.7 | Success: 0.0% | Time: 209.1s
Episode 45000/100000 | Recent Avg: -77.9 | ε: 0.0273 | α: 0.0105
Episode 46000/100000 | ε: 0.0252 | α: 0.0100 | Eval: -75.5 | Success: 0.0% | Time: 218.1s
Episode 47000/100000 | Recent Avg: -82.2 | ε: 0.0233 | α: 0.0100
Episode 48000/100000 | ε: 0.0215 | α: 0.0100 | Eval: -89.2 | Success: 0.0% | Time: 227.1s
Episode 49000/100000 | Recent Avg: -77.8 | ε: 0.0198 | α: 0.0100
Episode 50000/100000 | ε: 0.0183 | α: 0.0100 | Eval: -88.5 | Success: 0.0% | Time: 236.1s
Episode 51000/100000 | Recent Avg: -79.5 | ε: 0.0169 | α: 0.0100
Episode 52000/100000 | ε: 0.0156 | α: 0.0100 | Eval: -55.5 | Success: 0.0% | Time: 245.2s
Episode 53000/100000 | Recent Avg: -78.5 | ε: 0.0144 | α: 0.0100
Episode 54000/100000 | ε: 0.0133 | α: 0.0100 | Eval: -86.8 | Success: 0.0% | Time: 254.2s
Episode 55000/100000 | Recent Avg: -77.7 | ε: 0.0123 | α: 0.0100
Episode 56000/100000 | ε: 0.0113 | α: 0.0100 | Eval: -70.9 | Success: 0.0% | Time: 263.1s
Episode 57000/100000 | Recent Avg: -73.6 | ε: 0.0105 | α: 0.0100
Episode 58000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -64.6 | Success: 0.0% | Time: 272.2s
Episode 59000/100000 | Recent Avg: -76.7 | ε: 0.0100 | α: 0.0100
Episode 60000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -73.8 | Success: 0.0% | Time: 281.0s
Episode 61000/100000 | Recent Avg: -85.3 | ε: 0.0100 | α: 0.0100
Episode 62000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -62.5 | Success: 0.0% | Time: 290.1s
Episode 63000/100000 | Recent Avg: -74.2 | ε: 0.0100 | α: 0.0100
Episode 64000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -78.6 | Success: 0.0% | Time: 299.1s
Episode 65000/100000 | Recent Avg: -71.4 | ε: 0.0100 | α: 0.0100
Episode 66000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -68.4 | Success: 0.0% | Time: 308.1s
Episode 67000/100000 | Recent Avg: -70.8 | ε: 0.0100 | α: 0.0100
Episode 68000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -56.4 | Success: 0.0% | Time: 317.0s
Episode 69000/100000 | Recent Avg: -61.7 | ε: 0.0100 | α: 0.0100
Episode 70000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -69.2 | Success: 0.0% | Time: 325.7s
Episode 71000/100000 | Recent Avg: -61.1 | ε: 0.0100 | α: 0.0100
Episode 72000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -48.9 | Success: 0.0% | Time: 334.3s
Episode 73000/100000 | Recent Avg: -70.5 | ε: 0.0100 | α: 0.0100
Episode 74000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -76.2 | Success: 0.0% | Time: 343.3s
Episode 75000/100000 | Recent Avg: -82.4 | ε: 0.0100 | α: 0.0100
Episode 76000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -79.4 | Success: 0.0% | Time: 352.2s
Episode 77000/100000 | Recent Avg: -76.7 | ε: 0.0100 | α: 0.0100
Episode 78000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -80.9 | Success: 0.0% | Time: 361.7s
Episode 79000/100000 | Recent Avg: -75.3 | ε: 0.0100 | α: 0.0100
Episode 80000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -71.4 | Success: 0.0% | Time: 371.0s
Episode 81000/100000 | Recent Avg: -78.1 | ε: 0.0100 | α: 0.0100
Episode 82000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -60.2 | Success: 0.0% | Time: 380.1s
Episode 83000/100000 | Recent Avg: -75.3 | ε: 0.0100 | α: 0.0100
Episode 84000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -46.5 | Success: 0.0% | Time: 390.0s
Episode 85000/100000 | Recent Avg: -54.6 | ε: 0.0100 | α: 0.0100
Episode 86000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -25.8 | Success: 10.0% | Time: 401.6s
Episode 87000/100000 | Recent Avg: -45.9 | ε: 0.0100 | α: 0.0100
Episode 88000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -49.3 | Success: 0.0% | Time: 413.9s
Episode 89000/100000 | Recent Avg: -44.7 | ε: 0.0100 | α: 0.0100
Episode 90000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -41.6 | Success: 5.0% | Time: 427.8s
Episode 91000/100000 | Recent Avg: -43.7 | ε: 0.0100 | α: 0.0100
Episode 92000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -59.2 | Success: 0.0% | Time: 441.8s
Episode 93000/100000 | Recent Avg: -49.3 | ε: 0.0100 | α: 0.0100
Episode 94000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -41.8 | Success: 0.0% | Time: 453.6s
Episode 95000/100000 | Recent Avg: -53.4 | ε: 0.0100 | α: 0.0100
Episode 96000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -61.7 | Success: 0.0% | Time: 464.1s
Episode 97000/100000 | Recent Avg: -53.2 | ε: 0.0100 | α: 0.0100
Episode 98000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -56.9 | Success: 0.0% | Time: 473.9s
Episode 99000/100000 | Recent Avg: -61.1 | ε: 0.0100 | α: 0.0100
Episode 100000/100000 | ε: 0.0100 | α: 0.0100 | Eval: -88.9 | Success: 0.0% | Time: 483.4s

======================================================================
TRAINING COMPLETE
Total Time: 8.1 minutes
States Visited: 7454
======================================================================

Monte Carlo model saved to: outputs/monte_carlo_enhanced.pkl

======================================================================
FINAL EVALUATION (100 episodes each)
======================================================================

Q-Learning Enhanced:
  Mean Reward: -17.93 ± 158.47
  Success Rate: 18.0%
  Best Episode: 267.02

SARSA Enhanced:
  Mean Reward: -2.72 ± 112.04
  Success Rate: 4.0%
  Best Episode: 231.45

Monte Carlo Enhanced:
  Mean Reward: -89.08 ± 46.54
  Success Rate: 0.0%
  Best Episode: -13.94

======================================================================
PERFORMANCE RANKING:
======================================================================
  🥇 #1: SARSA
      Mean Reward: -2.72 | Success Rate: 4.0%
  🥈 #2: Q-Learning
      Mean Reward: -17.93 | Success Rate: 18.0%
  🥉 #3: Monte Carlo
      Mean Reward: -89.08 | Success Rate: 0.0%

======================================================================
Generating comparison plots...
Plot saved to: outputs/training_enhanced.png

======================================================================
Would you like to watch the best trained agent? (y/n): n

======================================================================
TRAINING COMPLETE!
======================================================================
Enhanced models saved:
  • q_learning_enhanced.pkl
  • sarsa_enhanced.pkl
  • monte_carlo_enhanced.pkl

Plot saved:
  • training_enhanced.png

Use demo_trained_agents.py to watch them interactively!
PS C:\Users\cmano\Downloads\betterLunarLander> python .\lander_with_improvements.py

======================================================================
LUNAR LANDER - ULTRA-STABLE VERSION (v3)
Maximum Stability with Aggressive Reward Shaping
======================================================================

KEY FEATURES:
  • Reward Shaping Weight: 0.3 (3x stronger!)
  • Curriculum Learning: 3 phases
  • Reward Clipping: ±2.0
  • Epsilon: 1.0 → 0.05 (more exploration)
  • Episodes: 150000 (50% more training)
  • Optimistic Init: 10.0

[1/3] Training Q-Learning Agent...

======================================================================
TRAINING Q-LEARNING AGENT (ULTRA-STABLE)
======================================================================
Episodes: 150000
Learning Rate: 0.05 → 0.005
Epsilon: 1.0 → 0.05
Reward Shaping Weight: 0.3
Curriculum Learning: ENABLED
Reward Clipping: ENABLED
======================================================================

C:\Users\cmano\AppData\Roaming\Python\Python311\site-packages\pygame\pkgdata.py:25: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import resource_stream, resource_exists
Episode 3000/150000 | Phase 1 (Upright) | ε: 0.9003 | α: 0.04709 | Eval: -331.1 | Success: 0.0% | Time: 0.3min
Episode 5000/150000 | Recent Avg: -142.6 | ε: 0.8395
Episode 6000/150000 | Phase 1 (Upright) | ε: 0.8106 | α: 0.04435 | Eval: -300.0 | Success: 0.0% | Time: 1.0min
Episode 9000/150000 | Phase 1 (Upright) | ε: 0.7298 | α: 0.04176 | Eval: -318.3 | Success: 0.0% | Time: 1.7min
Episode 10000/150000 | Recent Avg: -123.1 | ε: 0.7047
Episode 12000/150000 | Phase 1 (Upright) | ε: 0.6570 | α: 0.03933 | Eval: -197.7 | Success: 0.0% | Time: 2.5min
Episode 15000/150000 | Phase 1 (Upright) | ε: 0.5915 | α: 0.03704 | Eval: -252.9 | Success: 0.0% | Time: 3.4min
Episode 18000/150000 | Phase 1 (Upright) | ε: 0.5326 | α: 0.03488 | Eval: -241.1 | Success: 0.0% | Time: 4.4min
Episode 20000/150000 | Recent Avg: -78.9 | ε: 0.4966
Episode 21000/150000 | Phase 1 (Upright) | ε: 0.4795 | α: 0.03285 | Eval: -191.2 | Success: 0.0% | Time: 5.5min
Episode 24000/150000 | Phase 1 (Upright) | ε: 0.4317 | α: 0.03094 | Eval: -377.6 | Success: 0.0% | Time: 6.1min
Episode 25000/150000 | Recent Avg: -86.8 | ε: 0.4169
Episode 27000/150000 | Phase 1 (Upright) | ε: 0.3887 | α: 0.02914 | Eval: -264.7 | Success: 0.0% | Time: 6.8min
Episode 30000/150000 | Phase 1 (Upright) | ε: 0.3499 | α: 0.02744 | Eval: -222.7 | Success: 0.0% | Time: 7.6min
Episode 33000/150000 | Phase 2 (Descent) | ε: 0.3151 | α: 0.02584 | Eval: -314.6 | Success: 5.0% | Time: 8.4min
Episode 35000/150000 | Recent Avg: -122.6 | ε: 0.2938
Episode 36000/150000 | Phase 2 (Descent) | ε: 0.2836 | α: 0.02434 | Eval: -334.5 | Success: 0.0% | Time: 9.3min
Episode 39000/150000 | Phase 2 (Descent) | ε: 0.2554 | α: 0.02292 | Eval: -211.2 | Success: 0.0% | Time: 10.1min
Episode 40000/150000 | Recent Avg: -120.2 | ε: 0.2466
Episode 42000/150000 | Phase 2 (Descent) | ε: 0.2299 | α: 0.02159 | Eval: -245.3 | Success: 0.0% | Time: 11.0min
Episode 45000/150000 | Phase 2 (Descent) | ε: 0.2070 | α: 0.02033 | Eval: -251.9 | Success: 0.0% | Time: 11.9min
Episode 48000/150000 | Phase 2 (Descent) | ε: 0.1864 | α: 0.01914 | Eval: -323.7 | Success: 0.0% | Time: 12.8min
Episode 50000/150000 | Recent Avg: -132.3 | ε: 0.1738
Episode 51000/150000 | Phase 2 (Descent) | ε: 0.1678 | α: 0.01803 | Eval: -257.3 | Success: 0.0% | Time: 13.8min
Episode 54000/150000 | Phase 2 (Descent) | ε: 0.1511 | α: 0.01698 | Eval: -277.0 | Success: 5.0% | Time: 14.7min
Episode 55000/150000 | Recent Avg: -144.8 | ε: 0.1459
Episode 57000/150000 | Phase 2 (Descent) | ε: 0.1360 | α: 0.01599 | Eval: -236.6 | Success: 0.0% | Time: 15.7min
Episode 60000/150000 | Phase 2 (Descent) | ε: 0.1225 | α: 0.01506 | Eval: -266.8 | Success: 0.0% | Time: 16.6min
Episode 63000/150000 | Phase 2 (Descent) | ε: 0.1102 | α: 0.01418 | Eval: -202.6 | Success: 0.0% | Time: 17.6min
Episode 65000/150000 | Recent Avg: -166.2 | ε: 0.1028
Episode 66000/150000 | Phase 2 (Descent) | ε: 0.0993 | α: 0.01336 | Eval: -184.4 | Success: 0.0% | Time: 19.4min
Episode 69000/150000 | Phase 2 (Descent) | ε: 0.0894 | α: 0.01258 | Eval: -186.7 | Success: 0.0% | Time: 21.8min
Episode 70000/150000 | Recent Avg: -139.1 | ε: 0.0863
Episode 72000/150000 | Phase 3 (Full) | ε: 0.0805 | α: 0.01185 | Eval: -229.7 | Success: 0.0% | Time: 23.8min
Episode 75000/150000 | Phase 3 (Full) | ε: 0.0724 | α: 0.01116 | Eval: -235.3 | Success: 0.0% | Time: 25.8min
Episode 78000/150000 | Phase 3 (Full) | ε: 0.0652 | α: 0.01051 | Eval: -184.4 | Success: 0.0% | Time: 28.0min
Episode 80000/150000 | Recent Avg: -145.7 | ε: 0.0608
Episode 81000/150000 | Phase 3 (Full) | ε: 0.0587 | α: 0.00989 | Eval: -246.3 | Success: 0.0% | Time: 30.0min
Episode 84000/150000 | Phase 3 (Full) | ε: 0.0529 | α: 0.00932 | Eval: -209.6 | Success: 0.0% | Time: 32.0min
Episode 85000/150000 | Recent Avg: -186.0 | ε: 0.0510
Episode 87000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00878 | Eval: -186.3 | Success: 0.0% | Time: 33.9min
Episode 90000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00826 | Eval: -251.4 | Success: 0.0% | Time: 35.9min
Episode 93000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00778 | Eval: -328.1 | Success: 0.0% | Time: 37.9min
Episode 95000/150000 | Recent Avg: -138.2 | ε: 0.0500
Episode 96000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00733 | Eval: -193.1 | Success: 0.0% | Time: 40.2min
Episode 99000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00690 | Eval: -155.5 | Success: 0.0% | Time: 42.4min
Episode 100000/150000 | Recent Avg: -133.6 | ε: 0.0500
Episode 102000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00650 | Eval: -161.4 | Success: 0.0% | Time: 44.4min
Episode 105000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00612 | Eval: -374.2 | Success: 0.0% | Time: 46.4min
Episode 108000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00577 | Eval: -195.6 | Success: 0.0% | Time: 48.6min
Episode 110000/150000 | Recent Avg: -143.2 | ε: 0.0500
Episode 111000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00543 | Eval: -144.8 | Success: 0.0% | Time: 50.5min
Episode 114000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00511 | Eval: -179.7 | Success: 5.0% | Time: 52.4min
Episode 115000/150000 | Recent Avg: -114.7 | ε: 0.0500
Episode 117000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00500 | Eval: -120.9 | Success: 0.0% | Time: 54.5min
Episode 120000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00500 | Eval: -181.8 | Success: 5.0% | Time: 56.6min
Episode 123000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00500 | Eval: -129.8 | Success: 0.0% | Time: 58.5min
Episode 125000/150000 | Recent Avg: -144.4 | ε: 0.0500
Episode 126000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00500 | Eval: -192.5 | Success: 0.0% | Time: 60.4min
Episode 129000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00500 | Eval: -122.8 | Success: 0.0% | Time: 62.6min
Episode 130000/150000 | Recent Avg: -165.5 | ε: 0.0500
Episode 132000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00500 | Eval: -143.9 | Success: 0.0% | Time: 64.8min
Episode 135000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00500 | Eval: -171.0 | Success: 0.0% | Time: 66.9min
Episode 138000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00500 | Eval: -152.3 | Success: 0.0% | Time: 69.0min
Episode 140000/150000 | Recent Avg: -147.6 | ε: 0.0500
Episode 141000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00500 | Eval: -154.8 | Success: 10.0% | Time: 71.2min
Episode 144000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00500 | Eval: -256.4 | Success: 0.0% | Time: 73.3min
Episode 145000/150000 | Recent Avg: -214.8 | ε: 0.0500
Episode 147000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00500 | Eval: -187.6 | Success: 5.0% | Time: 75.3min
Episode 150000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00500 | Eval: -129.4 | Success: 10.0% | Time: 77.5min

======================================================================
TRAINING COMPLETE
Total Time: 77.5 minutes
States Visited: 9347
======================================================================

Saved: q_learning_ultra_stable.pkl

[2/3] Training SARSA Agent...

======================================================================
TRAINING SARSA AGENT (ULTRA-STABLE)
======================================================================
Episodes: 150000
Learning Rate: 0.05 → 0.005
Epsilon: 1.0 → 0.05
Reward Shaping Weight: 0.3
Curriculum Learning: ENABLED
Reward Clipping: ENABLED
======================================================================

Episode 3000/150000 | Phase 1 (Upright) | ε: 0.9003 | α: 0.04709 | Eval: -317.1 | Success: 0.0% | Time: 0.6min
Episode 5000/150000 | Recent Avg: -143.9 | ε: 0.8395
Episode 6000/150000 | Phase 1 (Upright) | ε: 0.8106 | α: 0.04435 | Eval: -346.3 | Success: 0.0% | Time: 1.2min
Episode 9000/150000 | Phase 1 (Upright) | ε: 0.7298 | α: 0.04176 | Eval: -266.5 | Success: 0.0% | Time: 1.9min
Episode 10000/150000 | Recent Avg: -124.4 | ε: 0.7047
Episode 12000/150000 | Phase 1 (Upright) | ε: 0.6570 | α: 0.03933 | Eval: -228.1 | Success: 0.0% | Time: 2.7min
Episode 15000/150000 | Phase 1 (Upright) | ε: 0.5915 | α: 0.03704 | Eval: -245.0 | Success: 0.0% | Time: 3.6min
Episode 18000/150000 | Phase 1 (Upright) | ε: 0.5326 | α: 0.03488 | Eval: -315.8 | Success: 0.0% | Time: 4.6min
Episode 20000/150000 | Recent Avg: -101.2 | ε: 0.4966
Episode 21000/150000 | Phase 1 (Upright) | ε: 0.4795 | α: 0.03285 | Eval: -295.1 | Success: 0.0% | Time: 5.7min
Episode 24000/150000 | Phase 1 (Upright) | ε: 0.4317 | α: 0.03094 | Eval: -348.8 | Success: 0.0% | Time: 7.1min
Episode 25000/150000 | Recent Avg: -111.9 | ε: 0.4169
Episode 27000/150000 | Phase 1 (Upright) | ε: 0.3887 | α: 0.02914 | Eval: -356.8 | Success: 0.0% | Time: 8.5min
Episode 30000/150000 | Phase 1 (Upright) | ε: 0.3499 | α: 0.02744 | Eval: -247.2 | Success: 0.0% | Time: 10.1min
Episode 33000/150000 | Phase 2 (Descent) | ε: 0.3151 | α: 0.02584 | Eval: -245.6 | Success: 0.0% | Time: 11.8min
Episode 35000/150000 | Recent Avg: -145.9 | ε: 0.2938
Episode 36000/150000 | Phase 2 (Descent) | ε: 0.2836 | α: 0.02434 | Eval: -291.7 | Success: 5.0% | Time: 13.6min
Episode 39000/150000 | Phase 2 (Descent) | ε: 0.2554 | α: 0.02292 | Eval: -181.0 | Success: 0.0% | Time: 15.3min
Episode 40000/150000 | Recent Avg: -173.0 | ε: 0.2466
Episode 42000/150000 | Phase 2 (Descent) | ε: 0.2299 | α: 0.02159 | Eval: -241.4 | Success: 0.0% | Time: 17.1min
Episode 45000/150000 | Phase 2 (Descent) | ε: 0.2070 | α: 0.02033 | Eval: -272.8 | Success: 0.0% | Time: 19.0min
Episode 48000/150000 | Phase 2 (Descent) | ε: 0.1864 | α: 0.01914 | Eval: -262.4 | Success: 0.0% | Time: 20.8min
Episode 50000/150000 | Recent Avg: -188.3 | ε: 0.1738
Episode 51000/150000 | Phase 2 (Descent) | ε: 0.1678 | α: 0.01803 | Eval: -292.1 | Success: 0.0% | Time: 22.7min
Episode 54000/150000 | Phase 2 (Descent) | ε: 0.1511 | α: 0.01698 | Eval: -220.1 | Success: 0.0% | Time: 24.8min
Episode 55000/150000 | Recent Avg: -181.3 | ε: 0.1459
Episode 57000/150000 | Phase 2 (Descent) | ε: 0.1360 | α: 0.01599 | Eval: -305.1 | Success: 0.0% | Time: 26.8min
Episode 60000/150000 | Phase 2 (Descent) | ε: 0.1225 | α: 0.01506 | Eval: -254.6 | Success: 0.0% | Time: 28.8min
Episode 63000/150000 | Phase 2 (Descent) | ε: 0.1102 | α: 0.01418 | Eval: -199.7 | Success: 0.0% | Time: 30.8min
Episode 65000/150000 | Recent Avg: -198.4 | ε: 0.1028
Episode 66000/150000 | Phase 2 (Descent) | ε: 0.0993 | α: 0.01336 | Eval: -200.1 | Success: 5.0% | Time: 32.5min
Episode 69000/150000 | Phase 2 (Descent) | ε: 0.0894 | α: 0.01258 | Eval: -153.0 | Success: 0.0% | Time: 33.5min
Episode 70000/150000 | Recent Avg: -210.5 | ε: 0.0863
Episode 72000/150000 | Phase 3 (Full) | ε: 0.0805 | α: 0.01185 | Eval: -240.8 | Success: 0.0% | Time: 34.4min
Episode 75000/150000 | Phase 3 (Full) | ε: 0.0724 | α: 0.01116 | Eval: -285.1 | Success: 0.0% | Time: 35.3min
Episode 78000/150000 | Phase 3 (Full) | ε: 0.0652 | α: 0.01051 | Eval: -219.2 | Success: 5.0% | Time: 36.1min
Episode 80000/150000 | Recent Avg: -234.3 | ε: 0.0608
Episode 81000/150000 | Phase 3 (Full) | ε: 0.0587 | α: 0.00989 | Eval: -222.8 | Success: 0.0% | Time: 36.9min
Episode 84000/150000 | Phase 3 (Full) | ε: 0.0529 | α: 0.00932 | Eval: -118.8 | Success: 0.0% | Time: 37.9min
Episode 85000/150000 | Recent Avg: -169.2 | ε: 0.0510
Episode 87000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00878 | Eval: -273.1 | Success: 0.0% | Time: 38.8min
Episode 90000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00826 | Eval: -175.0 | Success: 0.0% | Time: 39.9min
Episode 93000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00778 | Eval: -139.1 | Success: 0.0% | Time: 40.8min
Episode 95000/150000 | Recent Avg: -220.5 | ε: 0.0500
Episode 96000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00733 | Eval: -244.3 | Success: 0.0% | Time: 41.7min
Episode 99000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00690 | Eval: -250.8 | Success: 5.0% | Time: 42.5min
Episode 100000/150000 | Recent Avg: -184.0 | ε: 0.0500
Episode 102000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00650 | Eval: -230.0 | Success: 0.0% | Time: 43.5min
Episode 105000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00612 | Eval: -174.3 | Success: 0.0% | Time: 44.5min
Episode 108000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00577 | Eval: -284.1 | Success: 0.0% | Time: 45.3min
Episode 110000/150000 | Recent Avg: -146.1 | ε: 0.0500
Episode 111000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00543 | Eval: -188.1 | Success: 0.0% | Time: 46.1min
Episode 114000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00511 | Eval: -228.6 | Success: 0.0% | Time: 47.0min
Episode 115000/150000 | Recent Avg: -177.9 | ε: 0.0500
Episode 117000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00500 | Eval: -230.7 | Success: 0.0% | Time: 47.9min
Episode 120000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00500 | Eval: -229.1 | Success: 0.0% | Time: 49.0min
Episode 123000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00500 | Eval: -138.1 | Success: 0.0% | Time: 49.9min
Episode 125000/150000 | Recent Avg: -200.6 | ε: 0.0500
Episode 126000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00500 | Eval: -215.0 | Success: 5.0% | Time: 50.8min
Episode 129000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00500 | Eval: -225.0 | Success: 0.0% | Time: 51.9min
Episode 130000/150000 | Recent Avg: -185.0 | ε: 0.0500
Episode 132000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00500 | Eval: -288.2 | Success: 0.0% | Time: 52.8min
Episode 135000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00500 | Eval: -358.9 | Success: 0.0% | Time: 53.6min
Episode 138000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00500 | Eval: -323.1 | Success: 5.0% | Time: 54.5min
Episode 140000/150000 | Recent Avg: -236.2 | ε: 0.0500
Episode 141000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00500 | Eval: -259.1 | Success: 0.0% | Time: 55.3min
Episode 144000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00500 | Eval: -261.4 | Success: 0.0% | Time: 56.1min
Episode 145000/150000 | Recent Avg: -306.1 | ε: 0.0500
Episode 147000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00500 | Eval: -314.6 | Success: 0.0% | Time: 57.0min
Episode 150000/150000 | Phase 3 (Full) | ε: 0.0500 | α: 0.00500 | Eval: -151.0 | Success: 0.0% | Time: 57.9min

======================================================================
TRAINING COMPLETE
Total Time: 57.9 minutes
States Visited: 10152
======================================================================

Saved: sarsa_ultra_stable.pkl

[3/3] Training Monte Carlo Agent...

======================================================================
TRAINING MONTE CARLO AGENT (ULTRA-STABLE)
======================================================================
Episodes: 150000
Reward Shaping Weight: 0.3
Curriculum Learning: ENABLED
======================================================================

Episode 3000/150000 | ε: 0.9003 | Eval: -64.2 | Success: 0.0% | Time: 0.2min
Episode 6000/150000 | ε: 0.8106 | Eval: -61.4 | Success: 0.0% | Time: 0.5min
Episode 9000/150000 | ε: 0.7298 | Eval: -64.9 | Success: 0.0% | Time: 0.7min
Episode 12000/150000 | ε: 0.6570 | Eval: -90.4 | Success: 0.0% | Time: 1.0min
Episode 15000/150000 | ε: 0.5915 | Eval: -120.1 | Success: 0.0% | Time: 1.2min
Episode 18000/150000 | ε: 0.5326 | Eval: -96.1 | Success: 0.0% | Time: 1.5min
Episode 21000/150000 | ε: 0.4795 | Eval: -44.2 | Success: 0.0% | Time: 1.7min
Episode 24000/150000 | ε: 0.4317 | Eval: -83.4 | Success: 0.0% | Time: 1.9min
Episode 27000/150000 | ε: 0.3887 | Eval: -79.3 | Success: 0.0% | Time: 2.2min
Episode 30000/150000 | ε: 0.3499 | Eval: -98.2 | Success: 0.0% | Time: 2.4min
Episode 33000/150000 | ε: 0.3151 | Eval: -170.5 | Success: 0.0% | Time: 2.7min
Episode 36000/150000 | ε: 0.2836 | Eval: -89.0 | Success: 0.0% | Time: 2.9min
Episode 39000/150000 | ε: 0.2554 | Eval: -73.3 | Success: 0.0% | Time: 3.2min
Episode 42000/150000 | ε: 0.2299 | Eval: -97.8 | Success: 0.0% | Time: 3.5min
Episode 45000/150000 | ε: 0.2070 | Eval: -72.5 | Success: 0.0% | Time: 3.7min
Episode 48000/150000 | ε: 0.1864 | Eval: -90.9 | Success: 0.0% | Time: 3.9min
Episode 51000/150000 | ε: 0.1678 | Eval: -94.0 | Success: 0.0% | Time: 4.2min
Episode 54000/150000 | ε: 0.1511 | Eval: -74.8 | Success: 0.0% | Time: 4.4min
Episode 57000/150000 | ε: 0.1360 | Eval: -78.8 | Success: 0.0% | Time: 4.6min
Episode 60000/150000 | ε: 0.1225 | Eval: -71.0 | Success: 0.0% | Time: 4.9min
Episode 63000/150000 | ε: 0.1102 | Eval: -72.8 | Success: 0.0% | Time: 5.1min
Episode 66000/150000 | ε: 0.0993 | Eval: -126.5 | Success: 0.0% | Time: 5.3min
Episode 69000/150000 | ε: 0.0894 | Eval: -82.0 | Success: 0.0% | Time: 5.5min
Episode 72000/150000 | ε: 0.0805 | Eval: -67.9 | Success: 0.0% | Time: 5.8min
Episode 75000/150000 | ε: 0.0724 | Eval: -102.6 | Success: 0.0% | Time: 6.0min
Episode 78000/150000 | ε: 0.0652 | Eval: -65.9 | Success: 0.0% | Time: 6.2min
Episode 81000/150000 | ε: 0.0587 | Eval: -82.9 | Success: 0.0% | Time: 6.4min
Episode 84000/150000 | ε: 0.0529 | Eval: -68.0 | Success: 0.0% | Time: 6.7min
Episode 87000/150000 | ε: 0.0500 | Eval: -72.6 | Success: 0.0% | Time: 6.9min
Episode 90000/150000 | ε: 0.0500 | Eval: -86.4 | Success: 0.0% | Time: 7.1min
Episode 93000/150000 | ε: 0.0500 | Eval: -82.7 | Success: 0.0% | Time: 7.4min
Episode 96000/150000 | ε: 0.0500 | Eval: -68.8 | Success: 0.0% | Time: 7.6min
Episode 99000/150000 | ε: 0.0500 | Eval: -83.7 | Success: 0.0% | Time: 7.9min
Episode 102000/150000 | ε: 0.0500 | Eval: -73.2 | Success: 0.0% | Time: 8.1min
Episode 105000/150000 | ε: 0.0500 | Eval: -86.6 | Success: 0.0% | Time: 8.3min
Episode 108000/150000 | ε: 0.0500 | Eval: -82.3 | Success: 0.0% | Time: 8.6min
Episode 111000/150000 | ε: 0.0500 | Eval: -95.7 | Success: 0.0% | Time: 8.8min
Episode 114000/150000 | ε: 0.0500 | Eval: -59.3 | Success: 0.0% | Time: 9.1min
Episode 117000/150000 | ε: 0.0500 | Eval: -76.2 | Success: 0.0% | Time: 9.3min
Episode 120000/150000 | ε: 0.0500 | Eval: -85.9 | Success: 0.0% | Time: 9.5min
Episode 123000/150000 | ε: 0.0500 | Eval: -67.7 | Success: 0.0% | Time: 9.8min
Episode 126000/150000 | ε: 0.0500 | Eval: -56.6 | Success: 0.0% | Time: 10.0min
Episode 129000/150000 | ε: 0.0500 | Eval: -78.0 | Success: 0.0% | Time: 10.3min
Episode 132000/150000 | ε: 0.0500 | Eval: -102.5 | Success: 0.0% | Time: 10.5min
Episode 135000/150000 | ε: 0.0500 | Eval: -76.7 | Success: 0.0% | Time: 10.8min
Episode 138000/150000 | ε: 0.0500 | Eval: -74.9 | Success: 0.0% | Time: 11.0min
Episode 141000/150000 | ε: 0.0500 | Eval: -70.2 | Success: 0.0% | Time: 11.2min
Episode 144000/150000 | ε: 0.0500 | Eval: -58.0 | Success: 0.0% | Time: 11.5min
Episode 147000/150000 | ε: 0.0500 | Eval: -46.3 | Success: 0.0% | Time: 11.7min
Episode 150000/150000 | ε: 0.0500 | Eval: -87.2 | Success: 0.0% | Time: 12.0min

======================================================================
TRAINING COMPLETE
Total Time: 12.0 minutes
======================================================================

Saved: monte_carlo_ultra_stable.pkl

======================================================================
FINAL EVALUATION (100 episodes each)
======================================================================

Q-Learning Ultra-Stable:
  Mean Reward: -131.73 ± 148.66
  Success Rate: 0.0%
  Best Episode: 124.15

SARSA Ultra-Stable:
  Mean Reward: -180.66 ± 162.38
  Success Rate: 1.0%
  Best Episode: 259.80

Monte Carlo Ultra-Stable:
  Mean Reward: -72.74 ± 30.83
  Success Rate: 0.0%
  Best Episode: -10.22

======================================================================
PERFORMANCE RANKING:
======================================================================
  🥇 #1: Monte Carlo
      Mean Reward: -72.74 | Success Rate: 0.0%
  🥈 #2: Q-Learning
      Mean Reward: -131.73 | Success Rate: 0.0%
  🥉 #3: SARSA
      Mean Reward: -180.66 | Success Rate: 1.0%

Generating comparison plots...
Plot saved to: outputs/training_ultra_stable.png

======================================================================
TRAINING COMPLETE!
======================================================================
Models saved as *_ultra_stable.pkl
Plot saved as training_ultra_stable.png
PS C:\Users\cmano\Downloads\betterLunarLander> python .\lander_simple.py

======================================================================
REFINED APPROACH: FOCUS ON FUNDAMENTALS
======================================================================

Philosophy:
  • FINER discretization > Aggressive shaping
  • SIMPLE shaping > Complex curriculum
  • PROVEN hyperparameters > Exotic tricks
  • Q-LEARNING only > Three struggling algorithms

Training Q-Learning with refined approach...

======================================================================
REFINED Q-LEARNING - BACK TO BASICS
======================================================================
KEY CHANGES:
  • Finer discretization: 12 bins (was 8)
  • Non-uniform bins: More precision where it matters
  • Simple reward shaping: Focus on landing configuration
  • Standard hyperparameters: Proven RL values
  • More episodes: 200000 (finer grid needs more data)
======================================================================

C:\Users\cmano\AppData\Roaming\Python\Python311\site-packages\pygame\pkgdata.py:25: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import resource_stream, resource_exists
Ep   5000/200000 | ε: 0.779 | Eval:  -202.3 | Success:   0.0% | States:   16501 | Time:   0.4m
Ep  10000/200000 | ε: 0.607 | Eval:   -91.1 | Success:   0.0% | States:   24846 | Time:   1.0m
Ep  15000/200000 | ε: 0.472 | Eval:  -112.1 | Success:   0.0% | States:   32657 | Time:   1.6m
Ep  20000/200000 | ε: 0.368 | Eval:  -112.6 | Success:   0.0% | States:   39763 | Time:   2.3m
Ep  25000/200000 | ε: 0.286 | Eval:   -94.7 | Success:   5.0% | States:   45836 | Time:   3.4m
Ep  30000/200000 | ε: 0.223 | Eval:   -23.4 | Success:  20.0% | States:   50351 | Time:   4.8m
Ep  35000/200000 | ε: 0.174 | Eval:   -56.0 | Success:   0.0% | States:   54531 | Time:   6.5m
Ep  40000/200000 | ε: 0.135 | Eval:   -14.2 | Success:  10.0% | States:   57808 | Time:   8.3m
Ep  45000/200000 | ε: 0.105 | Eval:   -38.6 | Success:  10.0% | States:   60478 | Time:  10.2m
Ep  50000/200000 | ε: 0.082 | Eval:     5.2 | Success:   5.0% | States:   62804 | Time:  12.3m
Ep  55000/200000 | ε: 0.064 | Eval:    91.1 | Success:  20.0% | States:   64600 | Time:  14.4m
Ep  60000/200000 | ε: 0.050 | Eval:    51.5 | Success:  25.0% | States:   66082 | Time:  16.6m
Ep  65000/200000 | ε: 0.039 | Eval:   109.7 | Success:  35.0% | States:   67300 | Time:  18.8m
Ep  70000/200000 | ε: 0.030 | Eval:    74.3 | Success:  30.0% | States:   68453 | Time:  21.0m
Ep  75000/200000 | ε: 0.024 | Eval:   101.9 | Success:  50.0% | States:   69265 | Time:  23.2m
Ep  80000/200000 | ε: 0.018 | Eval:    88.9 | Success:  20.0% | States:   69845 | Time:  25.5m
Ep  85000/200000 | ε: 0.014 | Eval:    71.4 | Success:  30.0% | States:   70440 | Time:  27.9m
Ep  90000/200000 | ε: 0.011 | Eval:   101.8 | Success:  40.0% | States:   70939 | Time:  32.6m
Ep  95000/200000 | ε: 0.010 | Eval:    54.8 | Success:  25.0% | States:   71419 | Time:  38.1m
Ep 100000/200000 | ε: 0.010 | Eval:   102.4 | Success:  40.0% | States:   71837 | Time:  43.6m
Ep 105000/200000 | ε: 0.010 | Eval:   124.1 | Success:  55.0% | States:   72222 | Time:  48.9m
Ep 110000/200000 | ε: 0.010 | Eval:   153.4 | Success:  65.0% | States:   72520 | Time:  52.4m
Ep 115000/200000 | ε: 0.010 | Eval:   135.8 | Success:  55.0% | States:   72788 | Time:  55.0m
Ep 120000/200000 | ε: 0.010 | Eval:   151.7 | Success:  55.0% | States:   73027 | Time:  57.3m
Ep 125000/200000 | ε: 0.010 | Eval:   126.7 | Success:  45.0% | States:   73221 | Time:  59.7m
Ep 130000/200000 | ε: 0.010 | Eval:    93.1 | Success:  10.0% | States:   73467 | Time:  62.1m
Ep 135000/200000 | ε: 0.010 | Eval:   123.7 | Success:  25.0% | States:   73655 | Time:  64.4m
Ep 140000/200000 | ε: 0.010 | Eval:   121.5 | Success:  55.0% | States:   73887 | Time:  66.8m
Traceback (most recent call last):
  File "C:\Users\cmano\Downloads\betterLunarLander\lander_simple.py", line 348, in <module>
    rewards, eval_stats, agent = train_q_learning()
                                 ^^^^^^^^^^^^^^^^^^
  File "C:\Users\cmano\Downloads\betterLunarLander\lander_simple.py", line 283, in train_q_learning
    next_state = discretize_state(next_state_full)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\cmano\Downloads\betterLunarLander\lander_simple.py", line 88, in discretize_state
    s3 = np.digitize(y_vel, y_vel_bins)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\cmano\AppData\Roaming\Python\Python311\site-packages\numpy\lib\_function_base_impl.py", line 5827, in digitize
    return _nx.searchsorted(bins, x, side=side)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\cmano\AppData\Roaming\Python\Python311\site-packages\numpy\_core\fromnumeric.py", line 1527, in searchsorted
    return _wrapfunc(a, 'searchsorted', v, side=side, sorter=sorter)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\cmano\AppData\Roaming\Python\Python311\site-packages\numpy\_core\fromnumeric.py", line 57, in _wrapfunc
    return bound(*args, **kwds)
           ^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
PS C:\Users\cmano\Downloads\betterLunarLander> python .\lander_three_agents.py

======================================================================
LUNAR LANDER - THREE ALGORITHMS COMPARISON
======================================================================

Algorithms:
  1. Q-Learning: Off-policy TD (uses max Q of next state)
  2. SARSA: On-policy TD (uses Q of actual next action)
  3. Monte Carlo: Episode-based (uses actual returns)

Key Differences:
  • Q-Learning is more aggressive (can learn optimal policy while exploring)
  • SARSA is more conservative (learns policy it's actually following)
  • Monte Carlo requires complete episodes (potentially slower learning)

[1/3] Training Q-Learning Agent...

======================================================================
TRAINING: Q-LEARNING
======================================================================

C:\Users\cmano\AppData\Roaming\Python\Python311\site-packages\pygame\pkgdata.py:25: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import resource_stream, resource_exists
Ep   5000/200000 | ε: 0.779 | Eval:  -174.0 | Success:   0.0% | States:   16389 | Time:   0.9m
Ep  10000/200000 | ε: 0.607 | Eval:  -116.8 | Success:   0.0% | States:   24840 | Time:   2.1m
Ep  15000/200000 | ε: 0.472 | Eval:  -109.4 | Success:   0.0% | States:   32524 | Time:   3.6m
Ep  20000/200000 | ε: 0.368 | Eval:  -100.6 | Success:   0.0% | States:   39742 | Time:   5.5m
Ep  25000/200000 | ε: 0.286 | Eval:   -80.6 | Success:   0.0% | States:   44993 | Time:   8.1m
Ep  30000/200000 | ε: 0.223 | Eval:   -42.4 | Success:   0.0% | States:   49986 | Time:  11.0m
Ep  35000/200000 | ε: 0.174 | Eval:   -65.8 | Success:   0.0% | States:   54111 | Time:  14.6m
Ep  40000/200000 | ε: 0.135 | Eval:   -54.4 | Success:   5.0% | States:   57519 | Time:  19.0m
Ep  45000/200000 | ε: 0.105 | Eval:     2.9 | Success:  10.0% | States:   60398 | Time:  23.2m
Ep  50000/200000 | ε: 0.082 | Eval:   -34.4 | Success:  10.0% | States:   62551 | Time:  27.5m
Ep  55000/200000 | ε: 0.064 | Eval:    50.3 | Success:  30.0% | States:   64460 | Time:  30.0m
Ep  60000/200000 | ε: 0.050 | Eval:    91.2 | Success:  30.0% | States:   65891 | Time:  32.4m
Ep  65000/200000 | ε: 0.039 | Eval:    65.8 | Success:  30.0% | States:   67110 | Time:  34.9m
Ep  70000/200000 | ε: 0.030 | Eval:    34.3 | Success:  25.0% | States:   68104 | Time:  37.4m
Ep  75000/200000 | ε: 0.024 | Eval:    82.0 | Success:  40.0% | States:   69031 | Time:  39.9m
Ep  80000/200000 | ε: 0.018 | Eval:    73.9 | Success:  25.0% | States:   69771 | Time:  42.3m
Ep  85000/200000 | ε: 0.014 | Eval:   103.7 | Success:  40.0% | States:   70471 | Time:  44.9m
Ep  90000/200000 | ε: 0.011 | Eval:    51.1 | Success:  25.0% | States:   71042 | Time:  47.5m
Ep  95000/200000 | ε: 0.010 | Eval:    98.5 | Success:  30.0% | States:   71473 | Time:  50.0m
Ep 100000/200000 | ε: 0.010 | Eval:    89.4 | Success:  40.0% | States:   71861 | Time:  52.6m
Ep 105000/200000 | ε: 0.010 | Eval:   134.4 | Success:  30.0% | States:   72288 | Time:  57.4m
Ep 110000/200000 | ε: 0.010 | Eval:    87.7 | Success:  30.0% | States:   72605 | Time:  61.9m
Ep 115000/200000 | ε: 0.010 | Eval:    42.9 | Success:  20.0% | States:   72913 | Time:  64.3m
Ep 120000/200000 | ε: 0.010 | Eval:    79.9 | Success:  10.0% | States:   73151 | Time:  66.6m
Ep 125000/200000 | ε: 0.010 | Eval:   150.7 | Success:  55.0% | States:   73417 | Time:  69.0m
Ep 130000/200000 | ε: 0.010 | Eval:   151.4 | Success:  55.0% | States:   73728 | Time:  71.3m
Ep 135000/200000 | ε: 0.010 | Eval:   141.8 | Success:  30.0% | States:   73907 | Time:  73.6m
Ep 140000/200000 | ε: 0.010 | Eval:   137.8 | Success:  40.0% | States:   74088 | Time:  75.9m
Ep 145000/200000 | ε: 0.010 | Eval:   156.2 | Success:  35.0% | States:   74318 | Time:  78.2m
Ep 150000/200000 | ε: 0.010 | Eval:   114.7 | Success:  20.0% | States:   74510 | Time:  80.6m
Ep 155000/200000 | ε: 0.010 | Eval:   172.4 | Success:  65.0% | States:   74665 | Time:  82.9m
Ep 160000/200000 | ε: 0.010 | Eval:    97.4 | Success:  25.0% | States:   74792 | Time:  85.3m
Ep 165000/200000 | ε: 0.010 | Eval:   134.1 | Success:  45.0% | States:   74959 | Time:  87.7m
Ep 170000/200000 | ε: 0.010 | Eval:    90.3 | Success:  25.0% | States:   75113 | Time:  90.0m
Ep 175000/200000 | ε: 0.010 | Eval:   121.0 | Success:  35.0% | States:   75312 | Time:  92.3m
Ep 180000/200000 | ε: 0.010 | Eval:   122.4 | Success:  35.0% | States:   75396 | Time:  94.7m
Ep 185000/200000 | ε: 0.010 | Eval:   149.9 | Success:  40.0% | States:   75496 | Time:  97.0m
Ep 190000/200000 | ε: 0.010 | Eval:   134.3 | Success:  45.0% | States:   75625 | Time:  99.4m
Ep 195000/200000 | ε: 0.010 | Eval:    82.8 | Success:  35.0% | States:   75729 | Time: 101.7m
Ep 200000/200000 | ε: 0.010 | Eval:   130.0 | Success:  45.0% | States:   75898 | Time: 104.1m

======================================================================
TRAINING COMPLETE: Q-Learning
Time: 104.1 minutes
States visited: 75,898
Total updates: 90,481,652
======================================================================

Q-Learning model saved!

[2/3] Training SARSA Agent...

======================================================================
TRAINING: SARSA
======================================================================

Ep   5000/200000 | ε: 0.779 | Eval:  -189.8 | Success:   0.0% | States:   16964 | Time:   0.4m
Ep  10000/200000 | ε: 0.607 | Eval:  -199.2 | Success:   0.0% | States:   27469 | Time:   1.0m
Ep  15000/200000 | ε: 0.472 | Eval:  -205.8 | Success:   0.0% | States:   38787 | Time:   1.6m
Ep  20000/200000 | ε: 0.368 | Eval:  -183.3 | Success:   0.0% | States:   48457 | Time:   2.5m
Ep  25000/200000 | ε: 0.286 | Eval:  -179.7 | Success:   0.0% | States:   55679 | Time:   3.6m
Ep  30000/200000 | ε: 0.223 | Eval:  -198.9 | Success:   0.0% | States:   60735 | Time:   4.9m
Ep  35000/200000 | ε: 0.174 | Eval:  -163.2 | Success:   0.0% | States:   64776 | Time:   6.3m
Ep  40000/200000 | ε: 0.135 | Eval:  -136.3 | Success:   5.0% | States:   68400 | Time:   7.7m
Ep  45000/200000 | ε: 0.105 | Eval:   -53.2 | Success:  10.0% | States:   71548 | Time:   9.3m
Ep  50000/200000 | ε: 0.082 | Eval:   -62.3 | Success:  10.0% | States:   74179 | Time:  11.0m
Ep  55000/200000 | ε: 0.064 | Eval:    -0.1 | Success:   5.0% | States:   76285 | Time:  12.9m
Ep  60000/200000 | ε: 0.050 | Eval:   -56.2 | Success:   0.0% | States:   77807 | Time:  15.0m
Ep  65000/200000 | ε: 0.039 | Eval:    -4.7 | Success:  25.0% | States:   79202 | Time:  17.1m
Ep  70000/200000 | ε: 0.030 | Eval:    42.3 | Success:  10.0% | States:   80191 | Time:  19.2m
Ep  75000/200000 | ε: 0.024 | Eval:    30.4 | Success:  15.0% | States:   80961 | Time:  21.5m
Ep  80000/200000 | ε: 0.018 | Eval:    78.7 | Success:  30.0% | States:   81747 | Time:  23.9m
Ep  85000/200000 | ε: 0.014 | Eval:    77.3 | Success:  10.0% | States:   82212 | Time:  26.2m
Ep  90000/200000 | ε: 0.011 | Eval:    41.1 | Success:  20.0% | States:   82655 | Time:  28.6m
Ep  95000/200000 | ε: 0.010 | Eval:    80.1 | Success:  10.0% | States:   83108 | Time:  31.2m
Ep 100000/200000 | ε: 0.010 | Eval:   -41.4 | Success:  15.0% | States:   83514 | Time:  33.6m
Ep 105000/200000 | ε: 0.010 | Eval:    98.0 | Success:  30.0% | States:   83755 | Time:  36.1m
Ep 110000/200000 | ε: 0.010 | Eval:    97.5 | Success:  20.0% | States:   84005 | Time:  38.6m
Ep 115000/200000 | ε: 0.010 | Eval:   128.7 | Success:  30.0% | States:   84216 | Time:  41.1m
Ep 120000/200000 | ε: 0.010 | Eval:    38.2 | Success:  25.0% | States:   84493 | Time:  43.6m
Ep 125000/200000 | ε: 0.010 | Eval:    40.0 | Success:  20.0% | States:   84701 | Time:  46.1m
Ep 130000/200000 | ε: 0.010 | Eval:    18.5 | Success:  15.0% | States:   84984 | Time:  48.6m
Ep 135000/200000 | ε: 0.010 | Eval:   111.1 | Success:  35.0% | States:   85233 | Time:  51.0m
Ep 140000/200000 | ε: 0.010 | Eval:    76.3 | Success:  20.0% | States:   85431 | Time:  53.5m
Ep 145000/200000 | ε: 0.010 | Eval:    81.2 | Success:  30.0% | States:   85687 | Time:  55.9m
Ep 150000/200000 | ε: 0.010 | Eval:    89.4 | Success:  20.0% | States:   85879 | Time:  58.4m
Ep 155000/200000 | ε: 0.010 | Eval:   141.8 | Success:  45.0% | States:   86057 | Time:  60.8m
Ep 160000/200000 | ε: 0.010 | Eval:    51.7 | Success:  25.0% | States:   86280 | Time:  63.2m
Ep 165000/200000 | ε: 0.010 | Eval:    94.2 | Success:  15.0% | States:   86467 | Time:  65.6m
Ep 170000/200000 | ε: 0.010 | Eval:    92.4 | Success:  30.0% | States:   86653 | Time:  68.1m
Ep 175000/200000 | ε: 0.010 | Eval:    50.8 | Success:  25.0% | States:   86870 | Time:  70.6m
Ep 180000/200000 | ε: 0.010 | Eval:   121.5 | Success:  45.0% | States:   87085 | Time:  73.0m
Ep 185000/200000 | ε: 0.010 | Eval:    92.5 | Success:  30.0% | States:   87221 | Time:  75.4m
Ep 190000/200000 | ε: 0.010 | Eval:   126.9 | Success:  30.0% | States:   87368 | Time:  77.9m
Ep 195000/200000 | ε: 0.010 | Eval:   131.1 | Success:  25.0% | States:   87538 | Time:  80.4m
Ep 200000/200000 | ε: 0.010 | Eval:    98.2 | Success:  35.0% | States:   87650 | Time:  82.8m

======================================================================
TRAINING COMPLETE: SARSA
Time: 82.8 minutes
States visited: 87,650
Total updates: 96,767,681
======================================================================

SARSA model saved!

[3/3] Training Monte Carlo Agent...

======================================================================
TRAINING: MONTE CARLO
======================================================================

Ep   5000/200000 | ε: 0.779 | Eval:   -94.6 | Success:   0.0% | States:   13652 | Time:   0.4m
Ep  10000/200000 | ε: 0.607 | Eval:   -50.1 | Success:   0.0% | States:   16713 | Time:   0.8m
Ep  15000/200000 | ε: 0.472 | Eval:   -33.1 | Success:   0.0% | States:   18098 | Time:   1.2m
Ep  20000/200000 | ε: 0.368 | Eval:   -42.8 | Success:   0.0% | States:   18806 | Time:   1.6m
Ep  25000/200000 | ε: 0.286 | Eval:   -42.2 | Success:   0.0% | States:   19236 | Time:   2.0m
Ep  30000/200000 | ε: 0.223 | Eval:   -44.8 | Success:   0.0% | States:   19524 | Time:   2.4m
Ep  35000/200000 | ε: 0.174 | Eval:   -48.1 | Success:   0.0% | States:   19769 | Time:   2.7m
Ep  40000/200000 | ε: 0.135 | Eval:   -42.7 | Success:   0.0% | States:   19995 | Time:   3.1m
Ep  45000/200000 | ε: 0.105 | Eval:   -35.9 | Success:   0.0% | States:   20189 | Time:   3.5m
Ep  50000/200000 | ε: 0.082 | Eval:   -41.1 | Success:   0.0% | States:   20384 | Time:   3.9m
Ep  55000/200000 | ε: 0.064 | Eval:   -30.1 | Success:   0.0% | States:   20542 | Time:   4.3m
Ep  60000/200000 | ε: 0.050 | Eval:   -33.4 | Success:   0.0% | States:   20694 | Time:   4.7m
Ep  65000/200000 | ε: 0.039 | Eval:   -38.6 | Success:   0.0% | States:   20835 | Time:   5.1m
Ep  70000/200000 | ε: 0.030 | Eval:   -51.1 | Success:   0.0% | States:   20947 | Time:   5.4m
Ep  75000/200000 | ε: 0.024 | Eval:   -33.7 | Success:   0.0% | States:   21066 | Time:   5.8m
Ep  80000/200000 | ε: 0.018 | Eval:   -48.5 | Success:   0.0% | States:   21171 | Time:   6.2m
Ep  85000/200000 | ε: 0.014 | Eval:   -45.8 | Success:   0.0% | States:   21270 | Time:   6.6m
Ep  90000/200000 | ε: 0.011 | Eval:   -39.4 | Success:   0.0% | States:   21398 | Time:   7.0m
Ep  95000/200000 | ε: 0.010 | Eval:   -47.3 | Success:   0.0% | States:   21475 | Time:   7.3m
Ep 100000/200000 | ε: 0.010 | Eval:   -46.1 | Success:   0.0% | States:   21536 | Time:   7.7m
Ep 105000/200000 | ε: 0.010 | Eval:   -55.3 | Success:   0.0% | States:   21628 | Time:   8.1m
Ep 110000/200000 | ε: 0.010 | Eval:   -39.1 | Success:   0.0% | States:   21694 | Time:   8.5m
Ep 115000/200000 | ε: 0.010 | Eval:   -32.0 | Success:   0.0% | States:   21804 | Time:   8.9m
Ep 120000/200000 | ε: 0.010 | Eval:   -46.8 | Success:   0.0% | States:   21860 | Time:   9.3m
Ep 125000/200000 | ε: 0.010 | Eval:   -43.2 | Success:   0.0% | States:   21931 | Time:   9.6m
Ep 130000/200000 | ε: 0.010 | Eval:   -43.3 | Success:   0.0% | States:   21979 | Time:  10.0m
Ep 135000/200000 | ε: 0.010 | Eval:   -42.4 | Success:   0.0% | States:   22049 | Time:  10.4m
Ep 140000/200000 | ε: 0.010 | Eval:   -50.5 | Success:   0.0% | States:   22115 | Time:  10.8m
Ep 145000/200000 | ε: 0.010 | Eval:   -52.1 | Success:   0.0% | States:   22167 | Time:  11.2m
Ep 150000/200000 | ε: 0.010 | Eval:   -44.6 | Success:   0.0% | States:   22212 | Time:  11.6m
Ep 155000/200000 | ε: 0.010 | Eval:   -44.1 | Success:   0.0% | States:   22256 | Time:  11.9m
Ep 160000/200000 | ε: 0.010 | Eval:   -35.9 | Success:   0.0% | States:   22331 | Time:  12.3m
Ep 165000/200000 | ε: 0.010 | Eval:   -49.6 | Success:   0.0% | States:   22368 | Time:  12.7m
Ep 170000/200000 | ε: 0.010 | Eval:   -47.3 | Success:   0.0% | States:   22414 | Time:  13.1m
Ep 175000/200000 | ε: 0.010 | Eval:   -48.4 | Success:   0.0% | States:   22460 | Time:  13.5m
Ep 180000/200000 | ε: 0.010 | Eval:   -31.4 | Success:   0.0% | States:   22516 | Time:  13.8m
Ep 185000/200000 | ε: 0.010 | Eval:   -52.4 | Success:   0.0% | States:   22566 | Time:  14.2m
Ep 190000/200000 | ε: 0.010 | Eval:   -45.0 | Success:   0.0% | States:   22633 | Time:  14.6m
Ep 195000/200000 | ε: 0.010 | Eval:   -47.7 | Success:   0.0% | States:   22692 | Time:  15.0m
Ep 200000/200000 | ε: 0.010 | Eval:   -50.9 | Success:   0.0% | States:   22747 | Time:  15.4m

======================================================================
TRAINING COMPLETE: Monte Carlo
Time: 15.4 minutes
States visited: 22,747
Total updates: 7,524,062
======================================================================

Monte Carlo model saved!

======================================================================
FINAL EVALUATION (100 episodes each)
======================================================================

Q-Learning:
  Mean Reward: 106.38 ± 126.57
  Success Rate: 33.0%
  Best Episode: 270.53
  States Explored: 75,898

SARSA:
  Mean Reward: 116.85 ± 125.81
  Success Rate: 39.0%
  Best Episode: 267.80
  States Explored: 87,650

Monte Carlo:
  Mean Reward: -43.63 ± 22.94
  Success Rate: 0.0%
  Best Episode: 24.40
  States Explored: 22,747

======================================================================
Generating comparison plots...

Plot saved: three_agents_comparison.png

======================================================================
SUMMARY STATISTICS
======================================================================

Final 10,000 Episodes Performance:
Algorithm        Mean Reward    Std Dev  Success %
--------------------------------------------------
q-learning       136.48     117.36      44.4%
sarsa       113.03     122.62      31.7%
monte-carlo       -43.93      24.61       0.0%

======================================================================
Would you like to watch one of the trained agents? (q/s/m/n): n

======================================================================
TRAINING COMPLETE!
======================================================================

Files saved:
  • q_learning_model.pkl
  • sarsa_model.pkl
  • monte_carlo_model.pkl
  • three_agents_comparison.png

Check the comparison plot to see how the algorithms differ!
PS C:\Users\cmano\Downloads\betterLunarLander> python .\lander_three_agents.py

======================================================================
LUNAR LANDER - THREE ALGORITHMS COMPARISON
======================================================================

Algorithms:
  1. Q-Learning: Off-policy TD (uses max Q of next state)
  2. SARSA: On-policy TD (uses Q of actual next action)
  3. Monte Carlo: Episode-based (uses actual returns)

[1/3] Training Q-Learning Agent...

======================================================================
TRAINING: Q-LEARNING
======================================================================

C:\Users\cmano\AppData\Roaming\Python\Python311\site-packages\pygame\pkgdata.py:25: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import resource_stream, resource_exists
Ep   5000/500000 | ε: 0.975 | Eval:  -152.4 | Success:   0.0% | States:   14111 | Time:   0.4m
Ep  10000/500000 | ε: 0.951 | Eval:  -158.4 | Success:   0.0% | States:   18979 | Time:   0.8m
Ep  15000/500000 | ε: 0.928 | Eval:  -163.8 | Success:   0.0% | States:   22219 | Time:   1.2m
Ep  20000/500000 | ε: 0.905 | Eval:  -149.7 | Success:   0.0% | States:   24946 | Time:   1.7m
Ep  25000/500000 | ε: 0.882 | Eval:  -130.7 | Success:   0.0% | States:   27235 | Time:   2.1m
Ep  30000/500000 | ε: 0.861 | Eval:  -148.0 | Success:   0.0% | States:   29173 | Time:   2.6m
Ep  35000/500000 | ε: 0.839 | Eval:  -107.7 | Success:   0.0% | States:   30990 | Time:   3.0m
Ep  40000/500000 | ε: 0.819 | Eval:   -82.1 | Success:   0.0% | States:   32540 | Time:   3.5m
Ep  45000/500000 | ε: 0.799 | Eval:  -129.8 | Success:   0.0% | States:   33955 | Time:   3.9m
Ep  50000/500000 | ε: 0.779 | Eval:   -90.2 | Success:   0.0% | States:   35336 | Time:   4.4m
Ep  55000/500000 | ε: 0.760 | Eval:  -108.0 | Success:   0.0% | States:   36815 | Time:   4.8m
Ep  60000/500000 | ε: 0.741 | Eval:   -86.4 | Success:   0.0% | States:   38079 | Time:   5.3m
Ep  65000/500000 | ε: 0.723 | Eval:  -114.5 | Success:   0.0% | States:   39501 | Time:   5.8m
Ep  70000/500000 | ε: 0.705 | Eval:   -94.2 | Success:   0.0% | States:   40827 | Time:   6.3m
Ep  75000/500000 | ε: 0.687 | Eval:  -133.1 | Success:   0.0% | States:   42102 | Time:   6.8m
Ep  80000/500000 | ε: 0.670 | Eval:   -92.0 | Success:   0.0% | States:   43526 | Time:   7.3m
Ep  85000/500000 | ε: 0.654 | Eval:   -76.1 | Success:   0.0% | States:   44766 | Time:   7.9m
Ep  90000/500000 | ε: 0.638 | Eval:   -37.3 | Success:   0.0% | States:   45968 | Time:   8.4m
Ep  95000/500000 | ε: 0.622 | Eval:   -90.1 | Success:   0.0% | States:   47166 | Time:   8.9m
Ep 100000/500000 | ε: 0.607 | Eval:   -52.9 | Success:   0.0% | States:   48354 | Time:   9.5m
Ep 105000/500000 | ε: 0.592 | Eval:   -66.9 | Success:   5.0% | States:   49533 | Time:  10.0m
Ep 110000/500000 | ε: 0.577 | Eval:   -95.6 | Success:   5.0% | States:   50703 | Time:  10.6m
Ep 115000/500000 | ε: 0.563 | Eval:   -79.9 | Success:   0.0% | States:   51911 | Time:  11.2m
Ep 120000/500000 | ε: 0.549 | Eval:   -69.0 | Success:   0.0% | States:   53005 | Time:  11.8m
Ep 125000/500000 | ε: 0.535 | Eval:   -53.8 | Success:   0.0% | States:   54049 | Time:  12.4m
Ep 130000/500000 | ε: 0.522 | Eval:  -135.5 | Success:   0.0% | States:   55146 | Time:  13.0m
Ep 135000/500000 | ε: 0.509 | Eval:   -70.0 | Success:   5.0% | States:   56156 | Time:  13.7m
Ep 140000/500000 | ε: 0.497 | Eval:  -103.3 | Success:   0.0% | States:   57149 | Time:  14.3m
Ep 145000/500000 | ε: 0.484 | Eval:   -79.9 | Success:   5.0% | States:   58060 | Time:  15.0m
Ep 150000/500000 | ε: 0.472 | Eval:   -17.2 | Success:   5.0% | States:   58890 | Time:  15.7m
Ep 155000/500000 | ε: 0.461 | Eval:  -121.9 | Success:   0.0% | States:   59827 | Time:  16.4m
Ep 160000/500000 | ε: 0.449 | Eval:   -57.7 | Success:   5.0% | States:   60693 | Time:  17.2m
Ep 165000/500000 | ε: 0.438 | Eval:  -111.0 | Success:   0.0% | States:   61764 | Time:  18.0m
Ep 170000/500000 | ε: 0.427 | Eval:   -57.7 | Success:   0.0% | States:   62635 | Time:  18.9m
Ep 175000/500000 | ε: 0.417 | Eval:   -94.3 | Success:   0.0% | States:   63524 | Time:  19.8m
Ep 180000/500000 | ε: 0.407 | Eval:   -41.3 | Success:   0.0% | States:   64416 | Time:  20.8m
Ep 185000/500000 | ε: 0.397 | Eval:     0.9 | Success:  15.0% | States:   65511 | Time:  21.9m
Ep 190000/500000 | ε: 0.387 | Eval:     3.6 | Success:  15.0% | States:   66569 | Time:  23.1m
Ep 195000/500000 | ε: 0.377 | Eval:   -41.7 | Success:   0.0% | States:   67594 | Time:  24.4m
Ep 200000/500000 | ε: 0.368 | Eval:   -23.3 | Success:   5.0% | States:   68551 | Time:  25.8m
Ep 205000/500000 | ε: 0.359 | Eval:    -0.6 | Success:   0.0% | States:   69498 | Time:  27.3m
Ep 210000/500000 | ε: 0.350 | Eval:   -54.6 | Success:   0.0% | States:   70339 | Time:  28.9m
Ep 215000/500000 | ε: 0.341 | Eval:   -58.0 | Success:  10.0% | States:   71137 | Time:  30.5m
Ep 220000/500000 | ε: 0.333 | Eval:    -1.8 | Success:   5.0% | States:   71944 | Time:  32.2m
Ep 225000/500000 | ε: 0.325 | Eval:    -4.4 | Success:   5.0% | States:   72780 | Time:  34.0m
Ep 230000/500000 | ε: 0.317 | Eval:    56.2 | Success:  15.0% | States:   73404 | Time:  35.9m
Ep 235000/500000 | ε: 0.309 | Eval:    30.8 | Success:  10.0% | States:   74054 | Time:  37.8m
Ep 240000/500000 | ε: 0.301 | Eval:     4.3 | Success:  15.0% | States:   74680 | Time:  39.7m
Ep 245000/500000 | ε: 0.294 | Eval:    16.9 | Success:  20.0% | States:   75305 | Time:  41.8m
Ep 250000/500000 | ε: 0.287 | Eval:    44.0 | Success:  20.0% | States:   75994 | Time:  44.0m
Ep 255000/500000 | ε: 0.279 | Eval:    46.2 | Success:  15.0% | States:   76734 | Time:  46.2m
Ep 260000/500000 | ε: 0.273 | Eval:   -30.8 | Success:   5.0% | States:   77366 | Time:  48.5m
Ep 265000/500000 | ε: 0.266 | Eval:    32.3 | Success:   0.0% | States:   78032 | Time:  50.9m
Ep 270000/500000 | ε: 0.259 | Eval:    41.7 | Success:  10.0% | States:   78570 | Time:  53.2m
Ep 275000/500000 | ε: 0.253 | Eval:    98.8 | Success:   5.0% | States:   79145 | Time:  55.7m
Ep 280000/500000 | ε: 0.247 | Eval:    62.7 | Success:  25.0% | States:   79798 | Time:  58.1m
Ep 285000/500000 | ε: 0.241 | Eval:    50.9 | Success:  30.0% | States:   80251 | Time:  60.5m
Ep 290000/500000 | ε: 0.235 | Eval:    29.6 | Success:  20.0% | States:   80801 | Time:  63.0m
Ep 295000/500000 | ε: 0.229 | Eval:    88.0 | Success:  20.0% | States:   81244 | Time:  65.5m
Ep 300000/500000 | ε: 0.223 | Eval:    17.7 | Success:  10.0% | States:   81745 | Time:  68.0m
Ep 305000/500000 | ε: 0.218 | Eval:    52.5 | Success:  20.0% | States:   82275 | Time:  70.7m
Ep 310000/500000 | ε: 0.212 | Eval:   174.2 | Success:  45.0% | States:   82710 | Time:  73.3m
Ep 315000/500000 | ε: 0.207 | Eval:    65.9 | Success:   0.0% | States:   83096 | Time:  76.0m
Ep 320000/500000 | ε: 0.202 | Eval:    54.3 | Success:  30.0% | States:   83429 | Time:  78.6m
Ep 325000/500000 | ε: 0.197 | Eval:    79.2 | Success:  10.0% | States:   83758 | Time:  81.2m
Ep 330000/500000 | ε: 0.192 | Eval:    82.6 | Success:  25.0% | States:   84162 | Time:  83.9m
Ep 335000/500000 | ε: 0.187 | Eval:    42.0 | Success:  15.0% | States:   84527 | Time:  86.6m
Ep 340000/500000 | ε: 0.183 | Eval:   109.0 | Success:  25.0% | States:   84807 | Time:  89.3m
Ep 345000/500000 | ε: 0.178 | Eval:    69.0 | Success:  10.0% | States:   85148 | Time:  92.0m
Ep 350000/500000 | ε: 0.174 | Eval:    61.4 | Success:  20.0% | States:   85491 | Time:  94.7m
Ep 355000/500000 | ε: 0.169 | Eval:    99.6 | Success:  35.0% | States:   85847 | Time:  97.5m
Ep 360000/500000 | ε: 0.165 | Eval:   111.8 | Success:  45.0% | States:   86115 | Time: 100.1m
Ep 365000/500000 | ε: 0.161 | Eval:    44.0 | Success:  20.0% | States:   86437 | Time: 102.7m
Ep 370000/500000 | ε: 0.157 | Eval:   126.3 | Success:  30.0% | States:   86806 | Time: 105.4m
Ep 375000/500000 | ε: 0.153 | Eval:    74.9 | Success:  15.0% | States:   87133 | Time: 108.0m
Ep 380000/500000 | ε: 0.150 | Eval:   113.5 | Success:  35.0% | States:   87427 | Time: 110.6m
Ep 385000/500000 | ε: 0.146 | Eval:    55.4 | Success:   0.0% | States:   87709 | Time: 113.3m
Ep 390000/500000 | ε: 0.142 | Eval:   131.9 | Success:  40.0% | States:   87910 | Time: 115.9m
Ep 395000/500000 | ε: 0.139 | Eval:   144.6 | Success:  40.0% | States:   88151 | Time: 118.5m
Ep 400000/500000 | ε: 0.135 | Eval:    74.8 | Success:  10.0% | States:   88406 | Time: 121.1m
Ep 405000/500000 | ε: 0.132 | Eval:    72.8 | Success:  25.0% | States:   88637 | Time: 123.8m
Ep 410000/500000 | ε: 0.129 | Eval:   119.3 | Success:  30.0% | States:   88848 | Time: 126.4m
Ep 415000/500000 | ε: 0.126 | Eval:   113.1 | Success:  20.0% | States:   89109 | Time: 128.9m
Ep 420000/500000 | ε: 0.122 | Eval:    72.8 | Success:  20.0% | States:   89349 | Time: 131.5m
Ep 425000/500000 | ε: 0.119 | Eval:    55.5 | Success:  10.0% | States:   89558 | Time: 134.1m
Ep 430000/500000 | ε: 0.116 | Eval:    60.2 | Success:  20.0% | States:   89784 | Time: 136.6m
Ep 435000/500000 | ε: 0.114 | Eval:   125.4 | Success:  50.0% | States:   89984 | Time: 139.3m
Ep 440000/500000 | ε: 0.111 | Eval:    48.0 | Success:  10.0% | States:   90165 | Time: 141.8m
Ep 445000/500000 | ε: 0.108 | Eval:    90.9 | Success:  30.0% | States:   90365 | Time: 144.4m
Ep 450000/500000 | ε: 0.105 | Eval:   120.1 | Success:  40.0% | States:   90620 | Time: 146.9m
Ep 455000/500000 | ε: 0.103 | Eval:    95.5 | Success:  30.0% | States:   90815 | Time: 149.5m
Ep 460000/500000 | ε: 0.100 | Eval:   126.5 | Success:  40.0% | States:   91000 | Time: 152.1m
Ep 465000/500000 | ε: 0.098 | Eval:   113.2 | Success:  35.0% | States:   91145 | Time: 154.7m
Ep 470000/500000 | ε: 0.095 | Eval:    65.9 | Success:   5.0% | States:   91323 | Time: 157.4m
Ep 475000/500000 | ε: 0.093 | Eval:    98.9 | Success:  20.0% | States:   91469 | Time: 160.0m
Ep 480000/500000 | ε: 0.091 | Eval:   114.8 | Success:  45.0% | States:   91630 | Time: 162.6m
Ep 485000/500000 | ε: 0.088 | Eval:   120.7 | Success:  35.0% | States:   91831 | Time: 165.2m
Ep 490000/500000 | ε: 0.086 | Eval:    81.2 | Success:  10.0% | States:   92062 | Time: 167.7m
Ep 495000/500000 | ε: 0.084 | Eval:   101.4 | Success:  40.0% | States:   92256 | Time: 170.3m
Ep 500000/500000 | ε: 0.082 | Eval:    94.6 | Success:  25.0% | States:   92435 | Time: 172.8m

======================================================================
TRAINING COMPLETE: Q-Learning
Time: 172.8 minutes
States visited: 92,435
Total updates: 186,748,955
======================================================================

Q-Learning model saved!

[2/3] Training SARSA Agent...

======================================================================
TRAINING: SARSA
======================================================================

Ep   5000/500000 | ε: 0.975 | Eval:  -178.9 | Success:   0.0% | States:   14091 | Time:   0.4m
Ep  10000/500000 | ε: 0.951 | Eval:  -169.7 | Success:   0.0% | States:   18806 | Time:   0.8m
Ep  15000/500000 | ε: 0.928 | Eval:  -170.3 | Success:   0.0% | States:   22069 | Time:   1.2m
Ep  20000/500000 | ε: 0.905 | Eval:  -156.3 | Success:   0.0% | States:   24828 | Time:   1.6m
Ep  25000/500000 | ε: 0.882 | Eval:  -191.0 | Success:   0.0% | States:   27270 | Time:   2.0m
Ep  30000/500000 | ε: 0.861 | Eval:  -179.1 | Success:   0.0% | States:   29470 | Time:   2.4m
Ep  35000/500000 | ε: 0.839 | Eval:  -150.2 | Success:   0.0% | States:   31781 | Time:   2.9m
Ep  40000/500000 | ε: 0.819 | Eval:  -157.9 | Success:   0.0% | States:   33852 | Time:   3.3m
Ep  45000/500000 | ε: 0.799 | Eval:  -160.0 | Success:   0.0% | States:   35850 | Time:   3.8m
Ep  50000/500000 | ε: 0.779 | Eval:  -164.4 | Success:   0.0% | States:   37872 | Time:   4.2m
Ep  55000/500000 | ε: 0.760 | Eval:  -114.8 | Success:   0.0% | States:   39936 | Time:   4.7m
Ep  60000/500000 | ε: 0.741 | Eval:  -140.6 | Success:   0.0% | States:   41796 | Time:   5.2m
Ep  65000/500000 | ε: 0.723 | Eval:  -163.1 | Success:   0.0% | States:   43833 | Time:   5.7m
Ep  70000/500000 | ε: 0.705 | Eval:  -168.9 | Success:   0.0% | States:   45591 | Time:   6.2m
Ep  75000/500000 | ε: 0.687 | Eval:  -143.4 | Success:   0.0% | States:   47248 | Time:   6.7m
Ep  80000/500000 | ε: 0.670 | Eval:  -170.0 | Success:   0.0% | States:   49161 | Time:   7.3m
Ep  85000/500000 | ε: 0.654 | Eval:  -186.2 | Success:   0.0% | States:   51047 | Time:   7.8m
Ep  90000/500000 | ε: 0.638 | Eval:  -177.5 | Success:   0.0% | States:   53008 | Time:   8.4m
Ep  95000/500000 | ε: 0.622 | Eval:  -211.0 | Success:   0.0% | States:   55003 | Time:   8.9m
Ep 100000/500000 | ε: 0.607 | Eval:  -127.3 | Success:   5.0% | States:   57007 | Time:   9.5m
Ep 105000/500000 | ε: 0.592 | Eval:  -180.6 | Success:   0.0% | States:   58987 | Time:  10.2m
Ep 110000/500000 | ε: 0.577 | Eval:  -166.4 | Success:   0.0% | States:   60639 | Time:  10.8m
Ep 115000/500000 | ε: 0.563 | Eval:  -170.5 | Success:   0.0% | States:   62397 | Time:  11.5m
Ep 120000/500000 | ε: 0.549 | Eval:  -203.2 | Success:   0.0% | States:   64167 | Time:  12.2m
Ep 125000/500000 | ε: 0.535 | Eval:  -183.2 | Success:   0.0% | States:   65962 | Time:  12.9m
Ep 130000/500000 | ε: 0.522 | Eval:  -171.3 | Success:   0.0% | States:   67648 | Time:  13.7m
Ep 135000/500000 | ε: 0.509 | Eval:  -158.5 | Success:   0.0% | States:   69452 | Time:  14.5m
Ep 140000/500000 | ε: 0.497 | Eval:  -168.6 | Success:   0.0% | States:   71094 | Time:  15.3m
Ep 145000/500000 | ε: 0.484 | Eval:  -181.9 | Success:   0.0% | States:   72521 | Time:  16.2m
Ep 150000/500000 | ε: 0.472 | Eval:  -161.9 | Success:   5.0% | States:   74060 | Time:  17.2m
Ep 155000/500000 | ε: 0.461 | Eval:  -260.3 | Success:   0.0% | States:   75611 | Time:  18.2m
Ep 160000/500000 | ε: 0.449 | Eval:  -110.9 | Success:   5.0% | States:   77052 | Time:  19.3m
Ep 165000/500000 | ε: 0.438 | Eval:  -210.5 | Success:   0.0% | States:   78492 | Time:  20.5m
Ep 170000/500000 | ε: 0.427 | Eval:  -129.9 | Success:   5.0% | States:   79732 | Time:  21.7m
Ep 175000/500000 | ε: 0.417 | Eval:  -158.7 | Success:   5.0% | States:   81074 | Time:  22.9m
Ep 180000/500000 | ε: 0.407 | Eval:  -200.2 | Success:   0.0% | States:   82210 | Time:  24.3m
Ep 185000/500000 | ε: 0.397 | Eval:  -187.1 | Success:   5.0% | States:   83302 | Time:  25.7m
Ep 190000/500000 | ε: 0.387 | Eval:  -112.1 | Success:   0.0% | States:   84393 | Time:  27.1m
Ep 195000/500000 | ε: 0.377 | Eval:  -170.9 | Success:   5.0% | States:   85323 | Time:  28.6m
Ep 200000/500000 | ε: 0.368 | Eval:  -216.1 | Success:   5.0% | States:   86264 | Time:  30.2m
Ep 205000/500000 | ε: 0.359 | Eval:  -267.5 | Success:   0.0% | States:   87276 | Time:  31.8m
Ep 210000/500000 | ε: 0.350 | Eval:  -186.8 | Success:   0.0% | States:   88254 | Time:  33.5m
Ep 215000/500000 | ε: 0.341 | Eval:  -161.3 | Success:   0.0% | States:   89137 | Time:  35.8m
Ep 220000/500000 | ε: 0.333 | Eval:  -135.4 | Success:   5.0% | States:   90113 | Time:  38.9m
Ep 225000/500000 | ε: 0.325 | Eval:  -158.5 | Success:   0.0% | States:   91015 | Time:  42.8m
Ep 230000/500000 | ε: 0.317 | Eval:  -124.6 | Success:   5.0% | States:   91823 | Time:  47.0m
Ep 235000/500000 | ε: 0.309 | Eval:  -148.3 | Success:   5.0% | States:   92599 | Time:  51.4m
Ep 240000/500000 | ε: 0.301 | Eval:  -138.5 | Success:   0.0% | States:   93316 | Time:  54.9m
Ep 245000/500000 | ε: 0.294 | Eval:  -112.2 | Success:   5.0% | States:   94009 | Time:  56.9m
Ep 250000/500000 | ε: 0.287 | Eval:   -83.6 | Success:   0.0% | States:   94669 | Time:  58.9m
Ep 255000/500000 | ε: 0.279 | Eval:   -82.7 | Success:   5.0% | States:   95336 | Time:  61.8m
Ep 260000/500000 | ε: 0.273 | Eval:   -84.9 | Success:   0.0% | States:   95962 | Time:  65.6m
Ep 265000/500000 | ε: 0.266 | Eval:   -21.9 | Success:   0.0% | States:   96535 | Time:  70.4m
Ep 270000/500000 | ε: 0.259 | Eval:  -107.9 | Success:   0.0% | States:   97093 | Time:  75.2m
Ep 275000/500000 | ε: 0.253 | Eval:  -104.5 | Success:   0.0% | States:   97706 | Time:  80.4m
Ep 280000/500000 | ε: 0.247 | Eval:    19.6 | Success:  15.0% | States:   98158 | Time:  85.5m
Ep 285000/500000 | ε: 0.241 | Eval:     0.5 | Success:   5.0% | States:   98637 | Time:  91.0m
Ep 290000/500000 | ε: 0.235 | Eval:   -41.6 | Success:  20.0% | States:   99141 | Time:  96.5m
Ep 295000/500000 | ε: 0.229 | Eval:   -16.5 | Success:   0.0% | States:   99655 | Time: 101.9m
Ep 300000/500000 | ε: 0.223 | Eval:   -84.4 | Success:   5.0% | States:  100080 | Time: 107.5m
Ep 305000/500000 | ε: 0.218 | Eval:     9.6 | Success:   5.0% | States:  100566 | Time: 113.2m
Ep 310000/500000 | ε: 0.212 | Eval:    18.5 | Success:   5.0% | States:  101047 | Time: 118.8m
Ep 315000/500000 | ε: 0.207 | Eval:    42.3 | Success:  10.0% | States:  101475 | Time: 124.6m
Ep 320000/500000 | ε: 0.202 | Eval:   -70.0 | Success:  10.0% | States:  101839 | Time: 130.5m
Ep 325000/500000 | ε: 0.197 | Eval:   -43.5 | Success:   5.0% | States:  102157 | Time: 136.7m
Ep 330000/500000 | ε: 0.192 | Eval:    81.1 | Success:  20.0% | States:  102424 | Time: 142.8m
Ep 335000/500000 | ε: 0.187 | Eval:    25.8 | Success:   5.0% | States:  102719 | Time: 148.7m
Ep 340000/500000 | ε: 0.183 | Eval:    55.3 | Success:  15.0% | States:  103000 | Time: 154.8m
Ep 345000/500000 | ε: 0.178 | Eval:    54.5 | Success:  25.0% | States:  103313 | Time: 160.5m
Ep 350000/500000 | ε: 0.174 | Eval:    31.4 | Success:   5.0% | States:  103627 | Time: 163.2m
Ep 355000/500000 | ε: 0.169 | Eval:    11.4 | Success:   5.0% | States:  103981 | Time: 165.9m
Ep 360000/500000 | ε: 0.165 | Eval:    81.2 | Success:  20.0% | States:  104263 | Time: 168.8m
Ep 365000/500000 | ε: 0.161 | Eval:   118.6 | Success:  35.0% | States:  104559 | Time: 171.5m
Ep 370000/500000 | ε: 0.157 | Eval:    76.2 | Success:  30.0% | States:  104851 | Time: 174.3m
Ep 375000/500000 | ε: 0.153 | Eval:    41.5 | Success:  25.0% | States:  105063 | Time: 177.1m
Ep 380000/500000 | ε: 0.150 | Eval:    65.4 | Success:  20.0% | States:  105271 | Time: 179.9m
Ep 385000/500000 | ε: 0.146 | Eval:    92.1 | Success:  30.0% | States:  105563 | Time: 182.6m
Ep 390000/500000 | ε: 0.142 | Eval:    68.4 | Success:  15.0% | States:  105775 | Time: 186.4m
Ep 395000/500000 | ε: 0.139 | Eval:    55.7 | Success:  30.0% | States:  105952 | Time: 191.7m
Ep 400000/500000 | ε: 0.135 | Eval:   112.0 | Success:  30.0% | States:  106128 | Time: 194.6m
Ep 405000/500000 | ε: 0.132 | Eval:    70.6 | Success:  15.0% | States:  106332 | Time: 197.5m
Ep 410000/500000 | ε: 0.129 | Eval:   122.9 | Success:  35.0% | States:  106499 | Time: 201.7m
Ep 415000/500000 | ε: 0.126 | Eval:    43.3 | Success:  25.0% | States:  106685 | Time: 207.6m
Ep 420000/500000 | ε: 0.122 | Eval:    51.4 | Success:  15.0% | States:  106854 | Time: 212.6m
Ep 425000/500000 | ε: 0.119 | Eval:    25.9 | Success:   0.0% | States:  107047 | Time: 215.3m
Ep 430000/500000 | ε: 0.116 | Eval:   149.9 | Success:  35.0% | States:  107172 | Time: 218.1m
Ep 435000/500000 | ε: 0.114 | Eval:    57.5 | Success:  10.0% | States:  107371 | Time: 220.7m
Ep 440000/500000 | ε: 0.111 | Eval:    16.0 | Success:  20.0% | States:  107567 | Time: 223.4m
Ep 445000/500000 | ε: 0.108 | Eval:    44.1 | Success:  15.0% | States:  107716 | Time: 226.2m
Ep 450000/500000 | ε: 0.105 | Eval:    39.1 | Success:   5.0% | States:  107921 | Time: 228.9m
Ep 455000/500000 | ε: 0.103 | Eval:    78.9 | Success:  25.0% | States:  108074 | Time: 231.6m
Ep 460000/500000 | ε: 0.100 | Eval:   105.5 | Success:  25.0% | States:  108227 | Time: 234.3m
Ep 465000/500000 | ε: 0.098 | Eval:    99.8 | Success:  15.0% | States:  108344 | Time: 237.0m
Ep 470000/500000 | ε: 0.095 | Eval:   124.4 | Success:  30.0% | States:  108475 | Time: 239.8m
Ep 475000/500000 | ε: 0.093 | Eval:   120.6 | Success:  20.0% | States:  108581 | Time: 242.5m
Ep 480000/500000 | ε: 0.091 | Eval:    62.1 | Success:  15.0% | States:  108718 | Time: 245.3m
Ep 485000/500000 | ε: 0.088 | Eval:   127.9 | Success:  30.0% | States:  108833 | Time: 248.0m
Ep 490000/500000 | ε: 0.086 | Eval:   104.6 | Success:  45.0% | States:  108943 | Time: 250.6m
Ep 495000/500000 | ε: 0.084 | Eval:   113.4 | Success:  30.0% | States:  109020 | Time: 253.3m
Ep 500000/500000 | ε: 0.082 | Eval:    73.7 | Success:  20.0% | States:  109134 | Time: 256.0m

======================================================================
TRAINING COMPLETE: SARSA
Time: 256.0 minutes
States visited: 109,134
Total updates: 204,031,402
======================================================================

SARSA model saved!

======================================================================
FINAL EVALUATION (100 episodes each)
======================================================================

Q-Learning:
  Mean Reward: 92.88 ± 127.19
  Success Rate: 22.2%
  Best Episode: 295.32
  States Explored: 92,435

SARSA:
  Mean Reward: 86.72 ± 133.59
  Success Rate: 21.2%
  Best Episode: 288.89
  States Explored: 109,134

======================================================================
Generating comparison plots...

Plot saved: three_agents_comparison.png

======================================================================
SUMMARY STATISTICS
======================================================================

Final 10,000 Episodes Performance:
Algorithm        Mean Reward    Std Dev  Success %
--------------------------------------------------
q-learning       108.40     126.63      32.3%
sarsa       117.11     121.44      32.0%
Traceback (most recent call last):
  File "C:\Users\cmano\Downloads\betterLunarLander\lander_three_agents.py", line 695, in <module>
    response = input("Would you like to watch one of the trained agents? (q/s/n): ")
                     ^^^^^^^^^^^^^^^^^^^^^^^
KeyError: 'monte-carlo'
PS C:\Users\cmano\Downloads\betterLunarLander> python .\lander_three_agents.py

======================================================================
LUNAR LANDER
======================================================================

Algorithms:
  1. Q-Learning: Off-policy TD (uses max Q of next state)
  2. SARSA: On-policy TD (uses Q of actual next action)

[1/2] Training Q-Learning Agent...

======================================================================
TRAINING: Q-LEARNING
======================================================================

C:\Users\cmano\AppData\Roaming\Python\Python311\site-packages\pygame\pkgdata.py:25: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import resource_stream, resource_exists
Ep   5000/500000 | ε: 0.975 | Eval:  -206.7 | Success:   0.0% | States:   13824 | Time:   0.4m
Ep  10000/500000 | ε: 0.951 | Eval:  -163.1 | Success:   0.0% | States:   18472 | Time:   0.8m
Ep  15000/500000 | ε: 0.928 | Eval:  -146.2 | Success:   0.0% | States:   21737 | Time:   1.2m
Ep  20000/500000 | ε: 0.905 | Eval:  -133.0 | Success:   0.0% | States:   24423 | Time:   1.7m
Ep  25000/500000 | ε: 0.882 | Eval:  -199.1 | Success:   0.0% | States:   26667 | Time:   2.1m
Ep  30000/500000 | ε: 0.861 | Eval:  -145.6 | Success:   0.0% | States:   28541 | Time:   2.5m
Ep  35000/500000 | ε: 0.839 | Eval:  -111.1 | Success:   5.0% | States:   30243 | Time:   3.0m
Ep  40000/500000 | ε: 0.819 | Eval:  -105.4 | Success:   0.0% | States:   31715 | Time:   3.4m
Ep  45000/500000 | ε: 0.799 | Eval:   -93.7 | Success:   0.0% | States:   33236 | Time:   3.9m
Ep  50000/500000 | ε: 0.779 | Eval:   -95.1 | Success:   0.0% | States:   34527 | Time:   4.4m
Ep  55000/500000 | ε: 0.760 | Eval:   -88.8 | Success:   0.0% | States:   35811 | Time:   4.8m
Ep  60000/500000 | ε: 0.741 | Eval:   -79.5 | Success:   0.0% | States:   37024 | Time:   5.3m
Ep  65000/500000 | ε: 0.723 | Eval:   -80.1 | Success:   0.0% | States:   38138 | Time:   5.8m
Ep  70000/500000 | ε: 0.705 | Eval:   -99.0 | Success:   0.0% | States:   39411 | Time:   6.3m
Ep  75000/500000 | ε: 0.687 | Eval:   -90.7 | Success:   0.0% | States:   40550 | Time:   6.8m
Ep  80000/500000 | ε: 0.670 | Eval:   -80.1 | Success:   0.0% | States:   41755 | Time:   7.3m
Ep  85000/500000 | ε: 0.654 | Eval:   -70.7 | Success:   0.0% | States:   42981 | Time:   7.8m
Ep  90000/500000 | ε: 0.638 | Eval:   -70.8 | Success:   0.0% | States:   44089 | Time:   8.3m
Ep  95000/500000 | ε: 0.622 | Eval:   -32.0 | Success:   0.0% | States:   45186 | Time:   8.8m
Ep 100000/500000 | ε: 0.607 | Eval:   -59.2 | Success:   0.0% | States:   46324 | Time:   9.4m
Ep 105000/500000 | ε: 0.592 | Eval:   -66.2 | Success:   0.0% | States:   47382 | Time:   9.9m
Ep 110000/500000 | ε: 0.577 | Eval:   -63.5 | Success:   0.0% | States:   48461 | Time:  10.5m
Ep 115000/500000 | ε: 0.563 | Eval:   -79.2 | Success:   0.0% | States:   49468 | Time:  11.1m
Ep 120000/500000 | ε: 0.549 | Eval:   -32.3 | Success:   0.0% | States:   50377 | Time:  11.6m
Ep 125000/500000 | ε: 0.535 | Eval:   -71.7 | Success:   0.0% | States:   51273 | Time:  12.2m
Ep 130000/500000 | ε: 0.522 | Eval:   -52.9 | Success:   0.0% | States:   52315 | Time:  12.8m
Ep 135000/500000 | ε: 0.509 | Eval:   -68.3 | Success:   0.0% | States:   53248 | Time:  13.5m
Ep 140000/500000 | ε: 0.497 | Eval:   -36.6 | Success:   5.0% | States:   54231 | Time:  14.1m
Ep 145000/500000 | ε: 0.484 | Eval:  -100.9 | Success:   0.0% | States:   55255 | Time:  14.9m
Ep 150000/500000 | ε: 0.472 | Eval:   -67.4 | Success:   0.0% | States:   56200 | Time:  15.6m
Ep 155000/500000 | ε: 0.461 | Eval:   -39.3 | Success:   5.0% | States:   57275 | Time:  16.3m
Ep 160000/500000 | ε: 0.449 | Eval:   -48.2 | Success:   5.0% | States:   58240 | Time:  17.1m
Ep 165000/500000 | ε: 0.438 | Eval:   -30.5 | Success:   5.0% | States:   59190 | Time:  17.9m
Ep 170000/500000 | ε: 0.427 | Eval:   -23.2 | Success:   5.0% | States:   60021 | Time:  18.8m
Ep 175000/500000 | ε: 0.417 | Eval:   -41.7 | Success:   0.0% | States:   60996 | Time:  20.4m
Ep 180000/500000 | ε: 0.407 | Eval:   -41.8 | Success:   0.0% | States:   61909 | Time:  22.5m
Ep 185000/500000 | ε: 0.397 | Eval:    -2.5 | Success:  15.0% | States:   62760 | Time:  24.8m
Ep 190000/500000 | ε: 0.387 | Eval:    -3.8 | Success:  15.0% | States:   63819 | Time:  27.2m
Ep 195000/500000 | ε: 0.377 | Eval:   -64.9 | Success:   0.0% | States:   64775 | Time:  29.8m
Ep 200000/500000 | ε: 0.368 | Eval:    -2.6 | Success:   5.0% | States:   65737 | Time:  32.5m
Ep 205000/500000 | ε: 0.359 | Eval:   -37.8 | Success:   0.0% | States:   66619 | Time:  35.4m
Ep 210000/500000 | ε: 0.350 | Eval:   -16.9 | Success:   5.0% | States:   67593 | Time:  38.5m
Ep 215000/500000 | ε: 0.341 | Eval:   -28.9 | Success:  15.0% | States:   68488 | Time:  41.8m
Ep 220000/500000 | ε: 0.333 | Eval:     6.1 | Success:   0.0% | States:   69417 | Time:  45.2m
Ep 225000/500000 | ε: 0.325 | Eval:    -6.2 | Success:   0.0% | States:   70168 | Time:  48.9m
Ep 230000/500000 | ε: 0.317 | Eval:    22.4 | Success:   5.0% | States:   71050 | Time:  52.7m
Ep 235000/500000 | ε: 0.309 | Eval:    -1.6 | Success:   0.0% | States:   71845 | Time:  56.6m
Ep 240000/500000 | ε: 0.301 | Eval:    48.2 | Success:  10.0% | States:   72494 | Time:  60.5m
Ep 245000/500000 | ε: 0.294 | Eval:   -22.2 | Success:   5.0% | States:   73204 | Time:  64.5m
Ep 250000/500000 | ε: 0.287 | Eval:    14.4 | Success:  15.0% | States:   73868 | Time:  68.7m
Ep 255000/500000 | ε: 0.279 | Eval:    13.2 | Success:   0.0% | States:   74613 | Time:  72.8m
Ep 260000/500000 | ε: 0.273 | Eval:    -5.5 | Success:   0.0% | States:   75302 | Time:  77.3m
Ep 265000/500000 | ε: 0.266 | Eval:   -69.4 | Success:   0.0% | States:   75905 | Time:  81.8m
Ep 270000/500000 | ε: 0.259 | Eval:    44.5 | Success:  10.0% | States:   76498 | Time:  86.5m
Ep 275000/500000 | ε: 0.253 | Eval:    43.2 | Success:   5.0% | States:   77083 | Time:  91.1m
Ep 280000/500000 | ε: 0.247 | Eval:    38.7 | Success:  10.0% | States:   77701 | Time:  95.9m
Ep 285000/500000 | ε: 0.241 | Eval:    18.8 | Success:   0.0% | States:   78261 | Time: 100.5m
Ep 290000/500000 | ε: 0.235 | Eval:    20.1 | Success:   5.0% | States:   78706 | Time: 105.2m
Ep 295000/500000 | ε: 0.229 | Eval:    52.9 | Success:  10.0% | States:   79250 | Time: 109.6m
Ep 300000/500000 | ε: 0.223 | Eval:    65.7 | Success:  10.0% | States:   79759 | Time: 114.8m
Ep 305000/500000 | ε: 0.218 | Eval:    53.4 | Success:  10.0% | States:   80310 | Time: 119.8m
Ep 310000/500000 | ε: 0.212 | Eval:    -0.8 | Success:   0.0% | States:   80850 | Time: 124.8m
Ep 315000/500000 | ε: 0.207 | Eval:    68.4 | Success:  25.0% | States:   81349 | Time: 129.9m
Ep 320000/500000 | ε: 0.202 | Eval:    23.0 | Success:   5.0% | States:   81721 | Time: 135.2m
Ep 325000/500000 | ε: 0.197 | Eval:    47.5 | Success:  10.0% | States:   82169 | Time: 139.7m
Ep 330000/500000 | ε: 0.192 | Eval:    97.1 | Success:  40.0% | States:   82624 | Time: 141.9m
Ep 335000/500000 | ε: 0.187 | Eval:    51.1 | Success:  10.0% | States:   83101 | Time: 144.2m
Ep 340000/500000 | ε: 0.183 | Eval:    37.4 | Success:  20.0% | States:   83459 | Time: 146.4m
Ep 345000/500000 | ε: 0.178 | Eval:    49.4 | Success:  15.0% | States:   83817 | Time: 148.6m
Ep 350000/500000 | ε: 0.174 | Eval:    45.0 | Success:  15.0% | States:   84146 | Time: 150.8m
Ep 355000/500000 | ε: 0.169 | Eval:    46.4 | Success:  10.0% | States:   84460 | Time: 153.0m
Ep 360000/500000 | ε: 0.165 | Eval:    52.1 | Success:   5.0% | States:   84754 | Time: 155.3m
Ep 365000/500000 | ε: 0.161 | Eval:    21.6 | Success:   0.0% | States:   85114 | Time: 157.5m
Ep 370000/500000 | ε: 0.157 | Eval:    72.6 | Success:  20.0% | States:   85418 | Time: 159.7m
Ep 375000/500000 | ε: 0.153 | Eval:    35.2 | Success:  20.0% | States:   85761 | Time: 161.9m
Ep 380000/500000 | ε: 0.150 | Eval:     0.9 | Success:  10.0% | States:   86017 | Time: 164.2m
Ep 385000/500000 | ε: 0.146 | Eval:    26.4 | Success:   5.0% | States:   86306 | Time: 166.5m
Ep 390000/500000 | ε: 0.142 | Eval:    63.0 | Success:  25.0% | States:   86551 | Time: 168.8m
Ep 395000/500000 | ε: 0.139 | Eval:    42.6 | Success:  10.0% | States:   86885 | Time: 171.1m
Ep 400000/500000 | ε: 0.135 | Eval:    58.9 | Success:  10.0% | States:   87140 | Time: 173.3m
Ep 405000/500000 | ε: 0.132 | Eval:    61.5 | Success:   5.0% | States:   87481 | Time: 175.7m
Ep 410000/500000 | ε: 0.129 | Eval:    54.6 | Success:   5.0% | States:   87741 | Time: 178.0m
Ep 415000/500000 | ε: 0.126 | Eval:   100.3 | Success:  15.0% | States:   87998 | Time: 180.3m
Ep 420000/500000 | ε: 0.122 | Eval:    49.1 | Success:   0.0% | States:   88256 | Time: 182.5m
Ep 425000/500000 | ε: 0.119 | Eval:    69.9 | Success:  10.0% | States:   88535 | Time: 184.8m
Ep 430000/500000 | ε: 0.116 | Eval:    30.2 | Success:  10.0% | States:   88817 | Time: 187.0m
Ep 435000/500000 | ε: 0.114 | Eval:   111.1 | Success:  35.0% | States:   89029 | Time: 189.2m
Ep 440000/500000 | ε: 0.111 | Eval:    41.9 | Success:  30.0% | States:   89235 | Time: 191.4m
Ep 445000/500000 | ε: 0.108 | Eval:    59.6 | Success:  20.0% | States:   89477 | Time: 193.7m
Ep 450000/500000 | ε: 0.105 | Eval:    37.6 | Success:  15.0% | States:   89749 | Time: 195.9m
Ep 455000/500000 | ε: 0.103 | Eval:    95.6 | Success:  25.0% | States:   89981 | Time: 198.1m
Ep 460000/500000 | ε: 0.100 | Eval:    52.2 | Success:  15.0% | States:   90194 | Time: 200.5m
Ep 465000/500000 | ε: 0.098 | Eval:    52.4 | Success:  15.0% | States:   90448 | Time: 202.7m
Ep 470000/500000 | ε: 0.095 | Eval:     9.7 | Success:   5.0% | States:   90698 | Time: 205.0m
Ep 475000/500000 | ε: 0.093 | Eval:   101.3 | Success:  25.0% | States:   90888 | Time: 207.4m
Ep 480000/500000 | ε: 0.091 | Eval:   118.5 | Success:  20.0% | States:   91071 | Time: 209.6m
Ep 485000/500000 | ε: 0.088 | Eval:    98.0 | Success:  25.0% | States:   91244 | Time: 211.8m
Ep 490000/500000 | ε: 0.086 | Eval:   109.3 | Success:  25.0% | States:   91470 | Time: 214.1m
Ep 495000/500000 | ε: 0.084 | Eval:   110.1 | Success:  50.0% | States:   91661 | Time: 216.2m
Ep 500000/500000 | ε: 0.082 | Eval:    17.0 | Success:   5.0% | States:   91900 | Time: 218.5m

======================================================================
TRAINING COMPLETE: Q-Learning
Time: 218.5 minutes
States visited: 91,900
Total updates: 161,026,881
======================================================================

Q-Learning model saved!

[2/2] Training SARSA Agent...

======================================================================
TRAINING: SARSA
======================================================================

Ep   5000/500000 | ε: 0.975 | Eval:  -190.7 | Success:   0.0% | States:   14054 | Time:   0.4m
Ep  10000/500000 | ε: 0.951 | Eval:  -154.3 | Success:   0.0% | States:   18534 | Time:   0.8m
Ep  15000/500000 | ε: 0.928 | Eval:  -212.6 | Success:   0.0% | States:   21967 | Time:   1.2m
Ep  20000/500000 | ε: 0.905 | Eval:  -162.3 | Success:   5.0% | States:   24900 | Time:   1.6m
Ep  25000/500000 | ε: 0.882 | Eval:  -190.5 | Success:   0.0% | States:   27239 | Time:   2.0m
Ep  30000/500000 | ε: 0.861 | Eval:  -182.7 | Success:   0.0% | States:   29566 | Time:   2.5m
Ep  35000/500000 | ε: 0.839 | Eval:  -157.2 | Success:   0.0% | States:   31539 | Time:   2.9m
Ep  40000/500000 | ε: 0.819 | Eval:  -191.2 | Success:   0.0% | States:   33401 | Time:   3.3m
Ep  45000/500000 | ε: 0.799 | Eval:  -146.3 | Success:   0.0% | States:   35386 | Time:   3.8m
Ep  50000/500000 | ε: 0.779 | Eval:  -132.1 | Success:   0.0% | States:   37239 | Time:   4.3m
Ep  55000/500000 | ε: 0.760 | Eval:  -171.5 | Success:   0.0% | States:   39049 | Time:   4.8m
Ep  60000/500000 | ε: 0.741 | Eval:  -147.2 | Success:   0.0% | States:   40901 | Time:   5.3m
Ep  65000/500000 | ε: 0.723 | Eval:  -123.1 | Success:   0.0% | States:   42705 | Time:   5.8m
Ep  70000/500000 | ε: 0.705 | Eval:  -192.4 | Success:   0.0% | States:   44650 | Time:   6.3m
Ep  75000/500000 | ε: 0.687 | Eval:  -149.0 | Success:   0.0% | States:   46382 | Time:   6.8m
Ep  80000/500000 | ε: 0.670 | Eval:  -169.1 | Success:   0.0% | States:   48125 | Time:   7.3m
Ep  85000/500000 | ε: 0.654 | Eval:  -171.1 | Success:   0.0% | States:   49985 | Time:   7.8m
Ep  90000/500000 | ε: 0.638 | Eval:  -124.4 | Success:   0.0% | States:   51898 | Time:   8.4m
Ep  95000/500000 | ε: 0.622 | Eval:  -155.6 | Success:   0.0% | States:   53761 | Time:   8.9m
Ep 100000/500000 | ε: 0.607 | Eval:  -132.2 | Success:   0.0% | States:   55662 | Time:   9.5m
Ep 105000/500000 | ε: 0.592 | Eval:  -131.3 | Success:   5.0% | States:   57365 | Time:  10.1m
Ep 110000/500000 | ε: 0.577 | Eval:  -181.2 | Success:   0.0% | States:   59081 | Time:  10.7m
Ep 115000/500000 | ε: 0.563 | Eval:  -139.1 | Success:   0.0% | States:   60711 | Time:  11.4m
Ep 120000/500000 | ε: 0.549 | Eval:  -165.3 | Success:   0.0% | States:   62214 | Time:  12.0m
Ep 125000/500000 | ε: 0.535 | Eval:  -185.5 | Success:   0.0% | States:   64040 | Time:  12.7m
Ep 130000/500000 | ε: 0.522 | Eval:  -166.9 | Success:   0.0% | States:   65935 | Time:  13.4m
Ep 135000/500000 | ε: 0.509 | Eval:  -164.0 | Success:   0.0% | States:   67590 | Time:  14.2m
Ep 140000/500000 | ε: 0.497 | Eval:  -171.3 | Success:   0.0% | States:   69148 | Time:  15.1m
Ep 145000/500000 | ε: 0.484 | Eval:  -144.1 | Success:   0.0% | States:   70702 | Time:  16.5m
Ep 150000/500000 | ε: 0.472 | Eval:  -239.1 | Success:   0.0% | States:   72025 | Time:  18.6m
Ep 155000/500000 | ε: 0.461 | Eval:  -194.5 | Success:   0.0% | States:   73417 | Time:  20.9m
Ep 160000/500000 | ε: 0.449 | Eval:   -99.5 | Success:   0.0% | States:   74855 | Time:  23.3m
Ep 165000/500000 | ε: 0.438 | Eval:  -185.4 | Success:   0.0% | States:   76277 | Time:  25.8m
Ep 170000/500000 | ε: 0.427 | Eval:  -116.2 | Success:   5.0% | States:   77640 | Time:  28.5m
Ep 175000/500000 | ε: 0.417 | Eval:  -113.4 | Success:   0.0% | States:   78869 | Time:  31.2m
Ep 180000/500000 | ε: 0.407 | Eval:  -170.7 | Success:   0.0% | States:   80017 | Time:  34.0m
Ep 185000/500000 | ε: 0.397 | Eval:  -122.0 | Success:   0.0% | States:   81118 | Time:  37.2m
Ep 190000/500000 | ε: 0.387 | Eval:  -179.2 | Success:   0.0% | States:   82319 | Time:  40.4m
Ep 195000/500000 | ε: 0.377 | Eval:  -120.8 | Success:   5.0% | States:   83478 | Time:  43.6m
Ep 200000/500000 | ε: 0.368 | Eval:  -128.9 | Success:   0.0% | States:   84384 | Time:  47.0m
Ep 205000/500000 | ε: 0.359 | Eval:  -132.7 | Success:   0.0% | States:   85343 | Time:  50.5m
Ep 210000/500000 | ε: 0.350 | Eval:  -102.1 | Success:   5.0% | States:   86189 | Time:  54.1m
Ep 215000/500000 | ε: 0.341 | Eval:  -108.8 | Success:   0.0% | States:   87151 | Time:  57.8m
Ep 220000/500000 | ε: 0.333 | Eval:   -94.9 | Success:   5.0% | States:   87994 | Time:  61.5m
Ep 225000/500000 | ε: 0.325 | Eval:   -71.9 | Success:   0.0% | States:   88822 | Time:  65.5m
Ep 230000/500000 | ε: 0.317 | Eval:  -105.1 | Success:   5.0% | States:   89789 | Time:  68.9m
Ep 235000/500000 | ε: 0.309 | Eval:   -49.6 | Success:  15.0% | States:   90653 | Time:  73.0m
Ep 240000/500000 | ε: 0.301 | Eval:   -80.9 | Success:   0.0% | States:   91321 | Time:  76.1m
Ep 245000/500000 | ε: 0.294 | Eval:   -84.1 | Success:   5.0% | States:   92070 | Time:  78.0m
Ep 250000/500000 | ε: 0.287 | Eval:   -99.4 | Success:   0.0% | States:   92811 | Time:  79.9m
Ep 255000/500000 | ε: 0.279 | Eval:   -54.4 | Success:   5.0% | States:   93481 | Time:  81.9m
Ep 260000/500000 | ε: 0.273 | Eval:   -45.7 | Success:  10.0% | States:   94046 | Time:  84.0m
Ep 265000/500000 | ε: 0.266 | Eval:   -64.3 | Success:  10.0% | States:   94669 | Time:  86.1m
Ep 270000/500000 | ε: 0.259 | Eval:    -8.2 | Success:  10.0% | States:   95314 | Time:  88.3m
Ep 275000/500000 | ε: 0.253 | Eval:   -58.9 | Success:   5.0% | States:   95813 | Time:  90.5m
Ep 280000/500000 | ε: 0.247 | Eval:    19.5 | Success:   5.0% | States:   96321 | Time:  92.8m
Ep 285000/500000 | ε: 0.241 | Eval:     5.7 | Success:  10.0% | States:   96814 | Time:  95.1m
Ep 290000/500000 | ε: 0.235 | Eval:    -2.8 | Success:  10.0% | States:   97313 | Time:  97.4m
Ep 295000/500000 | ε: 0.229 | Eval:    33.2 | Success:   5.0% | States:   97862 | Time: 100.9m
Ep 300000/500000 | ε: 0.223 | Eval:   -21.7 | Success:   5.0% | States:   98270 | Time: 106.0m
Ep 305000/500000 | ε: 0.218 | Eval:   -20.1 | Success:  10.0% | States:   98630 | Time: 111.1m
Ep 310000/500000 | ε: 0.212 | Eval:     4.2 | Success:  25.0% | States:   99043 | Time: 116.2m
Ep 315000/500000 | ε: 0.207 | Eval:    84.9 | Success:  15.0% | States:   99410 | Time: 121.3m
Ep 320000/500000 | ε: 0.202 | Eval:   -24.1 | Success:  20.0% | States:   99720 | Time: 126.6m
Ep 325000/500000 | ε: 0.197 | Eval:    59.6 | Success:  15.0% | States:  100056 | Time: 132.0m
Ep 330000/500000 | ε: 0.192 | Eval:    50.8 | Success:  25.0% | States:  100404 | Time: 137.1m
Ep 335000/500000 | ε: 0.187 | Eval:    80.1 | Success:  10.0% | States:  100756 | Time: 142.3m
Ep 340000/500000 | ε: 0.183 | Eval:     2.6 | Success:   0.0% | States:  101019 | Time: 147.6m
Ep 345000/500000 | ε: 0.178 | Eval:    68.3 | Success:  25.0% | States:  101289 | Time: 152.8m
Ep 350000/500000 | ε: 0.174 | Eval:    85.6 | Success:  25.0% | States:  101598 | Time: 158.0m
Ep 355000/500000 | ε: 0.169 | Eval:    43.5 | Success:  10.0% | States:  101874 | Time: 160.3m
Ep 360000/500000 | ε: 0.165 | Eval:    93.7 | Success:  20.0% | States:  102126 | Time: 162.7m
Ep 365000/500000 | ε: 0.161 | Eval:    -9.1 | Success:   0.0% | States:  102381 | Time: 165.1m
Ep 370000/500000 | ε: 0.157 | Eval:    58.7 | Success:  10.0% | States:  102629 | Time: 167.4m
Ep 375000/500000 | ε: 0.153 | Eval:    44.3 | Success:  20.0% | States:  102862 | Time: 169.8m
Ep 380000/500000 | ε: 0.150 | Eval:    76.0 | Success:  40.0% | States:  103113 | Time: 172.2m
Ep 385000/500000 | ε: 0.146 | Eval:    97.9 | Success:  30.0% | States:  103390 | Time: 174.6m
Ep 390000/500000 | ε: 0.142 | Eval:    36.9 | Success:  25.0% | States:  103567 | Time: 177.0m
Ep 395000/500000 | ε: 0.139 | Eval:    73.6 | Success:  20.0% | States:  103744 | Time: 179.4m
Ep 400000/500000 | ε: 0.135 | Eval:    30.8 | Success:  10.0% | States:  103955 | Time: 181.8m
Ep 405000/500000 | ε: 0.132 | Eval:    11.5 | Success:  10.0% | States:  104147 | Time: 184.2m
Ep 410000/500000 | ε: 0.129 | Eval:   131.6 | Success:  35.0% | States:  104355 | Time: 186.6m
Ep 415000/500000 | ε: 0.126 | Eval:    98.2 | Success:  10.0% | States:  104588 | Time: 189.1m
Ep 420000/500000 | ε: 0.122 | Eval:    56.5 | Success:  30.0% | States:  104751 | Time: 191.5m
Ep 425000/500000 | ε: 0.119 | Eval:    99.3 | Success:  25.0% | States:  104938 | Time: 193.9m
Ep 430000/500000 | ε: 0.116 | Eval:    75.6 | Success:  10.0% | States:  105095 | Time: 196.4m
Ep 435000/500000 | ε: 0.114 | Eval:    84.7 | Success:  15.0% | States:  105247 | Time: 198.9m
Ep 440000/500000 | ε: 0.111 | Eval:   130.8 | Success:  25.0% | States:  105371 | Time: 201.4m
Ep 445000/500000 | ε: 0.108 | Eval:    54.1 | Success:  15.0% | States:  105581 | Time: 203.8m
Ep 450000/500000 | ε: 0.105 | Eval:   137.7 | Success:  35.0% | States:  105747 | Time: 206.3m
Ep 455000/500000 | ε: 0.103 | Eval:   100.0 | Success:  20.0% | States:  105917 | Time: 208.7m
Ep 460000/500000 | ε: 0.100 | Eval:    49.6 | Success:  10.0% | States:  106111 | Time: 211.1m
Ep 465000/500000 | ε: 0.098 | Eval:   117.5 | Success:  35.0% | States:  106267 | Time: 213.6m
Ep 470000/500000 | ε: 0.095 | Eval:   135.8 | Success:  50.0% | States:  106423 | Time: 216.0m
Ep 475000/500000 | ε: 0.093 | Eval:    62.8 | Success:  15.0% | States:  106554 | Time: 218.4m
Ep 480000/500000 | ε: 0.091 | Eval:    82.3 | Success:  10.0% | States:  106693 | Time: 220.8m
Ep 485000/500000 | ε: 0.088 | Eval:    75.3 | Success:  20.0% | States:  106815 | Time: 223.2m
Ep 490000/500000 | ε: 0.086 | Eval:   121.1 | Success:  25.0% | States:  106918 | Time: 225.8m
Ep 495000/500000 | ε: 0.084 | Eval:   150.7 | Success:  45.0% | States:  107061 | Time: 228.2m
Ep 500000/500000 | ε: 0.082 | Eval:   107.1 | Success:  45.0% | States:  107171 | Time: 230.7m

======================================================================
TRAINING COMPLETE: SARSA
Time: 230.7 minutes
States visited: 107,171
Total updates: 183,204,621
======================================================================

SARSA model saved!

======================================================================
FINAL EVALUATION (100 episodes each)
======================================================================

Q-Learning:
  Mean Reward: 69.99 ± 134.56
  Success Rate: 23.6%
  Best Episode: 303.35
  States Explored: 91,900

SARSA:
  Mean Reward: 130.77 ± 125.77
  Success Rate: 41.8%
  Best Episode: 291.62
  States Explored: 107,171

======================================================================
Generating comparison plots...

Plot saved: three_agents_comparison.png

======================================================================
SUMMARY STATISTICS
======================================================================

Final 10,000 Episodes Performance:
Algorithm        Mean Reward    Std Dev  Success %
--------------------------------------------------
q-learning        73.82     130.54      25.7%
sarsa        92.08     130.88      29.3%

======================================================================
Would you like to watch one of the trained agents? (q/s/n): s
Rendering SARSA agent (5 episodes)...

======================================================================
TRAINING COMPLETE!
======================================================================

Files saved:
PS C:\Users\cmano\Downloads\betterLunarLander> python .\lander_three_agents.py

======================================================================
LUNAR LANDER
======================================================================

Algorithms:
  1. Q-Learning: Off-policy TD (uses max Q of next state)
  2. SARSA: On-policy TD (uses Q of actual next action)

[1/2] Training Q-Learning Agent...

======================================================================
TRAINING: Q-LEARNING
======================================================================

C:\Users\cmano\AppData\Roaming\Python\Python311\site-packages\pygame\pkgdata.py:25: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import resource_stream, resource_exists
Ep   5000/500000 | ε: 0.951 | Eval:   -76.6 | Success:   0.0% | States:    1927 | Time:   0.7m
Ep  10000/500000 | ε: 0.905 | Eval:  -147.1 | Success:   0.0% | States:    2298 | Time:   1.6m
Ep  15000/500000 | ε: 0.861 | Eval:   -88.5 | Success:   0.0% | States:    2486 | Time:   2.0m
Ep  20000/500000 | ε: 0.819 | Eval:   -79.7 | Success:   0.0% | States:    2640 | Time:   2.5m
Ep  25000/500000 | ε: 0.779 | Eval:  -104.3 | Success:   0.0% | States:    2772 | Time:   3.0m
Ep  30000/500000 | ε: 0.741 | Eval:   -73.2 | Success:   0.0% | States:    2881 | Time:   3.4m
Ep  35000/500000 | ε: 0.705 | Eval:   -94.1 | Success:   0.0% | States:    2968 | Time:   3.9m
Ep  40000/500000 | ε: 0.670 | Eval:   -30.9 | Success:   5.0% | States:    3030 | Time:   4.4m
Ep  45000/500000 | ε: 0.638 | Eval:   -70.0 | Success:   0.0% | States:    3091 | Time:   5.0m
Ep  50000/500000 | ε: 0.607 | Eval:  -135.0 | Success:   0.0% | States:    3176 | Time:   5.5m
Ep  55000/500000 | ε: 0.577 | Eval:   -21.5 | Success:   0.0% | States:    3241 | Time:   6.1m
Ep  60000/500000 | ε: 0.549 | Eval:  -124.5 | Success:   0.0% | States:    3321 | Time:   6.8m
Ep  65000/500000 | ε: 0.522 | Eval:  -101.2 | Success:   0.0% | States:    3384 | Time:   7.5m
Ep  70000/500000 | ε: 0.497 | Eval:  -117.6 | Success:   0.0% | States:    3423 | Time:   8.2m
Ep  75000/500000 | ε: 0.472 | Eval:   -81.0 | Success:   0.0% | States:    3462 | Time:   9.0m
Ep  80000/500000 | ε: 0.449 | Eval:   -88.8 | Success:   0.0% | States:    3499 | Time:   9.9m
Ep  85000/500000 | ε: 0.427 | Eval:   -99.0 | Success:   0.0% | States:    3549 | Time:  10.9m
Ep  90000/500000 | ε: 0.407 | Eval:   -66.4 | Success:   0.0% | States:    3589 | Time:  11.9m
Ep  95000/500000 | ε: 0.387 | Eval:  -102.1 | Success:   0.0% | States:    3624 | Time:  13.0m
Ep 100000/500000 | ε: 0.368 | Eval:   -53.3 | Success:   5.0% | States:    3660 | Time:  14.1m
Ep 105000/500000 | ε: 0.350 | Eval:  -186.1 | Success:   0.0% | States:    3687 | Time:  15.3m
Ep 110000/500000 | ε: 0.333 | Eval:   -95.4 | Success:   0.0% | States:    3717 | Time:  16.5m
Ep 115000/500000 | ε: 0.317 | Eval:  -129.9 | Success:   0.0% | States:    3736 | Time:  17.7m
Ep 120000/500000 | ε: 0.301 | Eval:   -65.4 | Success:   5.0% | States:    3758 | Time:  19.0m
Ep 125000/500000 | ε: 0.287 | Eval:   -77.0 | Success:   0.0% | States:    3795 | Time:  20.3m
Ep 130000/500000 | ε: 0.273 | Eval:   -80.6 | Success:   5.0% | States:    3830 | Time:  21.7m
Ep 135000/500000 | ε: 0.259 | Eval:  -114.4 | Success:   0.0% | States:    3842 | Time:  23.0m
Ep 140000/500000 | ε: 0.247 | Eval:  -114.5 | Success:   0.0% | States:    3861 | Time:  24.3m
Ep 145000/500000 | ε: 0.235 | Eval:   -90.0 | Success:   0.0% | States:    3876 | Time:  25.7m
Ep 150000/500000 | ε: 0.223 | Eval:  -195.1 | Success:   0.0% | States:    3888 | Time:  27.0m
Ep 155000/500000 | ε: 0.212 | Eval:  -111.9 | Success:   0.0% | States:    3908 | Time:  28.2m
Ep 160000/500000 | ε: 0.202 | Eval:  -111.1 | Success:   0.0% | States:    3923 | Time:  29.5m
Ep 165000/500000 | ε: 0.192 | Eval:   -86.9 | Success:   0.0% | States:    3939 | Time:  30.8m
Ep 170000/500000 | ε: 0.183 | Eval:   -53.2 | Success:   0.0% | States:    3945 | Time:  32.1m
Ep 175000/500000 | ε: 0.174 | Eval:   -63.0 | Success:   5.0% | States:    3959 | Time:  33.5m
Ep 180000/500000 | ε: 0.165 | Eval:   -94.5 | Success:   0.0% | States:    3974 | Time:  36.3m
Ep 185000/500000 | ε: 0.157 | Eval:   -30.1 | Success:   5.0% | States:    3994 | Time:  39.3m
Ep 190000/500000 | ε: 0.150 | Eval:     4.4 | Success:  25.0% | States:    4001 | Time:  42.2m
Ep 195000/500000 | ε: 0.142 | Eval:  -107.7 | Success:   0.0% | States:    4003 | Time:  44.9m
Ep 200000/500000 | ε: 0.135 | Eval:  -115.8 | Success:   0.0% | States:    4011 | Time:  47.3m
Ep 205000/500000 | ε: 0.129 | Eval:   -70.5 | Success:   0.0% | States:    4023 | Time:  48.6m
Ep 210000/500000 | ε: 0.122 | Eval:   -69.8 | Success:   0.0% | States:    4029 | Time:  50.0m
Ep 215000/500000 | ε: 0.116 | Eval:  -131.9 | Success:   0.0% | States:    4038 | Time:  51.4m
Ep 220000/500000 | ε: 0.111 | Eval:   -67.0 | Success:   5.0% | States:    4045 | Time:  54.3m
Ep 225000/500000 | ε: 0.105 | Eval:  -126.6 | Success:   0.0% | States:    4061 | Time:  57.3m
Ep 230000/500000 | ε: 0.100 | Eval:   -69.9 | Success:   5.0% | States:    4067 | Time:  60.3m
Ep 235000/500000 | ε: 0.095 | Eval:  -103.6 | Success:   0.0% | States:    4081 | Time:  63.2m
Ep 240000/500000 | ε: 0.091 | Eval:   -25.8 | Success:   0.0% | States:    4090 | Time:  66.2m
Ep 245000/500000 | ε: 0.086 | Eval:   -68.0 | Success:   5.0% | States:    4108 | Time:  68.7m
Ep 250000/500000 | ε: 0.082 | Eval:  -137.9 | Success:   5.0% | States:    4127 | Time:  70.1m
Ep 255000/500000 | ε: 0.078 | Eval:   -98.6 | Success:   0.0% | States:    4130 | Time:  71.2m
Ep 260000/500000 | ε: 0.074 | Eval:   -33.4 | Success:   5.0% | States:    4139 | Time:  72.4m
Ep 265000/500000 | ε: 0.071 | Eval:   -12.4 | Success:  15.0% | States:    4142 | Time:  73.6m
Ep 270000/500000 | ε: 0.067 | Eval:  -114.8 | Success:   0.0% | States:    4142 | Time:  74.7m
Ep 275000/500000 | ε: 0.064 | Eval:   -28.8 | Success:   5.0% | States:    4144 | Time:  75.9m
Ep 280000/500000 | ε: 0.061 | Eval:   -59.1 | Success:   0.0% | States:    4149 | Time:  77.0m
Ep 285000/500000 | ε: 0.058 | Eval:     0.7 | Success:  20.0% | States:    4156 | Time:  78.1m
Ep 290000/500000 | ε: 0.055 | Eval:   -50.4 | Success:   5.0% | States:    4172 | Time:  79.3m
Ep 295000/500000 | ε: 0.052 | Eval:   -45.3 | Success:   0.0% | States:    4181 | Time:  80.5m
Ep 300000/500000 | ε: 0.050 | Eval:   -41.3 | Success:  15.0% | States:    4187 | Time:  81.6m
Ep 305000/500000 | ε: 0.047 | Eval:     8.9 | Success:  15.0% | States:    4187 | Time:  82.7m
Ep 310000/500000 | ε: 0.045 | Eval:   -36.7 | Success:  25.0% | States:    4187 | Time:  83.9m
Ep 315000/500000 | ε: 0.043 | Eval:   -90.6 | Success:   0.0% | States:    4190 | Time:  85.0m
Ep 320000/500000 | ε: 0.041 | Eval:   -69.1 | Success:   0.0% | States:    4198 | Time:  86.2m
Ep 325000/500000 | ε: 0.039 | Eval:    -0.4 | Success:  10.0% | States:    4201 | Time:  87.3m
Ep 330000/500000 | ε: 0.037 | Eval:     9.4 | Success:  25.0% | States:    4207 | Time:  88.4m
Ep 335000/500000 | ε: 0.035 | Eval:   -74.2 | Success:   0.0% | States:    4214 | Time:  89.6m
Ep 340000/500000 | ε: 0.033 | Eval:   -68.3 | Success:   5.0% | States:    4218 | Time:  90.7m
Ep 345000/500000 | ε: 0.032 | Eval:   -42.2 | Success:   0.0% | States:    4221 | Time:  91.9m
Ep 350000/500000 | ε: 0.030 | Eval:   -53.9 | Success:   5.0% | States:    4223 | Time:  93.1m
Ep 355000/500000 | ε: 0.029 | Eval:   -94.5 | Success:   0.0% | States:    4233 | Time:  94.2m
Ep 360000/500000 | ε: 0.027 | Eval:   -75.8 | Success:   0.0% | States:    4233 | Time:  95.4m
Ep 365000/500000 | ε: 0.026 | Eval:   -16.9 | Success:  10.0% | States:    4234 | Time:  96.6m
Ep 370000/500000 | ε: 0.025 | Eval:   -63.6 | Success:   0.0% | States:    4237 | Time:  97.7m
Ep 375000/500000 | ε: 0.024 | Eval:   -75.6 | Success:   5.0% | States:    4245 | Time:  98.8m
Ep 380000/500000 | ε: 0.022 | Eval:    11.3 | Success:  15.0% | States:    4248 | Time: 100.0m
Ep 385000/500000 | ε: 0.021 | Eval:   -58.8 | Success:   0.0% | States:    4251 | Time: 101.2m
Ep 390000/500000 | ε: 0.020 | Eval:   -38.9 | Success:   5.0% | States:    4258 | Time: 102.3m
Ep 395000/500000 | ε: 0.019 | Eval:    69.1 | Success:  35.0% | States:    4261 | Time: 103.5m
Ep 400000/500000 | ε: 0.018 | Eval:   -88.2 | Success:   0.0% | States:    4262 | Time: 104.7m
Ep 405000/500000 | ε: 0.017 | Eval:    23.2 | Success:  25.0% | States:    4263 | Time: 106.0m
Ep 410000/500000 | ε: 0.017 | Eval:   -88.1 | Success:   0.0% | States:    4264 | Time: 107.2m
Ep 415000/500000 | ε: 0.016 | Eval:   -34.5 | Success:  10.0% | States:    4266 | Time: 108.3m
Ep 420000/500000 | ε: 0.015 | Eval:  -120.5 | Success:   0.0% | States:    4274 | Time: 109.5m
Ep 425000/500000 | ε: 0.014 | Eval:   -33.2 | Success:  15.0% | States:    4275 | Time: 110.8m
Ep 430000/500000 | ε: 0.014 | Eval:   -81.2 | Success:   0.0% | States:    4278 | Time: 112.0m
Ep 435000/500000 | ε: 0.013 | Eval:   -48.1 | Success:   0.0% | States:    4282 | Time: 113.1m
Ep 440000/500000 | ε: 0.012 | Eval:    -7.6 | Success:  15.0% | States:    4283 | Time: 114.3m
Ep 445000/500000 | ε: 0.012 | Eval:    14.2 | Success:  10.0% | States:    4283 | Time: 115.4m
Ep 450000/500000 | ε: 0.011 | Eval:   -36.3 | Success:   0.0% | States:    4284 | Time: 116.7m
Ep 455000/500000 | ε: 0.011 | Eval:   -61.4 | Success:   5.0% | States:    4286 | Time: 117.9m
Ep 460000/500000 | ε: 0.010 | Eval:    19.7 | Success:  15.0% | States:    4288 | Time: 119.1m
Ep 465000/500000 | ε: 0.010 | Eval:   -46.9 | Success:   5.0% | States:    4289 | Time: 120.4m
Ep 470000/500000 | ε: 0.010 | Eval:   -67.8 | Success:  15.0% | States:    4291 | Time: 121.7m
Ep 475000/500000 | ε: 0.010 | Eval:   -14.1 | Success:   0.0% | States:    4295 | Time: 122.9m
Ep 480000/500000 | ε: 0.010 | Eval:   -15.5 | Success:   5.0% | States:    4295 | Time: 124.1m
Ep 485000/500000 | ε: 0.010 | Eval:   -28.0 | Success:  10.0% | States:    4296 | Time: 125.3m
Ep 490000/500000 | ε: 0.010 | Eval:     0.1 | Success:  20.0% | States:    4296 | Time: 126.5m
Ep 495000/500000 | ε: 0.010 | Eval:   -66.7 | Success:   5.0% | States:    4300 | Time: 127.7m
Ep 500000/500000 | ε: 0.010 | Eval:   -27.3 | Success:  25.0% | States:    4301 | Time: 128.9m

======================================================================
TRAINING COMPLETE: Q-Learning
Time: 128.9 minutes
States visited: 4,301
Total updates: 121,929,863
======================================================================

Q-Learning model saved!

[2/2] Training SARSA Agent...

======================================================================
TRAINING: SARSA
======================================================================

Ep   5000/500000 | ε: 0.951 | Eval:  -146.6 | Success:   0.0% | States:    1933 | Time:   0.4m
Ep  10000/500000 | ε: 0.905 | Eval:  -175.9 | Success:   0.0% | States:    2263 | Time:   0.8m
Ep  15000/500000 | ε: 0.861 | Eval:  -212.3 | Success:   0.0% | States:    2507 | Time:   1.2m
Ep  20000/500000 | ε: 0.819 | Eval:  -219.1 | Success:   0.0% | States:    2680 | Time:   1.6m
Ep  25000/500000 | ε: 0.779 | Eval:  -247.6 | Success:   0.0% | States:    2809 | Time:   2.1m
Ep  30000/500000 | ε: 0.741 | Eval:  -206.2 | Success:   0.0% | States:    2955 | Time:   2.5m
Ep  35000/500000 | ε: 0.705 | Eval:  -316.6 | Success:   0.0% | States:    3050 | Time:   3.0m
Ep  40000/500000 | ε: 0.670 | Eval:  -171.4 | Success:   0.0% | States:    3168 | Time:   3.5m
Ep  45000/500000 | ε: 0.638 | Eval:  -207.1 | Success:   0.0% | States:    3285 | Time:   4.0m
Ep  50000/500000 | ε: 0.607 | Eval:  -266.0 | Success:   0.0% | States:    3361 | Time:   4.6m
Ep  55000/500000 | ε: 0.577 | Eval:  -183.8 | Success:   0.0% | States:    3449 | Time:   5.2m
Ep  60000/500000 | ε: 0.549 | Eval:  -216.6 | Success:   0.0% | States:    3555 | Time:   5.9m
Ep  65000/500000 | ε: 0.522 | Eval:  -195.8 | Success:   0.0% | States:    3614 | Time:   6.6m
Ep  70000/500000 | ε: 0.497 | Eval:  -250.2 | Success:   0.0% | States:    3696 | Time:   7.4m
Ep  75000/500000 | ε: 0.472 | Eval:  -199.4 | Success:   0.0% | States:    3738 | Time:   8.2m
Ep  80000/500000 | ε: 0.449 | Eval:  -218.0 | Success:   0.0% | States:    3776 | Time:   9.2m
Ep  85000/500000 | ε: 0.427 | Eval:  -225.9 | Success:   0.0% | States:    3812 | Time:  10.2m
Ep  90000/500000 | ε: 0.407 | Eval:   -55.0 | Success:  15.0% | States:    3876 | Time:  11.2m
Ep  95000/500000 | ε: 0.387 | Eval:  -115.7 | Success:   0.0% | States:    3898 | Time:  12.4m
Ep 100000/500000 | ε: 0.368 | Eval:  -141.8 | Success:   0.0% | States:    3954 | Time:  13.5m
Ep 105000/500000 | ε: 0.350 | Eval:   -89.8 | Success:   0.0% | States:    4003 | Time:  14.7m
Ep 110000/500000 | ε: 0.333 | Eval:  -159.5 | Success:   5.0% | States:    4028 | Time:  16.0m
Ep 115000/500000 | ε: 0.317 | Eval:  -174.8 | Success:   0.0% | States:    4070 | Time:  17.3m
Ep 120000/500000 | ε: 0.301 | Eval:  -167.1 | Success:   0.0% | States:    4096 | Time:  18.6m
Ep 125000/500000 | ε: 0.287 | Eval:  -150.2 | Success:   0.0% | States:    4117 | Time:  19.8m
Ep 130000/500000 | ε: 0.273 | Eval:  -131.8 | Success:   0.0% | States:    4143 | Time:  21.2m
Ep 135000/500000 | ε: 0.259 | Eval:  -129.0 | Success:   0.0% | States:    4168 | Time:  22.6m
Ep 140000/500000 | ε: 0.247 | Eval:   -55.1 | Success:   0.0% | States:    4193 | Time:  23.9m
Ep 145000/500000 | ε: 0.235 | Eval:   -83.8 | Success:   0.0% | States:    4229 | Time:  25.2m
Ep 150000/500000 | ε: 0.223 | Eval:  -115.7 | Success:   0.0% | States:    4255 | Time:  26.6m
Ep 155000/500000 | ε: 0.212 | Eval:   -37.9 | Success:   0.0% | States:    4271 | Time:  27.9m
Ep 160000/500000 | ε: 0.202 | Eval:   -72.4 | Success:   0.0% | States:    4278 | Time:  29.3m
Ep 165000/500000 | ε: 0.192 | Eval:   -63.0 | Success:   0.0% | States:    4285 | Time:  30.7m
Ep 170000/500000 | ε: 0.183 | Eval:  -104.0 | Success:   0.0% | States:    4292 | Time:  32.0m
Ep 175000/500000 | ε: 0.174 | Eval:   -68.7 | Success:  10.0% | States:    4300 | Time:  33.4m
Ep 180000/500000 | ε: 0.165 | Eval:   -70.0 | Success:   0.0% | States:    4301 | Time:  34.8m
Ep 185000/500000 | ε: 0.157 | Eval:  -115.8 | Success:   0.0% | States:    4307 | Time:  36.1m
Ep 190000/500000 | ε: 0.150 | Eval:   -60.4 | Success:   5.0% | States:    4311 | Time:  37.4m
Ep 195000/500000 | ε: 0.142 | Eval:  -107.7 | Success:   0.0% | States:    4316 | Time:  38.7m
Ep 200000/500000 | ε: 0.135 | Eval:   -70.4 | Success:   0.0% | States:    4329 | Time:  39.9m
Ep 205000/500000 | ε: 0.129 | Eval:   -61.6 | Success:  10.0% | States:    4332 | Time:  41.2m
Ep 210000/500000 | ε: 0.122 | Eval:  -134.5 | Success:   0.0% | States:    4345 | Time:  42.4m
Ep 215000/500000 | ε: 0.116 | Eval:  -100.3 | Success:   0.0% | States:    4356 | Time:  43.6m
Ep 220000/500000 | ε: 0.111 | Eval:   -95.5 | Success:   5.0% | States:    4357 | Time:  44.8m
Ep 225000/500000 | ε: 0.105 | Eval:  -104.0 | Success:   0.0% | States:    4360 | Time:  46.0m
Ep 230000/500000 | ε: 0.100 | Eval:   -36.6 | Success:  10.0% | States:    4363 | Time:  47.3m
Ep 235000/500000 | ε: 0.095 | Eval:   -42.6 | Success:   0.0% | States:    4371 | Time:  48.4m
Ep 240000/500000 | ε: 0.091 | Eval:   -81.0 | Success:   0.0% | States:    4385 | Time:  49.6m
Ep 245000/500000 | ε: 0.086 | Eval:   -31.2 | Success:   5.0% | States:    4390 | Time:  50.8m
Ep 250000/500000 | ε: 0.082 | Eval:    17.8 | Success:  15.0% | States:    4394 | Time:  52.0m
Ep 255000/500000 | ε: 0.078 | Eval:    -6.5 | Success:   0.0% | States:    4397 | Time:  53.1m
Ep 260000/500000 | ε: 0.074 | Eval:   -58.7 | Success:   0.0% | States:    4403 | Time:  54.3m
Ep 265000/500000 | ε: 0.071 | Eval:   -38.7 | Success:   0.0% | States:    4404 | Time:  55.4m
Ep 270000/500000 | ε: 0.067 | Eval:   -71.0 | Success:   5.0% | States:    4406 | Time:  56.5m
Ep 275000/500000 | ε: 0.064 | Eval:   -76.4 | Success:   0.0% | States:    4412 | Time:  57.6m
Ep 280000/500000 | ε: 0.061 | Eval:   -74.7 | Success:   5.0% | States:    4418 | Time:  58.7m
Ep 285000/500000 | ε: 0.058 | Eval:   -65.5 | Success:   0.0% | States:    4421 | Time:  59.8m
Ep 290000/500000 | ε: 0.055 | Eval:     6.2 | Success:  15.0% | States:    4429 | Time:  61.0m
Ep 295000/500000 | ε: 0.052 | Eval:   -62.3 | Success:  10.0% | States:    4431 | Time:  62.1m
Ep 300000/500000 | ε: 0.050 | Eval:   -74.6 | Success:  10.0% | States:    4432 | Time:  63.2m
Ep 305000/500000 | ε: 0.047 | Eval:   -83.4 | Success:   0.0% | States:    4434 | Time:  64.3m
Ep 310000/500000 | ε: 0.045 | Eval:  -124.2 | Success:   0.0% | States:    4437 | Time:  65.4m
Ep 315000/500000 | ε: 0.043 | Eval:   -79.0 | Success:   0.0% | States:    4441 | Time:  66.5m
Ep 320000/500000 | ε: 0.041 | Eval:   -57.3 | Success:   5.0% | States:    4444 | Time:  67.7m
Ep 325000/500000 | ε: 0.039 | Eval:   -21.5 | Success:  20.0% | States:    4445 | Time:  68.8m
Ep 330000/500000 | ε: 0.037 | Eval:   -26.6 | Success:  10.0% | States:    4445 | Time:  70.0m
Ep 335000/500000 | ε: 0.035 | Eval:  -132.5 | Success:   5.0% | States:    4445 | Time:  71.1m
Ep 340000/500000 | ε: 0.033 | Eval:   -64.8 | Success:  15.0% | States:    4449 | Time:  72.3m
Ep 345000/500000 | ε: 0.032 | Eval:   -58.7 | Success:   0.0% | States:    4449 | Time:  73.4m
Ep 350000/500000 | ε: 0.030 | Eval:    -5.7 | Success:   5.0% | States:    4449 | Time:  74.6m
Ep 355000/500000 | ε: 0.029 | Eval:   -67.0 | Success:   0.0% | States:    4449 | Time:  75.7m
Ep 360000/500000 | ε: 0.027 | Eval:   -38.5 | Success:   0.0% | States:    4456 | Time:  76.9m
Ep 365000/500000 | ε: 0.026 | Eval:   -30.6 | Success:   0.0% | States:    4458 | Time:  78.1m
Ep 370000/500000 | ε: 0.025 | Eval:   -55.2 | Success:   0.0% | States:    4461 | Time:  79.2m
Ep 375000/500000 | ε: 0.024 | Eval:   -62.0 | Success:   0.0% | States:    4461 | Time:  80.4m
Ep 380000/500000 | ε: 0.022 | Eval:   -55.9 | Success:   0.0% | States:    4463 | Time:  81.5m
Ep 385000/500000 | ε: 0.021 | Eval:   -36.8 | Success:   0.0% | States:    4466 | Time:  82.7m
Ep 390000/500000 | ε: 0.020 | Eval:   -11.0 | Success:  15.0% | States:    4472 | Time:  83.9m
Ep 395000/500000 | ε: 0.019 | Eval:     0.4 | Success:   5.0% | States:    4474 | Time:  85.0m
Ep 400000/500000 | ε: 0.018 | Eval:   -70.1 | Success:   0.0% | States:    4476 | Time:  86.2m
Ep 405000/500000 | ε: 0.017 | Eval:     4.0 | Success:  15.0% | States:    4481 | Time:  87.3m
Ep 410000/500000 | ε: 0.017 | Eval:   -41.3 | Success:   5.0% | States:    4483 | Time:  88.5m
Ep 415000/500000 | ε: 0.016 | Eval:   -43.7 | Success:   0.0% | States:    4488 | Time:  89.8m
Ep 420000/500000 | ε: 0.015 | Eval:    24.0 | Success:  25.0% | States:    4489 | Time:  91.0m
Ep 425000/500000 | ε: 0.014 | Eval:     3.5 | Success:   5.0% | States:    4494 | Time:  92.1m
Ep 430000/500000 | ε: 0.014 | Eval:   -29.8 | Success:   5.0% | States:    4495 | Time:  93.3m
Ep 435000/500000 | ε: 0.013 | Eval:   -69.7 | Success:  10.0% | States:    4495 | Time:  94.5m
Ep 440000/500000 | ε: 0.012 | Eval:   -32.0 | Success:   5.0% | States:    4499 | Time:  95.7m
Ep 445000/500000 | ε: 0.012 | Eval:   -28.0 | Success:  10.0% | States:    4499 | Time:  96.9m
Ep 450000/500000 | ε: 0.011 | Eval:   -61.8 | Success:   5.0% | States:    4502 | Time:  98.0m
Ep 455000/500000 | ε: 0.011 | Eval:   -66.0 | Success:   0.0% | States:    4504 | Time:  99.1m
Ep 460000/500000 | ε: 0.010 | Eval:   -53.6 | Success:   5.0% | States:    4505 | Time: 100.3m
Ep 465000/500000 | ε: 0.010 | Eval:   -38.5 | Success:   5.0% | States:    4505 | Time: 101.5m
Ep 470000/500000 | ε: 0.010 | Eval:    -6.7 | Success:  10.0% | States:    4506 | Time: 102.8m
Ep 475000/500000 | ε: 0.010 | Eval:   -95.7 | Success:   0.0% | States:    4507 | Time: 103.9m
Ep 480000/500000 | ε: 0.010 | Eval:   -65.1 | Success:   5.0% | States:    4507 | Time: 105.0m
Ep 485000/500000 | ε: 0.010 | Eval:   -16.7 | Success:  10.0% | States:    4509 | Time: 106.2m
Ep 490000/500000 | ε: 0.010 | Eval:   -61.6 | Success:   0.0% | States:    4510 | Time: 107.5m
Ep 495000/500000 | ε: 0.010 | Eval:   -60.2 | Success:   5.0% | States:    4510 | Time: 108.7m
Ep 500000/500000 | ε: 0.010 | Eval:   -71.2 | Success:   0.0% | States:    4510 | Time: 109.8m

======================================================================
TRAINING COMPLETE: SARSA
Time: 109.8 minutes
States visited: 4,510
Total updates: 127,508,795
======================================================================

SARSA model saved!

======================================================================
FINAL EVALUATION (100 episodes each)
======================================================================

Q-Learning:
  Mean Reward: -18.78 ± 144.32
  Success Rate: 12.8%
  Best Episode: 282.03
  States Explored: 4,301

SARSA:
  Mean Reward: -47.38 ± 124.96
  Success Rate: 8.1%
  Best Episode: 306.69
  States Explored: 4,510

======================================================================
Generating comparison plots...

Plot saved: three_agents_comparison.png

======================================================================
SUMMARY STATISTICS
======================================================================

Final 10,000 Episodes Performance:
Algorithm        Mean Reward    Std Dev  Success %
--------------------------------------------------
q-learning       -16.28     126.03       9.6%
sarsa       -11.86     128.97      10.1%

======================================================================
Would you like to watch one of the trained agents? (q/s/n): q
Rendering Q-Learning agent (5 episodes)...

======================================================================
TRAINING COMPLETE!
======================================================================

Files saved:
PS C:\Users\cmano\Downloads\betterLunarLander> pip install stable-baselines3 torch
Defaulting to user installation because normal site-packages is not writeable
Collecting stable-baselines3
  Downloading stable_baselines3-2.7.0-py3-none-any.whl.metadata (4.8 kB)
Requirement already satisfied: torch in c:\users\cmano\appdata\roaming\python\python311\site-packages (2.9.1)
Requirement already satisfied: gymnasium<1.3.0,>=0.29.1 in c:\users\cmano\appdata\roaming\python\python311\site-packages (from stable-baselines3) (1.2.1)
Requirement already satisfied: numpy<3.0,>=1.20 in c:\users\cmano\appdata\roaming\python\python311\site-packages (from stable-baselines3) (2.2.6)
Requirement already satisfied: cloudpickle in c:\users\cmano\appdata\roaming\python\python311\site-packages (from stable-baselines3) (3.1.2)
Requirement already satisfied: pandas in c:\users\cmano\appdata\roaming\python\python311\site-packages (from stable-baselines3) (2.3.3)
Requirement already satisfied: matplotlib in c:\users\cmano\appdata\roaming\python\python311\site-packages (from stable-baselines3) (3.10.6)
Requirement already satisfied: filelock in c:\users\cmano\appdata\roaming\python\python311\site-packages (from torch) (3.20.0)
Requirement already satisfied: typing-extensions>=4.10.0 in c:\users\cmano\appdata\roaming\python\python311\site-packages (from torch) (4.15.0)
Requirement already satisfied: sympy>=1.13.3 in c:\users\cmano\appdata\roaming\python\python311\site-packages (from torch) (1.14.0)
Requirement already satisfied: networkx>=2.5.1 in c:\users\cmano\appdata\roaming\python\python311\site-packages (from torch) (3.5)
Requirement already satisfied: jinja2 in c:\users\cmano\appdata\roaming\python\python311\site-packages (from torch) (3.1.6)
Requirement already satisfied: fsspec>=0.8.5 in c:\users\cmano\appdata\roaming\python\python311\site-packages (from torch) (2025.10.0)
Requirement already satisfied: farama-notifications>=0.0.1 in c:\users\cmano\appdata\roaming\python\python311\site-packages (from gymnasium<1.3.0,>=0.29.1->stable-baselines3) (0.0.4)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in c:\users\cmano\appdata\roaming\python\python311\site-packages (from sympy>=1.13.3->torch) (1.3.0)
Requirement already satisfied: MarkupSafe>=2.0 in c:\users\cmano\appdata\roaming\python\python311\site-packages (from jinja2->torch) (3.0.3)
Requirement already satisfied: contourpy>=1.0.1 in c:\users\cmano\appdata\roaming\python\python311\site-packages (from matplotlib->stable-baselines3) (1.3.3)
Requirement already satisfied: cycler>=0.10 in c:\users\cmano\appdata\roaming\python\python311\site-packages (from matplotlib->stable-baselines3) (0.12.1)
Requirement already satisfied: fonttools>=4.22.0 in c:\users\cmano\appdata\roaming\python\python311\site-packages (from matplotlib->stable-baselines3) (4.60.1)
Requirement already satisfied: kiwisolver>=1.3.1 in c:\users\cmano\appdata\roaming\python\python311\site-packages (from matplotlib->stable-baselines3) (1.4.9)
Requirement already satisfied: packaging>=20.0 in c:\users\cmano\appdata\roaming\python\python311\site-packages (from matplotlib->stable-baselines3) (25.0)
Requirement already satisfied: pillow>=8 in c:\users\cmano\appdata\roaming\python\python311\site-packages (from matplotlib->stable-baselines3) (11.3.0)
Requirement already satisfied: pyparsing>=2.3.1 in c:\users\cmano\appdata\roaming\python\python311\site-packages (from matplotlib->stable-baselines3) (3.2.5)
Requirement already satisfied: python-dateutil>=2.7 in c:\users\cmano\appdata\roaming\python\python311\site-packages (from matplotlib->stable-baselines3) (2.9.0.post0)
Requirement already satisfied: six>=1.5 in c:\users\cmano\appdata\roaming\python\python311\site-packages (from python-dateutil>=2.7->matplotlib->stable-baselines3) (1.17.0)
Requirement already satisfied: pytz>=2020.1 in c:\users\cmano\appdata\roaming\python\python311\site-packages (from pandas->stable-baselines3) (2025.2)
Requirement already satisfied: tzdata>=2022.7 in c:\users\cmano\appdata\roaming\python\python311\site-packages (from pandas->stable-baselines3) (2025.2)
Downloading stable_baselines3-2.7.0-py3-none-any.whl (187 kB)
Installing collected packages: stable-baselines3
Successfully installed stable-baselines3-2.7.0